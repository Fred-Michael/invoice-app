(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();/**
* @vue/shared v3.5.7
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function qu(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const Be={},$i=[],wn=()=>{},eE=()=>!1,vc=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),ju=n=>n.startsWith("onUpdate:"),at=Object.assign,$u=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},tE=Object.prototype.hasOwnProperty,Ce=(n,e)=>tE.call(n,e),he=Array.isArray,Gi=n=>Uo(n)==="[object Map]",Ic=n=>Uo(n)==="[object Set]",If=n=>Uo(n)==="[object Date]",pe=n=>typeof n=="function",rt=n=>typeof n=="string",Sn=n=>typeof n=="symbol",Ue=n=>n!==null&&typeof n=="object",Ym=n=>(Ue(n)||pe(n))&&pe(n.then)&&pe(n.catch),Jm=Object.prototype.toString,Uo=n=>Jm.call(n),nE=n=>Uo(n).slice(8,-1),Xm=n=>Uo(n)==="[object Object]",Gu=n=>rt(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Zs=qu(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ec=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},rE=/-(\w)/g,dn=Ec(n=>n.replace(rE,(e,t)=>t?t.toUpperCase():"")),iE=/\B([A-Z])/g,pi=Ec(n=>n.replace(iE,"-$1").toLowerCase()),Tc=Ec(n=>n.charAt(0).toUpperCase()+n.slice(1)),Tl=Ec(n=>n?`on${Tc(n)}`:""),pr=(n,e)=>!Object.is(n,e),Na=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},Zm=(n,e,t,r=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:r,value:t})},Ka=n=>{const e=parseFloat(n);return isNaN(e)?n:e},sE=n=>{const e=rt(n)?Number(n):NaN;return isNaN(e)?n:e};let Ef;const eg=()=>Ef||(Ef=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function zu(n){if(he(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],i=rt(r)?lE(r):zu(r);if(i)for(const s in i)e[s]=i[s]}return e}else if(rt(n)||Ue(n))return n}const oE=/;(?![^(]*\))/g,aE=/:([^]+)/,cE=/\/\*[^]*?\*\//g;function lE(n){const e={};return n.replace(cE,"").split(oE).forEach(t=>{if(t){const r=t.split(aE);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function qo(n){let e="";if(rt(n))e=n;else if(he(n))for(let t=0;t<n.length;t++){const r=qo(n[t]);r&&(e+=r+" ")}else if(Ue(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const uE="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",hE=qu(uE);function tg(n){return!!n||n===""}function dE(n,e){if(n.length!==e.length)return!1;let t=!0;for(let r=0;t&&r<n.length;r++)t=wc(n[r],e[r]);return t}function wc(n,e){if(n===e)return!0;let t=If(n),r=If(e);if(t||r)return t&&r?n.getTime()===e.getTime():!1;if(t=Sn(n),r=Sn(e),t||r)return n===e;if(t=he(n),r=he(e),t||r)return t&&r?dE(n,e):!1;if(t=Ue(n),r=Ue(e),t||r){if(!t||!r)return!1;const i=Object.keys(n).length,s=Object.keys(e).length;if(i!==s)return!1;for(const o in n){const a=n.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!wc(n[o],e[o]))return!1}}return String(n)===String(e)}function fE(n,e){return n.findIndex(t=>wc(t,e))}const ng=n=>!!(n&&n.__v_isRef===!0),Le=n=>rt(n)?n:n==null?"":he(n)||Ue(n)&&(n.toString===Jm||!pe(n.toString))?ng(n)?Le(n.value):JSON.stringify(n,rg,2):String(n),rg=(n,e)=>ng(e)?rg(n,e.value):Gi(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,i],s)=>(t[wl(r,s)+" =>"]=i,t),{})}:Ic(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>wl(t))}:Sn(e)?wl(e):Ue(e)&&!he(e)&&!Xm(e)?String(e):e,wl=(n,e="")=>{var t;return Sn(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.7
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Jt;class ig{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Jt,!e&&Jt&&(this.index=(Jt.scopes||(Jt.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=Jt;try{return Jt=this,e()}finally{Jt=t}}}on(){Jt=this}off(){Jt=this.parent}stop(e){if(this._active){let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0,this._active=!1}}}function pE(n){return new ig(n)}function mE(){return Jt}let Fe;const bl=new WeakSet;class sg{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Jt&&Jt.active&&Jt.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,bl.has(this)&&(bl.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||ag(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Tf(this),cg(this);const e=Fe,t=hn;Fe=this,hn=!0;try{return this.fn()}finally{lg(this),Fe=e,hn=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Qu(e);this.deps=this.depsTail=void 0,Tf(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?bl.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Wl(this)&&this.run()}get dirty(){return Wl(this)}}let og=0,eo;function ag(n){n.flags|=8,n.next=eo,eo=n}function Ku(){og++}function Hu(){if(--og>0)return;let n;for(;eo;){let e=eo;for(eo=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){n||(n=r)}e=t}}if(n)throw n}function cg(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function lg(n){let e,t=n.depsTail,r=t;for(;r;){const i=r.prevDep;r.version===-1?(r===t&&(t=i),Qu(r),gE(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=i}n.deps=e,n.depsTail=t}function Wl(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(ug(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function ug(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===fo))return;n.globalVersion=fo;const e=n.dep;if(n.flags|=2,e.version>0&&!n.isSSR&&n.deps&&!Wl(n)){n.flags&=-3;return}const t=Fe,r=hn;Fe=n,hn=!0;try{cg(n);const i=n.fn(n._value);(e.version===0||pr(i,n._value))&&(n._value=i,e.version++)}catch(i){throw e.version++,i}finally{Fe=t,hn=r,lg(n),n.flags&=-3}}function Qu(n,e=!1){const{dep:t,prevSub:r,nextSub:i}=n;if(r&&(r.nextSub=i,n.prevSub=void 0),i&&(i.prevSub=r,n.nextSub=void 0),t.subs===n&&(t.subs=r),!t.subs)if(t.computed){t.computed.flags&=-5;for(let s=t.computed.deps;s;s=s.nextDep)Qu(s,!0)}else t.map&&!e&&(t.map.delete(t.key),t.map.size||Ha.delete(t.target))}function gE(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let hn=!0;const hg=[];function Sr(){hg.push(hn),hn=!1}function Rr(){const n=hg.pop();hn=n===void 0?!0:n}function Tf(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=Fe;Fe=void 0;try{e()}finally{Fe=t}}}let fo=0;class _E{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Wu{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.target=void 0,this.map=void 0,this.key=void 0}track(e){if(!Fe||!hn||Fe===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==Fe)t=this.activeLink=new _E(Fe,this),Fe.deps?(t.prevDep=Fe.depsTail,Fe.depsTail.nextDep=t,Fe.depsTail=t):Fe.deps=Fe.depsTail=t,Fe.flags&4&&dg(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const r=t.nextDep;r.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=r),t.prevDep=Fe.depsTail,t.nextDep=void 0,Fe.depsTail.nextDep=t,Fe.depsTail=t,Fe.deps===t&&(Fe.deps=r)}return t}trigger(e){this.version++,fo++,this.notify(e)}notify(e){Ku();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{Hu()}}}function dg(n){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)dg(r)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}const Ha=new WeakMap,ti=Symbol(""),Yl=Symbol(""),po=Symbol("");function Dt(n,e,t){if(hn&&Fe){let r=Ha.get(n);r||Ha.set(n,r=new Map);let i=r.get(t);i||(r.set(t,i=new Wu),i.target=n,i.map=r,i.key=t),i.track()}}function Mn(n,e,t,r,i,s){const o=Ha.get(n);if(!o){fo++;return}const a=l=>{l&&l.trigger()};if(Ku(),e==="clear")o.forEach(a);else{const l=he(n),u=l&&Gu(t);if(l&&t==="length"){const h=Number(r);o.forEach((f,m)=>{(m==="length"||m===po||!Sn(m)&&m>=h)&&a(f)})}else switch(t!==void 0&&a(o.get(t)),u&&a(o.get(po)),e){case"add":l?u&&a(o.get("length")):(a(o.get(ti)),Gi(n)&&a(o.get(Yl)));break;case"delete":l||(a(o.get(ti)),Gi(n)&&a(o.get(Yl)));break;case"set":Gi(n)&&a(o.get(ti));break}}Hu()}function Pi(n){const e=Pe(n);return e===n?e:(Dt(e,"iterate",po),an(n)?e:e.map(Rt))}function bc(n){return Dt(n=Pe(n),"iterate",po),n}const yE={__proto__:null,[Symbol.iterator](){return Al(this,Symbol.iterator,Rt)},concat(...n){return Pi(this).concat(...n.map(e=>he(e)?Pi(e):e))},entries(){return Al(this,"entries",n=>(n[1]=Rt(n[1]),n))},every(n,e){return xn(this,"every",n,e,void 0,arguments)},filter(n,e){return xn(this,"filter",n,e,t=>t.map(Rt),arguments)},find(n,e){return xn(this,"find",n,e,Rt,arguments)},findIndex(n,e){return xn(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return xn(this,"findLast",n,e,Rt,arguments)},findLastIndex(n,e){return xn(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return xn(this,"forEach",n,e,void 0,arguments)},includes(...n){return Sl(this,"includes",n)},indexOf(...n){return Sl(this,"indexOf",n)},join(n){return Pi(this).join(n)},lastIndexOf(...n){return Sl(this,"lastIndexOf",n)},map(n,e){return xn(this,"map",n,e,void 0,arguments)},pop(){return Bs(this,"pop")},push(...n){return Bs(this,"push",n)},reduce(n,...e){return wf(this,"reduce",n,e)},reduceRight(n,...e){return wf(this,"reduceRight",n,e)},shift(){return Bs(this,"shift")},some(n,e){return xn(this,"some",n,e,void 0,arguments)},splice(...n){return Bs(this,"splice",n)},toReversed(){return Pi(this).toReversed()},toSorted(n){return Pi(this).toSorted(n)},toSpliced(...n){return Pi(this).toSpliced(...n)},unshift(...n){return Bs(this,"unshift",n)},values(){return Al(this,"values",Rt)}};function Al(n,e,t){const r=bc(n),i=r[e]();return r!==n&&!an(n)&&(i._next=i.next,i.next=()=>{const s=i._next();return s.value&&(s.value=t(s.value)),s}),i}const vE=Array.prototype;function xn(n,e,t,r,i,s){const o=bc(n),a=o!==n&&!an(n),l=o[e];if(l!==vE[e]){const f=l.apply(n,s);return a?Rt(f):f}let u=t;o!==n&&(a?u=function(f,m){return t.call(this,Rt(f),m,n)}:t.length>2&&(u=function(f,m){return t.call(this,f,m,n)}));const h=l.call(o,u,r);return a&&i?i(h):h}function wf(n,e,t,r){const i=bc(n);let s=t;return i!==n&&(an(n)?t.length>3&&(s=function(o,a,l){return t.call(this,o,a,l,n)}):s=function(o,a,l){return t.call(this,o,Rt(a),l,n)}),i[e](s,...r)}function Sl(n,e,t){const r=Pe(n);Dt(r,"iterate",po);const i=r[e](...t);return(i===-1||i===!1)&&Zu(t[0])?(t[0]=Pe(t[0]),r[e](...t)):i}function Bs(n,e,t=[]){Sr(),Ku();const r=Pe(n)[e].apply(n,t);return Hu(),Rr(),r}const IE=qu("__proto__,__v_isRef,__isVue"),fg=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Sn));function EE(n){Sn(n)||(n=String(n));const e=Pe(this);return Dt(e,"has",n),e.hasOwnProperty(n)}class pg{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){const i=this._isReadonly,s=this._isShallow;if(t==="__v_isReactive")return!i;if(t==="__v_isReadonly")return i;if(t==="__v_isShallow")return s;if(t==="__v_raw")return r===(i?s?OE:yg:s?_g:gg).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=he(e);if(!i){let l;if(o&&(l=yE[t]))return l;if(t==="hasOwnProperty")return EE}const a=Reflect.get(e,t,Ct(e)?e:r);return(Sn(t)?fg.has(t):IE(t))||(i||Dt(e,"get",t),s)?a:Ct(a)?o&&Gu(t)?a:a.value:Ue(a)?i?Ig(a):jo(a):a}}class mg extends pg{constructor(e=!1){super(!1,e)}set(e,t,r,i){let s=e[t];if(!this._isShallow){const l=ri(s);if(!an(r)&&!ri(r)&&(s=Pe(s),r=Pe(r)),!he(e)&&Ct(s)&&!Ct(r))return l?!1:(s.value=r,!0)}const o=he(e)&&Gu(t)?Number(t)<e.length:Ce(e,t),a=Reflect.set(e,t,r,Ct(e)?e:i);return e===Pe(i)&&(o?pr(r,s)&&Mn(e,"set",t,r):Mn(e,"add",t,r)),a}deleteProperty(e,t){const r=Ce(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&r&&Mn(e,"delete",t,void 0),i}has(e,t){const r=Reflect.has(e,t);return(!Sn(t)||!fg.has(t))&&Dt(e,"has",t),r}ownKeys(e){return Dt(e,"iterate",he(e)?"length":ti),Reflect.ownKeys(e)}}class TE extends pg{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const wE=new mg,bE=new TE,AE=new mg(!0);const Yu=n=>n,Ac=n=>Reflect.getPrototypeOf(n);function va(n,e,t=!1,r=!1){n=n.__v_raw;const i=Pe(n),s=Pe(e);t||(pr(e,s)&&Dt(i,"get",e),Dt(i,"get",s));const{has:o}=Ac(i),a=r?Yu:t?eh:Rt;if(o.call(i,e))return a(n.get(e));if(o.call(i,s))return a(n.get(s));n!==i&&n.get(e)}function Ia(n,e=!1){const t=this.__v_raw,r=Pe(t),i=Pe(n);return e||(pr(n,i)&&Dt(r,"has",n),Dt(r,"has",i)),n===i?t.has(n):t.has(n)||t.has(i)}function Ea(n,e=!1){return n=n.__v_raw,!e&&Dt(Pe(n),"iterate",ti),Reflect.get(n,"size",n)}function bf(n,e=!1){!e&&!an(n)&&!ri(n)&&(n=Pe(n));const t=Pe(this);return Ac(t).has.call(t,n)||(t.add(n),Mn(t,"add",n,n)),this}function Af(n,e,t=!1){!t&&!an(e)&&!ri(e)&&(e=Pe(e));const r=Pe(this),{has:i,get:s}=Ac(r);let o=i.call(r,n);o||(n=Pe(n),o=i.call(r,n));const a=s.call(r,n);return r.set(n,e),o?pr(e,a)&&Mn(r,"set",n,e):Mn(r,"add",n,e),this}function Sf(n){const e=Pe(this),{has:t,get:r}=Ac(e);let i=t.call(e,n);i||(n=Pe(n),i=t.call(e,n)),r&&r.call(e,n);const s=e.delete(n);return i&&Mn(e,"delete",n,void 0),s}function Rf(){const n=Pe(this),e=n.size!==0,t=n.clear();return e&&Mn(n,"clear",void 0,void 0),t}function Ta(n,e){return function(r,i){const s=this,o=s.__v_raw,a=Pe(o),l=e?Yu:n?eh:Rt;return!n&&Dt(a,"iterate",ti),o.forEach((u,h)=>r.call(i,l(u),l(h),s))}}function wa(n,e,t){return function(...r){const i=this.__v_raw,s=Pe(i),o=Gi(s),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,u=i[n](...r),h=t?Yu:e?eh:Rt;return!e&&Dt(s,"iterate",l?Yl:ti),{next(){const{value:f,done:m}=u.next();return m?{value:f,done:m}:{value:a?[h(f[0]),h(f[1])]:h(f),done:m}},[Symbol.iterator](){return this}}}}function Jn(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function SE(){const n={get(s){return va(this,s)},get size(){return Ea(this)},has:Ia,add:bf,set:Af,delete:Sf,clear:Rf,forEach:Ta(!1,!1)},e={get(s){return va(this,s,!1,!0)},get size(){return Ea(this)},has:Ia,add(s){return bf.call(this,s,!0)},set(s,o){return Af.call(this,s,o,!0)},delete:Sf,clear:Rf,forEach:Ta(!1,!0)},t={get(s){return va(this,s,!0)},get size(){return Ea(this,!0)},has(s){return Ia.call(this,s,!0)},add:Jn("add"),set:Jn("set"),delete:Jn("delete"),clear:Jn("clear"),forEach:Ta(!0,!1)},r={get(s){return va(this,s,!0,!0)},get size(){return Ea(this,!0)},has(s){return Ia.call(this,s,!0)},add:Jn("add"),set:Jn("set"),delete:Jn("delete"),clear:Jn("clear"),forEach:Ta(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{n[s]=wa(s,!1,!1),t[s]=wa(s,!0,!1),e[s]=wa(s,!1,!0),r[s]=wa(s,!0,!0)}),[n,t,e,r]}const[RE,PE,CE,DE]=SE();function Ju(n,e){const t=e?n?DE:CE:n?PE:RE;return(r,i,s)=>i==="__v_isReactive"?!n:i==="__v_isReadonly"?n:i==="__v_raw"?r:Reflect.get(Ce(t,i)&&i in r?t:r,i,s)}const xE={get:Ju(!1,!1)},VE={get:Ju(!1,!0)},NE={get:Ju(!0,!1)};const gg=new WeakMap,_g=new WeakMap,yg=new WeakMap,OE=new WeakMap;function kE(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ME(n){return n.__v_skip||!Object.isExtensible(n)?0:kE(nE(n))}function jo(n){return ri(n)?n:Xu(n,!1,wE,xE,gg)}function vg(n){return Xu(n,!1,AE,VE,_g)}function Ig(n){return Xu(n,!0,bE,NE,yg)}function Xu(n,e,t,r,i){if(!Ue(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const s=i.get(n);if(s)return s;const o=ME(n);if(o===0)return n;const a=new Proxy(n,o===2?r:t);return i.set(n,a),a}function zi(n){return ri(n)?zi(n.__v_raw):!!(n&&n.__v_isReactive)}function ri(n){return!!(n&&n.__v_isReadonly)}function an(n){return!!(n&&n.__v_isShallow)}function Zu(n){return n?!!n.__v_raw:!1}function Pe(n){const e=n&&n.__v_raw;return e?Pe(e):n}function LE(n){return!Ce(n,"__v_skip")&&Object.isExtensible(n)&&Zm(n,"__v_skip",!0),n}const Rt=n=>Ue(n)?jo(n):n,eh=n=>Ue(n)?Ig(n):n;function Ct(n){return n?n.__v_isRef===!0:!1}function FE(n){return Eg(n,!1)}function BE(n){return Eg(n,!0)}function Eg(n,e){return Ct(n)?n:new UE(n,e)}class UE{constructor(e,t){this.dep=new Wu,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:Pe(e),this._value=t?e:Rt(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,r=this.__v_isShallow||an(e)||ri(e);e=r?e:Pe(e),pr(e,t)&&(this._rawValue=e,this._value=r?e:Rt(e),this.dep.trigger())}}function Ki(n){return Ct(n)?n.value:n}const qE={get:(n,e,t)=>e==="__v_raw"?n:Ki(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const i=n[e];return Ct(i)&&!Ct(t)?(i.value=t,!0):Reflect.set(n,e,t,r)}};function Tg(n){return zi(n)?n:new Proxy(n,qE)}class jE{constructor(e,t,r){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Wu(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=fo-1,this.effect=this,this.__v_isReadonly=!t,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&Fe!==this)return ag(this),!0}get value(){const e=this.dep.track();return ug(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function $E(n,e,t=!1){let r,i;return pe(n)?r=n:(r=n.get,i=n.set),new jE(r,i,t)}const ba={},Qa=new WeakMap;let jr;function GE(n,e=!1,t=jr){if(t){let r=Qa.get(t);r||Qa.set(t,r=[]),r.push(n)}}function zE(n,e,t=Be){const{immediate:r,deep:i,once:s,scheduler:o,augmentJob:a,call:l}=t,u=z=>i?z:an(z)||i===!1||i===0?On(z,1):On(z);let h,f,m,_,R=!1,x=!1;if(Ct(n)?(f=()=>n.value,R=an(n)):zi(n)?(f=()=>u(n),R=!0):he(n)?(x=!0,R=n.some(z=>zi(z)||an(z)),f=()=>n.map(z=>{if(Ct(z))return z.value;if(zi(z))return u(z);if(pe(z))return l?l(z,2):z()})):pe(n)?e?f=l?()=>l(n,2):n:f=()=>{if(m){Sr();try{m()}finally{Rr()}}const z=jr;jr=h;try{return l?l(n,3,[_]):n(_)}finally{jr=z}}:f=wn,e&&i){const z=f,se=i===!0?1/0:i;f=()=>On(z(),se)}const N=mE(),j=()=>{h.stop(),N&&$u(N.effects,h)};if(s&&e){const z=e;e=(...se)=>{z(...se),j()}}let U=x?new Array(n.length).fill(ba):ba;const F=z=>{if(!(!(h.flags&1)||!h.dirty&&!z))if(e){const se=h.run();if(i||R||(x?se.some((oe,A)=>pr(oe,U[A])):pr(se,U))){m&&m();const oe=jr;jr=h;try{const A=[se,U===ba?void 0:x&&U[0]===ba?[]:U,_];l?l(e,3,A):e(...A),U=se}finally{jr=oe}}}else h.run()};return a&&a(F),h=new sg(f),h.scheduler=o?()=>o(F,!1):F,_=z=>GE(z,!1,h),m=h.onStop=()=>{const z=Qa.get(h);if(z){if(l)l(z,4);else for(const se of z)se();Qa.delete(h)}},e?r?F(!0):U=h.run():o?o(F.bind(null,!0),!0):h.run(),j.pause=h.pause.bind(h),j.resume=h.resume.bind(h),j.stop=j,j}function On(n,e=1/0,t){if(e<=0||!Ue(n)||n.__v_skip||(t=t||new Set,t.has(n)))return n;if(t.add(n),e--,Ct(n))On(n.value,e,t);else if(he(n))for(let r=0;r<n.length;r++)On(n[r],e,t);else if(Ic(n)||Gi(n))n.forEach(r=>{On(r,e,t)});else if(Xm(n)){for(const r in n)On(n[r],e,t);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&On(n[r],e,t)}return n}/**
* @vue/runtime-core v3.5.7
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function $o(n,e,t,r){try{return r?n(...r):n()}catch(i){Sc(i,e,t)}}function fn(n,e,t,r){if(pe(n)){const i=$o(n,e,t,r);return i&&Ym(i)&&i.catch(s=>{Sc(s,e,t)}),i}if(he(n)){const i=[];for(let s=0;s<n.length;s++)i.push(fn(n[s],e,t,r));return i}}function Sc(n,e,t,r=!0){const i=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||Be;if(e){let a=e.parent;const l=e.proxy,u=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const h=a.ec;if(h){for(let f=0;f<h.length;f++)if(h[f](n,l,u)===!1)return}a=a.parent}if(s){Sr(),$o(s,null,10,[n,l,u]),Rr();return}}KE(n,t,i,r,o)}function KE(n,e,t,r=!0,i=!1){if(i)throw n;console.error(n)}let mo=!1,Jl=!1;const Mt=[];let vn=0;const Hi=[];let ir=null,ki=0;const wg=Promise.resolve();let th=null;function nh(n){const e=th||wg;return n?e.then(this?n.bind(this):n):e}function HE(n){let e=mo?vn+1:0,t=Mt.length;for(;e<t;){const r=e+t>>>1,i=Mt[r],s=go(i);s<n||s===n&&i.flags&2?e=r+1:t=r}return e}function rh(n){if(!(n.flags&1)){const e=go(n),t=Mt[Mt.length-1];!t||!(n.flags&2)&&e>=go(t)?Mt.push(n):Mt.splice(HE(e),0,n),n.flags|=1,bg()}}function bg(){!mo&&!Jl&&(Jl=!0,th=wg.then(Sg))}function QE(n){he(n)?Hi.push(...n):ir&&n.id===-1?ir.splice(ki+1,0,n):n.flags&1||(Hi.push(n),n.flags|=1),bg()}function Pf(n,e,t=mo?vn+1:0){for(;t<Mt.length;t++){const r=Mt[t];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;Mt.splice(t,1),t--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function Ag(n){if(Hi.length){const e=[...new Set(Hi)].sort((t,r)=>go(t)-go(r));if(Hi.length=0,ir){ir.push(...e);return}for(ir=e,ki=0;ki<ir.length;ki++){const t=ir[ki];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}ir=null,ki=0}}const go=n=>n.id==null?n.flags&2?-1:1/0:n.id;function Sg(n){Jl=!1,mo=!0;try{for(vn=0;vn<Mt.length;vn++){const e=Mt[vn];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),$o(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;vn<Mt.length;vn++){const e=Mt[vn];e&&(e.flags&=-2)}vn=0,Mt.length=0,Ag(),mo=!1,th=null,(Mt.length||Hi.length)&&Sg()}}let $t=null,Rg=null;function Wa(n){const e=$t;return $t=n,Rg=n&&n.type.__scopeId||null,e}function Rc(n,e=$t,t){if(!e||n._n)return n;const r=(...i)=>{r._d&&Ff(-1);const s=Wa(e);let o;try{o=n(...i)}finally{Wa(s),r._d&&Ff(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function ot(n,e){if($t===null)return n;const t=Nc($t),r=n.dirs||(n.dirs=[]);for(let i=0;i<e.length;i++){let[s,o,a,l=Be]=e[i];s&&(pe(s)&&(s={mounted:s,updated:s}),s.deep&&On(o),r.push({dir:s,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function Lr(n,e,t,r){const i=n.dirs,s=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];s&&(a.oldValue=s[o].value);let l=a.dir[r];l&&(Sr(),fn(l,t,8,[n.el,a,n,e]),Rr())}}const WE=Symbol("_vte"),Pg=n=>n.__isTeleport,sr=Symbol("_leaveCb"),Aa=Symbol("_enterCb");function YE(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Lg(()=>{n.isMounted=!0}),Fg(()=>{n.isUnmounting=!0}),n}const rn=[Function,Array],Cg={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:rn,onEnter:rn,onAfterEnter:rn,onEnterCancelled:rn,onBeforeLeave:rn,onLeave:rn,onAfterLeave:rn,onLeaveCancelled:rn,onBeforeAppear:rn,onAppear:rn,onAfterAppear:rn,onAppearCancelled:rn},Dg=n=>{const e=n.subTree;return e.component?Dg(e.component):e},JE={name:"BaseTransition",props:Cg,setup(n,{slots:e}){const t=HT(),r=YE();return()=>{const i=e.default&&Ng(e.default(),!0);if(!i||!i.length)return;const s=xg(i),o=Pe(n),{mode:a}=o;if(r.isLeaving)return Rl(s);const l=Cf(s);if(!l)return Rl(s);let u=Xl(l,o,r,t,m=>u=m);l.type!==jt&&_o(l,u);const h=t.subTree,f=h&&Cf(h);if(f&&f.type!==jt&&!zr(l,f)&&Dg(t).type!==jt){const m=Xl(f,o,r,t);if(_o(f,m),a==="out-in"&&l.type!==jt)return r.isLeaving=!0,m.afterLeave=()=>{r.isLeaving=!1,t.job.flags&8||t.update(),delete m.afterLeave},Rl(s);a==="in-out"&&l.type!==jt&&(m.delayLeave=(_,R,x)=>{const N=Vg(r,f);N[String(f.key)]=f,_[sr]=()=>{R(),_[sr]=void 0,delete u.delayedLeave},u.delayedLeave=x})}return s}}};function xg(n){let e=n[0];if(n.length>1){for(const t of n)if(t.type!==jt){e=t;break}}return e}const XE=JE;function Vg(n,e){const{leavingVNodes:t}=n;let r=t.get(e.type);return r||(r=Object.create(null),t.set(e.type,r)),r}function Xl(n,e,t,r,i){const{appear:s,mode:o,persisted:a=!1,onBeforeEnter:l,onEnter:u,onAfterEnter:h,onEnterCancelled:f,onBeforeLeave:m,onLeave:_,onAfterLeave:R,onLeaveCancelled:x,onBeforeAppear:N,onAppear:j,onAfterAppear:U,onAppearCancelled:F}=e,z=String(n.key),se=Vg(t,n),oe=(I,b)=>{I&&fn(I,r,9,b)},A=(I,b)=>{const S=b[1];oe(I,b),he(I)?I.every(w=>w.length<=1)&&S():I.length<=1&&S()},v={mode:o,persisted:a,beforeEnter(I){let b=l;if(!t.isMounted)if(s)b=N||l;else return;I[sr]&&I[sr](!0);const S=se[z];S&&zr(n,S)&&S.el[sr]&&S.el[sr](),oe(b,[I])},enter(I){let b=u,S=h,w=f;if(!t.isMounted)if(s)b=j||u,S=U||h,w=F||f;else return;let E=!1;const Ne=I[Aa]=mt=>{E||(E=!0,mt?oe(w,[I]):oe(S,[I]),v.delayedLeave&&v.delayedLeave(),I[Aa]=void 0)};b?A(b,[I,Ne]):Ne()},leave(I,b){const S=String(n.key);if(I[Aa]&&I[Aa](!0),t.isUnmounting)return b();oe(m,[I]);let w=!1;const E=I[sr]=Ne=>{w||(w=!0,b(),Ne?oe(x,[I]):oe(R,[I]),I[sr]=void 0,se[S]===n&&delete se[S])};se[S]=n,_?A(_,[I,E]):E()},clone(I){const b=Xl(I,e,t,r,i);return i&&i(b),b}};return v}function Rl(n){if(Pc(n))return n=mr(n),n.children=null,n}function Cf(n){if(!Pc(n))return Pg(n.type)&&n.children?xg(n.children):n;const{shapeFlag:e,children:t}=n;if(t){if(e&16)return t[0];if(e&32&&pe(t.default))return t.default()}}function _o(n,e){n.shapeFlag&6&&n.component?(n.transition=e,_o(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function Ng(n,e=!1,t){let r=[],i=0;for(let s=0;s<n.length;s++){let o=n[s];const a=t==null?o.key:String(t)+String(o.key!=null?o.key:s);o.type===Xt?(o.patchFlag&128&&i++,r=r.concat(Ng(o.children,e,a))):(e||o.type!==jt)&&r.push(a!=null?mr(o,{key:a}):o)}if(i>1)for(let s=0;s<r.length;s++)r[s].patchFlag=-2;return r}/*! #__NO_SIDE_EFFECTS__ */function Og(n,e){return pe(n)?at({name:n.name},e,{setup:n}):n}function kg(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function Zl(n,e,t,r,i=!1){if(he(n)){n.forEach((R,x)=>Zl(R,e&&(he(e)?e[x]:e),t,r,i));return}if(to(r)&&!i)return;const s=r.shapeFlag&4?Nc(r.component):r.el,o=i?null:s,{i:a,r:l}=n,u=e&&e.r,h=a.refs===Be?a.refs={}:a.refs,f=a.setupState,m=Pe(f),_=f===Be?()=>!1:R=>Ce(m,R);if(u!=null&&u!==l&&(rt(u)?(h[u]=null,_(u)&&(f[u]=null)):Ct(u)&&(u.value=null)),pe(l))$o(l,a,12,[o,h]);else{const R=rt(l),x=Ct(l);if(R||x){const N=()=>{if(n.f){const j=R?_(l)?f[l]:h[l]:l.value;i?he(j)&&$u(j,s):he(j)?j.includes(s)||j.push(s):R?(h[l]=[s],_(l)&&(f[l]=h[l])):(l.value=[s],n.k&&(h[n.k]=l.value))}else R?(h[l]=o,_(l)&&(f[l]=o)):x&&(l.value=o,n.k&&(h[n.k]=o))};o?(N.id=-1,Yt(N,t)):N()}}}const to=n=>!!n.type.__asyncLoader,Pc=n=>n.type.__isKeepAlive;function ZE(n,e){Mg(n,"a",e)}function eT(n,e){Mg(n,"da",e)}function Mg(n,e,t=vt){const r=n.__wdc||(n.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}return n()});if(Cc(e,r,t),t){let i=t.parent;for(;i&&i.parent;)Pc(i.parent.vnode)&&tT(r,e,t,i),i=i.parent}}function tT(n,e,t,r){const i=Cc(e,n,r,!0);Bg(()=>{$u(r[e],i)},t)}function Cc(n,e,t=vt,r=!1){if(t){const i=t[n]||(t[n]=[]),s=e.__weh||(e.__weh=(...o)=>{Sr();const a=Go(t),l=fn(e,t,n,o);return a(),Rr(),l});return r?i.unshift(s):i.push(s),s}}const jn=n=>(e,t=vt)=>{(!Vc||n==="sp")&&Cc(n,(...r)=>e(...r),t)},nT=jn("bm"),Lg=jn("m"),rT=jn("bu"),iT=jn("u"),Fg=jn("bum"),Bg=jn("um"),sT=jn("sp"),oT=jn("rtg"),aT=jn("rtc");function cT(n,e=vt){Cc("ec",n,e)}const lT="components";function ur(n,e){return hT(lT,n,!0,e)||n}const uT=Symbol.for("v-ndc");function hT(n,e,t=!0,r=!1){const i=$t||vt;if(i){const s=i.type;{const a=XT(s,!1);if(a&&(a===e||a===dn(e)||a===Tc(dn(e))))return s}const o=Df(i[n]||s[n],e)||Df(i.appContext[n],e);return!o&&r?s:o}}function Df(n,e){return n&&(n[e]||n[dn(e)]||n[Tc(dn(e))])}function ih(n,e,t,r){let i;const s=t,o=he(n);if(o||rt(n)){const a=o&&zi(n);let l=!1;a&&(l=!an(n),n=bc(n)),i=new Array(n.length);for(let u=0,h=n.length;u<h;u++)i[u]=e(l?Rt(n[u]):n[u],u,void 0,s)}else if(typeof n=="number"){i=new Array(n);for(let a=0;a<n;a++)i[a]=e(a+1,a,void 0,s)}else if(Ue(n))if(n[Symbol.iterator])i=Array.from(n,(a,l)=>e(a,l,void 0,s));else{const a=Object.keys(n);i=new Array(a.length);for(let l=0,u=a.length;l<u;l++){const h=a[l];i[l]=e(n[h],h,l,s)}}else i=[];return i}const eu=n=>n?s_(n)?Nc(n):eu(n.parent):null,no=at(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>eu(n.parent),$root:n=>eu(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>sh(n),$forceUpdate:n=>n.f||(n.f=()=>{rh(n.update)}),$nextTick:n=>n.n||(n.n=nh.bind(n.proxy)),$watch:n=>VT.bind(n)}),Pl=(n,e)=>n!==Be&&!n.__isScriptSetup&&Ce(n,e),dT={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:r,data:i,props:s,accessCache:o,type:a,appContext:l}=n;let u;if(e[0]!=="$"){const _=o[e];if(_!==void 0)switch(_){case 1:return r[e];case 2:return i[e];case 4:return t[e];case 3:return s[e]}else{if(Pl(r,e))return o[e]=1,r[e];if(i!==Be&&Ce(i,e))return o[e]=2,i[e];if((u=n.propsOptions[0])&&Ce(u,e))return o[e]=3,s[e];if(t!==Be&&Ce(t,e))return o[e]=4,t[e];tu&&(o[e]=0)}}const h=no[e];let f,m;if(h)return e==="$attrs"&&Dt(n.attrs,"get",""),h(n);if((f=a.__cssModules)&&(f=f[e]))return f;if(t!==Be&&Ce(t,e))return o[e]=4,t[e];if(m=l.config.globalProperties,Ce(m,e))return m[e]},set({_:n},e,t){const{data:r,setupState:i,ctx:s}=n;return Pl(i,e)?(i[e]=t,!0):r!==Be&&Ce(r,e)?(r[e]=t,!0):Ce(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(s[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:i,propsOptions:s}},o){let a;return!!t[o]||n!==Be&&Ce(n,o)||Pl(e,o)||(a=s[0])&&Ce(a,o)||Ce(r,o)||Ce(no,o)||Ce(i.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:Ce(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function xf(n){return he(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let tu=!0;function fT(n){const e=sh(n),t=n.proxy,r=n.ctx;tu=!1,e.beforeCreate&&Vf(e.beforeCreate,n,"bc");const{data:i,computed:s,methods:o,watch:a,provide:l,inject:u,created:h,beforeMount:f,mounted:m,beforeUpdate:_,updated:R,activated:x,deactivated:N,beforeDestroy:j,beforeUnmount:U,destroyed:F,unmounted:z,render:se,renderTracked:oe,renderTriggered:A,errorCaptured:v,serverPrefetch:I,expose:b,inheritAttrs:S,components:w,directives:E,filters:Ne}=e;if(u&&pT(u,r,null),o)for(const Ee in o){const ge=o[Ee];pe(ge)&&(r[Ee]=ge.bind(t))}if(i){const Ee=i.call(t,t);Ue(Ee)&&(n.data=jo(Ee))}if(tu=!0,s)for(const Ee in s){const ge=s[Ee],Qt=pe(ge)?ge.bind(t,t):pe(ge.get)?ge.get.bind(t,t):wn,ln=!pe(ge)&&pe(ge.set)?ge.set.bind(t):wn,tn=sn({get:Qt,set:ln});Object.defineProperty(r,Ee,{enumerable:!0,configurable:!0,get:()=>tn.value,set:We=>tn.value=We})}if(a)for(const Ee in a)Ug(a[Ee],r,t,Ee);if(l){const Ee=pe(l)?l.call(t):l;Reflect.ownKeys(Ee).forEach(ge=>{Oa(ge,Ee[ge])})}h&&Vf(h,n,"c");function Qe(Ee,ge){he(ge)?ge.forEach(Qt=>Ee(Qt.bind(t))):ge&&Ee(ge.bind(t))}if(Qe(nT,f),Qe(Lg,m),Qe(rT,_),Qe(iT,R),Qe(ZE,x),Qe(eT,N),Qe(cT,v),Qe(aT,oe),Qe(oT,A),Qe(Fg,U),Qe(Bg,z),Qe(sT,I),he(b))if(b.length){const Ee=n.exposed||(n.exposed={});b.forEach(ge=>{Object.defineProperty(Ee,ge,{get:()=>t[ge],set:Qt=>t[ge]=Qt})})}else n.exposed||(n.exposed={});se&&n.render===wn&&(n.render=se),S!=null&&(n.inheritAttrs=S),w&&(n.components=w),E&&(n.directives=E),I&&kg(n)}function pT(n,e,t=wn){he(n)&&(n=nu(n));for(const r in n){const i=n[r];let s;Ue(i)?"default"in i?s=Ln(i.from||r,i.default,!0):s=Ln(i.from||r):s=Ln(i),Ct(s)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[r]=s}}function Vf(n,e,t){fn(he(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function Ug(n,e,t,r){let i=r.includes(".")?e_(t,r):()=>t[r];if(rt(n)){const s=e[n];pe(s)&&Wi(i,s)}else if(pe(n))Wi(i,n.bind(t));else if(Ue(n))if(he(n))n.forEach(s=>Ug(s,e,t,r));else{const s=pe(n.handler)?n.handler.bind(t):e[n.handler];pe(s)&&Wi(i,s,n)}}function sh(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:i,optionsCache:s,config:{optionMergeStrategies:o}}=n.appContext,a=s.get(e);let l;return a?l=a:!i.length&&!t&&!r?l=e:(l={},i.length&&i.forEach(u=>Ya(l,u,o,!0)),Ya(l,e,o)),Ue(e)&&s.set(e,l),l}function Ya(n,e,t,r=!1){const{mixins:i,extends:s}=e;s&&Ya(n,s,t,!0),i&&i.forEach(o=>Ya(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=mT[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const mT={data:Nf,props:Of,emits:Of,methods:Qs,computed:Qs,beforeCreate:Nt,created:Nt,beforeMount:Nt,mounted:Nt,beforeUpdate:Nt,updated:Nt,beforeDestroy:Nt,beforeUnmount:Nt,destroyed:Nt,unmounted:Nt,activated:Nt,deactivated:Nt,errorCaptured:Nt,serverPrefetch:Nt,components:Qs,directives:Qs,watch:_T,provide:Nf,inject:gT};function Nf(n,e){return e?n?function(){return at(pe(n)?n.call(this,this):n,pe(e)?e.call(this,this):e)}:e:n}function gT(n,e){return Qs(nu(n),nu(e))}function nu(n){if(he(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function Nt(n,e){return n?[...new Set([].concat(n,e))]:e}function Qs(n,e){return n?at(Object.create(null),n,e):e}function Of(n,e){return n?he(n)&&he(e)?[...new Set([...n,...e])]:at(Object.create(null),xf(n),xf(e??{})):e}function _T(n,e){if(!n)return e;if(!e)return n;const t=at(Object.create(null),n);for(const r in e)t[r]=Nt(n[r],e[r]);return t}function qg(){return{app:null,config:{isNativeTag:eE,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let yT=0;function vT(n,e){return function(r,i=null){pe(r)||(r=at({},r)),i!=null&&!Ue(i)&&(i=null);const s=qg(),o=new WeakSet,a=[];let l=!1;const u=s.app={_uid:yT++,_component:r,_props:i,_container:null,_context:s,_instance:null,version:ew,get config(){return s.config},set config(h){},use(h,...f){return o.has(h)||(h&&pe(h.install)?(o.add(h),h.install(u,...f)):pe(h)&&(o.add(h),h(u,...f))),u},mixin(h){return s.mixins.includes(h)||s.mixins.push(h),u},component(h,f){return f?(s.components[h]=f,u):s.components[h]},directive(h,f){return f?(s.directives[h]=f,u):s.directives[h]},mount(h,f,m){if(!l){const _=u._ceVNode||dt(r,i);return _.appContext=s,m===!0?m="svg":m===!1&&(m=void 0),f&&e?e(_,h):n(_,h,m),l=!0,u._container=h,h.__vue_app__=u,Nc(_.component)}},onUnmount(h){a.push(h)},unmount(){l&&(fn(a,u._instance,16),n(null,u._container),delete u._container.__vue_app__)},provide(h,f){return s.provides[h]=f,u},runWithContext(h){const f=Qi;Qi=u;try{return h()}finally{Qi=f}}};return u}}let Qi=null;function Oa(n,e){if(vt){let t=vt.provides;const r=vt.parent&&vt.parent.provides;r===t&&(t=vt.provides=Object.create(r)),t[n]=e}}function Ln(n,e,t=!1){const r=vt||$t;if(r||Qi){const i=Qi?Qi._context.provides:r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(i&&n in i)return i[n];if(arguments.length>1)return t&&pe(e)?e.call(r&&r.proxy):e}}const jg={},$g=()=>Object.create(jg),Gg=n=>Object.getPrototypeOf(n)===jg;function IT(n,e,t,r=!1){const i={},s=$g();n.propsDefaults=Object.create(null),zg(n,e,i,s);for(const o in n.propsOptions[0])o in i||(i[o]=void 0);t?n.props=r?i:vg(i):n.type.props?n.props=i:n.props=s,n.attrs=s}function ET(n,e,t,r){const{props:i,attrs:s,vnode:{patchFlag:o}}=n,a=Pe(i),[l]=n.propsOptions;let u=!1;if((r||o>0)&&!(o&16)){if(o&8){const h=n.vnode.dynamicProps;for(let f=0;f<h.length;f++){let m=h[f];if(Dc(n.emitsOptions,m))continue;const _=e[m];if(l)if(Ce(s,m))_!==s[m]&&(s[m]=_,u=!0);else{const R=dn(m);i[R]=ru(l,a,R,_,n,!1)}else _!==s[m]&&(s[m]=_,u=!0)}}}else{zg(n,e,i,s)&&(u=!0);let h;for(const f in a)(!e||!Ce(e,f)&&((h=pi(f))===f||!Ce(e,h)))&&(l?t&&(t[f]!==void 0||t[h]!==void 0)&&(i[f]=ru(l,a,f,void 0,n,!0)):delete i[f]);if(s!==a)for(const f in s)(!e||!Ce(e,f))&&(delete s[f],u=!0)}u&&Mn(n.attrs,"set","")}function zg(n,e,t,r){const[i,s]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(Zs(l))continue;const u=e[l];let h;i&&Ce(i,h=dn(l))?!s||!s.includes(h)?t[h]=u:(a||(a={}))[h]=u:Dc(n.emitsOptions,l)||(!(l in r)||u!==r[l])&&(r[l]=u,o=!0)}if(s){const l=Pe(t),u=a||Be;for(let h=0;h<s.length;h++){const f=s[h];t[f]=ru(i,l,f,u[f],n,!Ce(u,f))}}return o}function ru(n,e,t,r,i,s){const o=n[t];if(o!=null){const a=Ce(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&pe(l)){const{propsDefaults:u}=i;if(t in u)r=u[t];else{const h=Go(i);r=u[t]=l.call(null,e),h()}}else r=l;i.ce&&i.ce._setProp(t,r)}o[0]&&(s&&!a?r=!1:o[1]&&(r===""||r===pi(t))&&(r=!0))}return r}const TT=new WeakMap;function Kg(n,e,t=!1){const r=t?TT:e.propsCache,i=r.get(n);if(i)return i;const s=n.props,o={},a=[];let l=!1;if(!pe(n)){const h=f=>{l=!0;const[m,_]=Kg(f,e,!0);at(o,m),_&&a.push(..._)};!t&&e.mixins.length&&e.mixins.forEach(h),n.extends&&h(n.extends),n.mixins&&n.mixins.forEach(h)}if(!s&&!l)return Ue(n)&&r.set(n,$i),$i;if(he(s))for(let h=0;h<s.length;h++){const f=dn(s[h]);kf(f)&&(o[f]=Be)}else if(s)for(const h in s){const f=dn(h);if(kf(f)){const m=s[h],_=o[f]=he(m)||pe(m)?{type:m}:at({},m),R=_.type;let x=!1,N=!0;if(he(R))for(let j=0;j<R.length;++j){const U=R[j],F=pe(U)&&U.name;if(F==="Boolean"){x=!0;break}else F==="String"&&(N=!1)}else x=pe(R)&&R.name==="Boolean";_[0]=x,_[1]=N,(x||Ce(_,"default"))&&a.push(f)}}const u=[o,a];return Ue(n)&&r.set(n,u),u}function kf(n){return n[0]!=="$"&&!Zs(n)}const Hg=n=>n[0]==="_"||n==="$stable",oh=n=>he(n)?n.map(In):[In(n)],wT=(n,e,t)=>{if(e._n)return e;const r=Rc((...i)=>oh(e(...i)),t);return r._c=!1,r},Qg=(n,e,t)=>{const r=n._ctx;for(const i in n){if(Hg(i))continue;const s=n[i];if(pe(s))e[i]=wT(i,s,r);else if(s!=null){const o=oh(s);e[i]=()=>o}}},Wg=(n,e)=>{const t=oh(e);n.slots.default=()=>t},Yg=(n,e,t)=>{for(const r in e)(t||r!=="_")&&(n[r]=e[r])},bT=(n,e,t)=>{const r=n.slots=$g();if(n.vnode.shapeFlag&32){const i=e._;i?(Yg(r,e,t),t&&Zm(r,"_",i,!0)):Qg(e,r)}else e&&Wg(n,e)},AT=(n,e,t)=>{const{vnode:r,slots:i}=n;let s=!0,o=Be;if(r.shapeFlag&32){const a=e._;a?t&&a===1?s=!1:Yg(i,e,t):(s=!e.$stable,Qg(e,i)),o=e}else e&&(Wg(n,e),o={default:1});if(s)for(const a in i)!Hg(a)&&o[a]==null&&delete i[a]},Yt=BT;function ST(n){return RT(n)}function RT(n,e){const t=eg();t.__VUE__=!0;const{insert:r,remove:i,patchProp:s,createElement:o,createText:a,createComment:l,setText:u,setElementText:h,parentNode:f,nextSibling:m,setScopeId:_=wn,insertStaticContent:R}=n,x=(y,T,V,$=null,M=null,G=null,X=void 0,Q=null,H=!!T.dynamicChildren)=>{if(y===T)return;y&&!zr(y,T)&&($=L(y),We(y,M,G,!0),y=null),T.patchFlag===-2&&(H=!1,T.dynamicChildren=null);const{type:K,ref:ue,shapeFlag:ee}=T;switch(K){case xc:N(y,T,V,$);break;case jt:j(y,T,V,$);break;case xl:y==null&&U(T,V,$,X);break;case Xt:w(y,T,V,$,M,G,X,Q,H);break;default:ee&1?se(y,T,V,$,M,G,X,Q,H):ee&6?E(y,T,V,$,M,G,X,Q,H):(ee&64||ee&128)&&K.process(y,T,V,$,M,G,X,Q,H,re)}ue!=null&&M&&Zl(ue,y&&y.ref,G,T||y,!T)},N=(y,T,V,$)=>{if(y==null)r(T.el=a(T.children),V,$);else{const M=T.el=y.el;T.children!==y.children&&u(M,T.children)}},j=(y,T,V,$)=>{y==null?r(T.el=l(T.children||""),V,$):T.el=y.el},U=(y,T,V,$)=>{[y.el,y.anchor]=R(y.children,T,V,$,y.el,y.anchor)},F=({el:y,anchor:T},V,$)=>{let M;for(;y&&y!==T;)M=m(y),r(y,V,$),y=M;r(T,V,$)},z=({el:y,anchor:T})=>{let V;for(;y&&y!==T;)V=m(y),i(y),y=V;i(T)},se=(y,T,V,$,M,G,X,Q,H)=>{T.type==="svg"?X="svg":T.type==="math"&&(X="mathml"),y==null?oe(T,V,$,M,G,X,Q,H):I(y,T,M,G,X,Q,H)},oe=(y,T,V,$,M,G,X,Q)=>{let H,K;const{props:ue,shapeFlag:ee,transition:ce,dirs:ie}=y;if(H=y.el=o(y.type,G,ue&&ue.is,ue),ee&8?h(H,y.children):ee&16&&v(y.children,H,null,$,M,Cl(y,G),X,Q),ie&&Lr(y,null,$,"created"),A(H,y,y.scopeId,X,$),ue){for(const Re in ue)Re!=="value"&&!Zs(Re)&&s(H,Re,null,ue[Re],G,$);"value"in ue&&s(H,"value",null,ue.value,G),(K=ue.onVnodeBeforeMount)&&yn(K,$,y)}ie&&Lr(y,null,$,"beforeMount");const de=PT(M,ce);de&&ce.beforeEnter(H),r(H,T,V),((K=ue&&ue.onVnodeMounted)||de||ie)&&Yt(()=>{K&&yn(K,$,y),de&&ce.enter(H),ie&&Lr(y,null,$,"mounted")},M)},A=(y,T,V,$,M)=>{if(V&&_(y,V),$)for(let G=0;G<$.length;G++)_(y,$[G]);if(M){let G=M.subTree;if(T===G||n_(G.type)&&(G.ssContent===T||G.ssFallback===T)){const X=M.vnode;A(y,X,X.scopeId,X.slotScopeIds,M.parent)}}},v=(y,T,V,$,M,G,X,Q,H=0)=>{for(let K=H;K<y.length;K++){const ue=y[K]=Q?or(y[K]):In(y[K]);x(null,ue,T,V,$,M,G,X,Q)}},I=(y,T,V,$,M,G,X)=>{const Q=T.el=y.el;let{patchFlag:H,dynamicChildren:K,dirs:ue}=T;H|=y.patchFlag&16;const ee=y.props||Be,ce=T.props||Be;let ie;if(V&&Fr(V,!1),(ie=ce.onVnodeBeforeUpdate)&&yn(ie,V,T,y),ue&&Lr(T,y,V,"beforeUpdate"),V&&Fr(V,!0),(ee.innerHTML&&ce.innerHTML==null||ee.textContent&&ce.textContent==null)&&h(Q,""),K?b(y.dynamicChildren,K,Q,V,$,Cl(T,M),G):X||ge(y,T,Q,null,V,$,Cl(T,M),G,!1),H>0){if(H&16)S(Q,ee,ce,V,M);else if(H&2&&ee.class!==ce.class&&s(Q,"class",null,ce.class,M),H&4&&s(Q,"style",ee.style,ce.style,M),H&8){const de=T.dynamicProps;for(let Re=0;Re<de.length;Re++){const Ae=de[Re],Et=ee[Ae],lt=ce[Ae];(lt!==Et||Ae==="value")&&s(Q,Ae,Et,lt,M,V)}}H&1&&y.children!==T.children&&h(Q,T.children)}else!X&&K==null&&S(Q,ee,ce,V,M);((ie=ce.onVnodeUpdated)||ue)&&Yt(()=>{ie&&yn(ie,V,T,y),ue&&Lr(T,y,V,"updated")},$)},b=(y,T,V,$,M,G,X)=>{for(let Q=0;Q<T.length;Q++){const H=y[Q],K=T[Q],ue=H.el&&(H.type===Xt||!zr(H,K)||H.shapeFlag&70)?f(H.el):V;x(H,K,ue,null,$,M,G,X,!0)}},S=(y,T,V,$,M)=>{if(T!==V){if(T!==Be)for(const G in T)!Zs(G)&&!(G in V)&&s(y,G,T[G],null,M,$);for(const G in V){if(Zs(G))continue;const X=V[G],Q=T[G];X!==Q&&G!=="value"&&s(y,G,Q,X,M,$)}"value"in V&&s(y,"value",T.value,V.value,M)}},w=(y,T,V,$,M,G,X,Q,H)=>{const K=T.el=y?y.el:a(""),ue=T.anchor=y?y.anchor:a("");let{patchFlag:ee,dynamicChildren:ce,slotScopeIds:ie}=T;ie&&(Q=Q?Q.concat(ie):ie),y==null?(r(K,V,$),r(ue,V,$),v(T.children||[],V,ue,M,G,X,Q,H)):ee>0&&ee&64&&ce&&y.dynamicChildren?(b(y.dynamicChildren,ce,V,M,G,X,Q),(T.key!=null||M&&T===M.subTree)&&Jg(y,T,!0)):ge(y,T,V,ue,M,G,X,Q,H)},E=(y,T,V,$,M,G,X,Q,H)=>{T.slotScopeIds=Q,y==null?T.shapeFlag&512?M.ctx.activate(T,V,$,X,H):Ne(T,V,$,M,G,X,H):mt(y,T,H)},Ne=(y,T,V,$,M,G,X)=>{const Q=y.component=KT(y,$,M);if(Pc(y)&&(Q.ctx.renderer=re),QT(Q,!1,X),Q.asyncDep){if(M&&M.registerDep(Q,Qe,X),!y.el){const H=Q.subTree=dt(jt);j(null,H,T,V)}}else Qe(Q,y,T,V,M,G,X)},mt=(y,T,V)=>{const $=T.component=y.component;if(LT(y,T,V))if($.asyncDep&&!$.asyncResolved){Ee($,T,V);return}else $.next=T,$.update();else T.el=y.el,$.vnode=T},Qe=(y,T,V,$,M,G,X)=>{const Q=()=>{if(y.isMounted){let{next:ee,bu:ce,u:ie,parent:de,vnode:Re}=y;{const Tt=Xg(y);if(Tt){ee&&(ee.el=Re.el,Ee(y,ee,X)),Tt.asyncDep.then(()=>{y.isUnmounted||Q()});return}}let Ae=ee,Et;Fr(y,!1),ee?(ee.el=Re.el,Ee(y,ee,X)):ee=Re,ce&&Na(ce),(Et=ee.props&&ee.props.onVnodeBeforeUpdate)&&yn(Et,de,ee,Re),Fr(y,!0);const lt=Dl(y),gt=y.subTree;y.subTree=lt,x(gt,lt,f(gt.el),L(gt),y,M,G),ee.el=lt.el,Ae===null&&FT(y,lt.el),ie&&Yt(ie,M),(Et=ee.props&&ee.props.onVnodeUpdated)&&Yt(()=>yn(Et,de,ee,Re),M)}else{let ee;const{el:ce,props:ie}=T,{bm:de,m:Re,parent:Ae,root:Et,type:lt}=y,gt=to(T);if(Fr(y,!1),de&&Na(de),!gt&&(ee=ie&&ie.onVnodeBeforeMount)&&yn(ee,Ae,T),Fr(y,!0),ce&&ke){const Tt=()=>{y.subTree=Dl(y),ke(ce,y.subTree,y,M,null)};gt&&lt.__asyncHydrate?lt.__asyncHydrate(ce,y,Tt):Tt()}else{Et.ce&&Et.ce._injectChildStyle(lt);const Tt=y.subTree=Dl(y);x(null,Tt,V,$,y,M,G),T.el=Tt.el}if(Re&&Yt(Re,M),!gt&&(ee=ie&&ie.onVnodeMounted)){const Tt=T;Yt(()=>yn(ee,Ae,Tt),M)}(T.shapeFlag&256||Ae&&to(Ae.vnode)&&Ae.vnode.shapeFlag&256)&&y.a&&Yt(y.a,M),y.isMounted=!0,T=V=$=null}};y.scope.on();const H=y.effect=new sg(Q);y.scope.off();const K=y.update=H.run.bind(H),ue=y.job=H.runIfDirty.bind(H);ue.i=y,ue.id=y.uid,H.scheduler=()=>rh(ue),Fr(y,!0),K()},Ee=(y,T,V)=>{T.component=y;const $=y.vnode.props;y.vnode=T,y.next=null,ET(y,T.props,$,V),AT(y,T.children,V),Sr(),Pf(y),Rr()},ge=(y,T,V,$,M,G,X,Q,H=!1)=>{const K=y&&y.children,ue=y?y.shapeFlag:0,ee=T.children,{patchFlag:ce,shapeFlag:ie}=T;if(ce>0){if(ce&128){ln(K,ee,V,$,M,G,X,Q,H);return}else if(ce&256){Qt(K,ee,V,$,M,G,X,Q,H);return}}ie&8?(ue&16&&Ut(K,M,G),ee!==K&&h(V,ee)):ue&16?ie&16?ln(K,ee,V,$,M,G,X,Q,H):Ut(K,M,G,!0):(ue&8&&h(V,""),ie&16&&v(ee,V,$,M,G,X,Q,H))},Qt=(y,T,V,$,M,G,X,Q,H)=>{y=y||$i,T=T||$i;const K=y.length,ue=T.length,ee=Math.min(K,ue);let ce;for(ce=0;ce<ee;ce++){const ie=T[ce]=H?or(T[ce]):In(T[ce]);x(y[ce],ie,V,null,M,G,X,Q,H)}K>ue?Ut(y,M,G,!0,!1,ee):v(T,V,$,M,G,X,Q,H,ee)},ln=(y,T,V,$,M,G,X,Q,H)=>{let K=0;const ue=T.length;let ee=y.length-1,ce=ue-1;for(;K<=ee&&K<=ce;){const ie=y[K],de=T[K]=H?or(T[K]):In(T[K]);if(zr(ie,de))x(ie,de,V,null,M,G,X,Q,H);else break;K++}for(;K<=ee&&K<=ce;){const ie=y[ee],de=T[ce]=H?or(T[ce]):In(T[ce]);if(zr(ie,de))x(ie,de,V,null,M,G,X,Q,H);else break;ee--,ce--}if(K>ee){if(K<=ce){const ie=ce+1,de=ie<ue?T[ie].el:$;for(;K<=ce;)x(null,T[K]=H?or(T[K]):In(T[K]),V,de,M,G,X,Q,H),K++}}else if(K>ce)for(;K<=ee;)We(y[K],M,G,!0),K++;else{const ie=K,de=K,Re=new Map;for(K=de;K<=ce;K++){const xt=T[K]=H?or(T[K]):In(T[K]);xt.key!=null&&Re.set(xt.key,K)}let Ae,Et=0;const lt=ce-de+1;let gt=!1,Tt=0;const Hn=new Array(lt);for(K=0;K<lt;K++)Hn[K]=0;for(K=ie;K<=ee;K++){const xt=y[K];if(Et>=lt){We(xt,M,G,!0);continue}let nn;if(xt.key!=null)nn=Re.get(xt.key);else for(Ae=de;Ae<=ce;Ae++)if(Hn[Ae-de]===0&&zr(xt,T[Ae])){nn=Ae;break}nn===void 0?We(xt,M,G,!0):(Hn[nn-de]=K+1,nn>=Tt?Tt=nn:gt=!0,x(xt,T[nn],V,null,M,G,X,Q,H),Et++)}const Ti=gt?CT(Hn):$i;for(Ae=Ti.length-1,K=lt-1;K>=0;K--){const xt=de+K,nn=T[xt],wi=xt+1<ue?T[xt+1].el:$;Hn[K]===0?x(null,nn,V,wi,M,G,X,Q,H):gt&&(Ae<0||K!==Ti[Ae]?tn(nn,V,wi,2):Ae--)}}},tn=(y,T,V,$,M=null)=>{const{el:G,type:X,transition:Q,children:H,shapeFlag:K}=y;if(K&6){tn(y.component.subTree,T,V,$);return}if(K&128){y.suspense.move(T,V,$);return}if(K&64){X.move(y,T,V,re);return}if(X===Xt){r(G,T,V);for(let ee=0;ee<H.length;ee++)tn(H[ee],T,V,$);r(y.anchor,T,V);return}if(X===xl){F(y,T,V);return}if($!==2&&K&1&&Q)if($===0)Q.beforeEnter(G),r(G,T,V),Yt(()=>Q.enter(G),M);else{const{leave:ee,delayLeave:ce,afterLeave:ie}=Q,de=()=>r(G,T,V),Re=()=>{ee(G,()=>{de(),ie&&ie()})};ce?ce(G,de,Re):Re()}else r(G,T,V)},We=(y,T,V,$=!1,M=!1)=>{const{type:G,props:X,ref:Q,children:H,dynamicChildren:K,shapeFlag:ue,patchFlag:ee,dirs:ce,cacheIndex:ie}=y;if(ee===-2&&(M=!1),Q!=null&&Zl(Q,null,V,y,!0),ie!=null&&(T.renderCache[ie]=void 0),ue&256){T.ctx.deactivate(y);return}const de=ue&1&&ce,Re=!to(y);let Ae;if(Re&&(Ae=X&&X.onVnodeBeforeUnmount)&&yn(Ae,T,y),ue&6)_n(y.component,V,$);else{if(ue&128){y.suspense.unmount(V,$);return}de&&Lr(y,null,T,"beforeUnmount"),ue&64?y.type.remove(y,T,V,re,$):K&&!K.hasOnce&&(G!==Xt||ee>0&&ee&64)?Ut(K,T,V,!1,!0):(G===Xt&&ee&384||!M&&ue&16)&&Ut(H,T,V),$&&Ye(y)}(Re&&(Ae=X&&X.onVnodeUnmounted)||de)&&Yt(()=>{Ae&&yn(Ae,T,y),de&&Lr(y,null,T,"unmounted")},V)},Ye=y=>{const{type:T,el:V,anchor:$,transition:M}=y;if(T===Xt){Kn(V,$);return}if(T===xl){z(y);return}const G=()=>{i(V),M&&!M.persisted&&M.afterLeave&&M.afterLeave()};if(y.shapeFlag&1&&M&&!M.persisted){const{leave:X,delayLeave:Q}=M,H=()=>X(V,G);Q?Q(y.el,G,H):H()}else G()},Kn=(y,T)=>{let V;for(;y!==T;)V=m(y),i(y),y=V;i(T)},_n=(y,T,V)=>{const{bum:$,scope:M,job:G,subTree:X,um:Q,m:H,a:K}=y;Mf(H),Mf(K),$&&Na($),M.stop(),G&&(G.flags|=8,We(X,y,T,V)),Q&&Yt(Q,T),Yt(()=>{y.isUnmounted=!0},T),T&&T.pendingBranch&&!T.isUnmounted&&y.asyncDep&&!y.asyncResolved&&y.suspenseId===T.pendingId&&(T.deps--,T.deps===0&&T.resolve())},Ut=(y,T,V,$=!1,M=!1,G=0)=>{for(let X=G;X<y.length;X++)We(y[X],T,V,$,M)},L=y=>{if(y.shapeFlag&6)return L(y.component.subTree);if(y.shapeFlag&128)return y.suspense.next();const T=m(y.anchor||y.el),V=T&&T[WE];return V?m(V):T};let te=!1;const Z=(y,T,V)=>{y==null?T._vnode&&We(T._vnode,null,null,!0):x(T._vnode||null,y,T,null,null,null,V),T._vnode=y,te||(te=!0,Pf(),Ag(),te=!1)},re={p:x,um:We,m:tn,r:Ye,mt:Ne,mc:v,pc:ge,pbc:b,n:L,o:n};let Te,ke;return{render:Z,hydrate:Te,createApp:vT(Z,Te)}}function Cl({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function Fr({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function PT(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function Jg(n,e,t=!1){const r=n.children,i=e.children;if(he(r)&&he(i))for(let s=0;s<r.length;s++){const o=r[s];let a=i[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[s]=or(i[s]),a.el=o.el),!t&&a.patchFlag!==-2&&Jg(o,a)),a.type===xc&&(a.el=o.el)}}function CT(n){const e=n.slice(),t=[0];let r,i,s,o,a;const l=n.length;for(r=0;r<l;r++){const u=n[r];if(u!==0){if(i=t[t.length-1],n[i]<u){e[r]=i,t.push(r);continue}for(s=0,o=t.length-1;s<o;)a=s+o>>1,n[t[a]]<u?s=a+1:o=a;u<n[t[s]]&&(s>0&&(e[r]=t[s-1]),t[s]=r)}}for(s=t.length,o=t[s-1];s-- >0;)t[s]=o,o=e[o];return t}function Xg(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Xg(e)}function Mf(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}const DT=Symbol.for("v-scx"),xT=()=>Ln(DT);function Wi(n,e,t){return Zg(n,e,t)}function Zg(n,e,t=Be){const{immediate:r,deep:i,flush:s,once:o}=t,a=at({},t);let l;if(Vc)if(s==="sync"){const m=xT();l=m.__watcherHandles||(m.__watcherHandles=[])}else if(!e||r)a.once=!0;else{const m=()=>{};return m.stop=wn,m.resume=wn,m.pause=wn,m}const u=vt;a.call=(m,_,R)=>fn(m,u,_,R);let h=!1;s==="post"?a.scheduler=m=>{Yt(m,u&&u.suspense)}:s!=="sync"&&(h=!0,a.scheduler=(m,_)=>{_?m():rh(m)}),a.augmentJob=m=>{e&&(m.flags|=4),h&&(m.flags|=2,u&&(m.id=u.uid,m.i=u))};const f=zE(n,e,a);return l&&l.push(f),f}function VT(n,e,t){const r=this.proxy,i=rt(n)?n.includes(".")?e_(r,n):()=>r[n]:n.bind(r,r);let s;pe(e)?s=e:(s=e.handler,t=e);const o=Go(this),a=Zg(i,s.bind(r),t);return o(),a}function e_(n,e){const t=e.split(".");return()=>{let r=n;for(let i=0;i<t.length&&r;i++)r=r[t[i]];return r}}const NT=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${dn(e)}Modifiers`]||n[`${pi(e)}Modifiers`];function OT(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||Be;let i=t;const s=e.startsWith("update:"),o=s&&NT(r,e.slice(7));o&&(o.trim&&(i=t.map(h=>rt(h)?h.trim():h)),o.number&&(i=t.map(Ka)));let a,l=r[a=Tl(e)]||r[a=Tl(dn(e))];!l&&s&&(l=r[a=Tl(pi(e))]),l&&fn(l,n,6,i);const u=r[a+"Once"];if(u){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,fn(u,n,6,i)}}function t_(n,e,t=!1){const r=e.emitsCache,i=r.get(n);if(i!==void 0)return i;const s=n.emits;let o={},a=!1;if(!pe(n)){const l=u=>{const h=t_(u,e,!0);h&&(a=!0,at(o,h))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!s&&!a?(Ue(n)&&r.set(n,null),null):(he(s)?s.forEach(l=>o[l]=null):at(o,s),Ue(n)&&r.set(n,o),o)}function Dc(n,e){return!n||!vc(e)?!1:(e=e.slice(2).replace(/Once$/,""),Ce(n,e[0].toLowerCase()+e.slice(1))||Ce(n,pi(e))||Ce(n,e))}function Dl(n){const{type:e,vnode:t,proxy:r,withProxy:i,propsOptions:[s],slots:o,attrs:a,emit:l,render:u,renderCache:h,props:f,data:m,setupState:_,ctx:R,inheritAttrs:x}=n,N=Wa(n);let j,U;try{if(t.shapeFlag&4){const z=i||r,se=z;j=In(u.call(se,z,h,f,_,m,R)),U=a}else{const z=e;j=In(z.length>1?z(f,{attrs:a,slots:o,emit:l}):z(f,null)),U=e.props?a:kT(a)}}catch(z){ro.length=0,Sc(z,n,1),j=dt(jt)}let F=j;if(U&&x!==!1){const z=Object.keys(U),{shapeFlag:se}=F;z.length&&se&7&&(s&&z.some(ju)&&(U=MT(U,s)),F=mr(F,U,!1,!0))}return t.dirs&&(F=mr(F,null,!1,!0),F.dirs=F.dirs?F.dirs.concat(t.dirs):t.dirs),t.transition&&_o(F,t.transition),j=F,Wa(N),j}const kT=n=>{let e;for(const t in n)(t==="class"||t==="style"||vc(t))&&((e||(e={}))[t]=n[t]);return e},MT=(n,e)=>{const t={};for(const r in n)(!ju(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function LT(n,e,t){const{props:r,children:i,component:s}=n,{props:o,children:a,patchFlag:l}=e,u=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return r?Lf(r,o,u):!!o;if(l&8){const h=e.dynamicProps;for(let f=0;f<h.length;f++){const m=h[f];if(o[m]!==r[m]&&!Dc(u,m))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?Lf(r,o,u):!0:!!o;return!1}function Lf(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let i=0;i<r.length;i++){const s=r[i];if(e[s]!==n[s]&&!Dc(t,s))return!0}return!1}function FT({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const n_=n=>n.__isSuspense;function BT(n,e){e&&e.pendingBranch?he(n)?e.effects.push(...n):e.effects.push(n):QE(n)}const Xt=Symbol.for("v-fgt"),xc=Symbol.for("v-txt"),jt=Symbol.for("v-cmt"),xl=Symbol.for("v-stc"),ro=[];let Zt=null;function Ie(n=!1){ro.push(Zt=n?null:[])}function UT(){ro.pop(),Zt=ro[ro.length-1]||null}let yo=1;function Ff(n){yo+=n,n<0&&Zt&&(Zt.hasOnce=!0)}function r_(n){return n.dynamicChildren=yo>0?Zt||$i:null,UT(),yo>0&&Zt&&Zt.push(n),n}function De(n,e,t,r,i,s){return r_(P(n,e,t,r,i,s,!0))}function vo(n,e,t,r,i){return r_(dt(n,e,t,r,i,!0))}function iu(n){return n?n.__v_isVNode===!0:!1}function zr(n,e){return n.type===e.type&&n.key===e.key}const i_=({key:n})=>n??null,ka=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?rt(n)||Ct(n)||pe(n)?{i:$t,r:n,k:e,f:!!t}:n:null);function P(n,e=null,t=null,r=0,i=null,s=n===Xt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&i_(e),ref:e&&ka(e),scopeId:Rg,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:$t};return a?(ah(l,t),s&128&&n.normalize(l)):t&&(l.shapeFlag|=rt(t)?8:16),yo>0&&!o&&Zt&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Zt.push(l),l}const dt=qT;function qT(n,e=null,t=null,r=0,i=null,s=!1){if((!n||n===uT)&&(n=jt),iu(n)){const a=mr(n,e,!0);return t&&ah(a,t),yo>0&&!s&&Zt&&(a.shapeFlag&6?Zt[Zt.indexOf(n)]=a:Zt.push(a)),a.patchFlag=-2,a}if(ZT(n)&&(n=n.__vccOpts),e){e=jT(e);let{class:a,style:l}=e;a&&!rt(a)&&(e.class=qo(a)),Ue(l)&&(Zu(l)&&!he(l)&&(l=at({},l)),e.style=zu(l))}const o=rt(n)?1:n_(n)?128:Pg(n)?64:Ue(n)?4:pe(n)?2:0;return P(n,e,t,r,i,o,s,!0)}function jT(n){return n?Zu(n)||Gg(n)?at({},n):n:null}function mr(n,e,t=!1,r=!1){const{props:i,ref:s,patchFlag:o,children:a,transition:l}=n,u=e?$T(i||{},e):i,h={__v_isVNode:!0,__v_skip:!0,type:n.type,props:u,key:u&&i_(u),ref:e&&e.ref?t&&s?he(s)?s.concat(ka(e)):[s,ka(e)]:ka(e):s,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==Xt?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&mr(n.ssContent),ssFallback:n.ssFallback&&mr(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&r&&_o(h,l.clone(h)),h}function Io(n=" ",e=0){return dt(xc,null,n,e)}function Pt(n="",e=!1){return e?(Ie(),vo(jt,null,n)):dt(jt,null,n)}function In(n){return n==null||typeof n=="boolean"?dt(jt):he(n)?dt(Xt,null,n.slice()):typeof n=="object"?or(n):dt(xc,null,String(n))}function or(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:mr(n)}function ah(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(he(e))t=16;else if(typeof e=="object")if(r&65){const i=e.default;i&&(i._c&&(i._d=!1),ah(n,i()),i._c&&(i._d=!0));return}else{t=32;const i=e._;!i&&!Gg(e)?e._ctx=$t:i===3&&$t&&($t.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else pe(e)?(e={default:e,_ctx:$t},t=32):(e=String(e),r&64?(t=16,e=[Io(e)]):t=8);n.children=e,n.shapeFlag|=t}function $T(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const i in r)if(i==="class")e.class!==r.class&&(e.class=qo([e.class,r.class]));else if(i==="style")e.style=zu([e.style,r.style]);else if(vc(i)){const s=e[i],o=r[i];o&&s!==o&&!(he(s)&&s.includes(o))&&(e[i]=s?[].concat(s,o):o)}else i!==""&&(e[i]=r[i])}return e}function yn(n,e,t,r=null){fn(n,e,7,[t,r])}const GT=qg();let zT=0;function KT(n,e,t){const r=n.type,i=(e?e.appContext:n.appContext)||GT,s={uid:zT++,vnode:n,type:r,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new ig(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Kg(r,i),emitsOptions:t_(r,i),emit:null,emitted:null,propsDefaults:Be,inheritAttrs:r.inheritAttrs,ctx:Be,data:Be,props:Be,attrs:Be,slots:Be,refs:Be,setupState:Be,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=OT.bind(null,s),n.ce&&n.ce(s),s}let vt=null;const HT=()=>vt||$t;let Ja,su;{const n=eg(),e=(t,r)=>{let i;return(i=n[t])||(i=n[t]=[]),i.push(r),s=>{i.length>1?i.forEach(o=>o(s)):i[0](s)}};Ja=e("__VUE_INSTANCE_SETTERS__",t=>vt=t),su=e("__VUE_SSR_SETTERS__",t=>Vc=t)}const Go=n=>{const e=vt;return Ja(n),n.scope.on(),()=>{n.scope.off(),Ja(e)}},Bf=()=>{vt&&vt.scope.off(),Ja(null)};function s_(n){return n.vnode.shapeFlag&4}let Vc=!1;function QT(n,e=!1,t=!1){e&&su(e);const{props:r,children:i}=n.vnode,s=s_(n);IT(n,r,s,e),bT(n,i,t);const o=s?WT(n,e):void 0;return e&&su(!1),o}function WT(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,dT);const{setup:r}=t;if(r){const i=n.setupContext=r.length>1?JT(n):null,s=Go(n);Sr();const o=$o(r,n,0,[n.props,i]);if(Rr(),s(),Ym(o)){if(to(n)||kg(n),o.then(Bf,Bf),e)return o.then(a=>{Uf(n,a,e)}).catch(a=>{Sc(a,n,0)});n.asyncDep=o}else Uf(n,o,e)}else o_(n,e)}function Uf(n,e,t){pe(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:Ue(e)&&(n.setupState=Tg(e)),o_(n,t)}let qf;function o_(n,e,t){const r=n.type;if(!n.render){if(!e&&qf&&!r.render){const i=r.template||sh(n).template;if(i){const{isCustomElement:s,compilerOptions:o}=n.appContext.config,{delimiters:a,compilerOptions:l}=r,u=at(at({isCustomElement:s,delimiters:a},o),l);r.render=qf(i,u)}}n.render=r.render||wn}{const i=Go(n);Sr();try{fT(n)}finally{Rr(),i()}}}const YT={get(n,e){return Dt(n,"get",""),n[e]}};function JT(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,YT),slots:n.slots,emit:n.emit,expose:e}}function Nc(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(Tg(LE(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in no)return no[t](n)},has(e,t){return t in e||t in no}})):n.proxy}function XT(n,e=!0){return pe(n)?n.displayName||n.name:n.name||e&&n.__name}function ZT(n){return pe(n)&&"__vccOpts"in n}const sn=(n,e)=>$E(n,e,Vc);function ch(n,e,t){const r=arguments.length;return r===2?Ue(e)&&!he(e)?iu(e)?dt(n,null,[e]):dt(n,e):dt(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&iu(t)&&(t=[t]),dt(n,e,t))}const ew="3.5.7";/**
* @vue/runtime-dom v3.5.7
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ou;const jf=typeof window<"u"&&window.trustedTypes;if(jf)try{ou=jf.createPolicy("vue",{createHTML:n=>n})}catch{}const a_=ou?n=>ou.createHTML(n):n=>n,tw="http://www.w3.org/2000/svg",nw="http://www.w3.org/1998/Math/MathML",Nn=typeof document<"u"?document:null,$f=Nn&&Nn.createElement("template"),rw={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const i=e==="svg"?Nn.createElementNS(tw,n):e==="mathml"?Nn.createElementNS(nw,n):t?Nn.createElement(n,{is:t}):Nn.createElement(n);return n==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:n=>Nn.createTextNode(n),createComment:n=>Nn.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Nn.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,i,s){const o=t?t.previousSibling:e.lastChild;if(i&&(i===s||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),t),!(i===s||!(i=i.nextSibling)););else{$f.innerHTML=a_(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const a=$f.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},Xn="transition",Us="animation",Eo=Symbol("_vtc"),c_={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},iw=at({},Cg,c_),sw=n=>(n.displayName="Transition",n.props=iw,n),ow=sw((n,{slots:e})=>ch(XE,aw(n),e)),Br=(n,e=[])=>{he(n)?n.forEach(t=>t(...e)):n&&n(...e)},Gf=n=>n?he(n)?n.some(e=>e.length>1):n.length>1:!1;function aw(n){const e={};for(const w in n)w in c_||(e[w]=n[w]);if(n.css===!1)return e;const{name:t="v",type:r,duration:i,enterFromClass:s=`${t}-enter-from`,enterActiveClass:o=`${t}-enter-active`,enterToClass:a=`${t}-enter-to`,appearFromClass:l=s,appearActiveClass:u=o,appearToClass:h=a,leaveFromClass:f=`${t}-leave-from`,leaveActiveClass:m=`${t}-leave-active`,leaveToClass:_=`${t}-leave-to`}=n,R=cw(i),x=R&&R[0],N=R&&R[1],{onBeforeEnter:j,onEnter:U,onEnterCancelled:F,onLeave:z,onLeaveCancelled:se,onBeforeAppear:oe=j,onAppear:A=U,onAppearCancelled:v=F}=e,I=(w,E,Ne)=>{Ur(w,E?h:a),Ur(w,E?u:o),Ne&&Ne()},b=(w,E)=>{w._isLeaving=!1,Ur(w,f),Ur(w,_),Ur(w,m),E&&E()},S=w=>(E,Ne)=>{const mt=w?A:U,Qe=()=>I(E,w,Ne);Br(mt,[E,Qe]),zf(()=>{Ur(E,w?l:s),Zn(E,w?h:a),Gf(mt)||Kf(E,r,x,Qe)})};return at(e,{onBeforeEnter(w){Br(j,[w]),Zn(w,s),Zn(w,o)},onBeforeAppear(w){Br(oe,[w]),Zn(w,l),Zn(w,u)},onEnter:S(!1),onAppear:S(!0),onLeave(w,E){w._isLeaving=!0;const Ne=()=>b(w,E);Zn(w,f),Zn(w,m),hw(),zf(()=>{w._isLeaving&&(Ur(w,f),Zn(w,_),Gf(z)||Kf(w,r,N,Ne))}),Br(z,[w,Ne])},onEnterCancelled(w){I(w,!1),Br(F,[w])},onAppearCancelled(w){I(w,!0),Br(v,[w])},onLeaveCancelled(w){b(w),Br(se,[w])}})}function cw(n){if(n==null)return null;if(Ue(n))return[Vl(n.enter),Vl(n.leave)];{const e=Vl(n);return[e,e]}}function Vl(n){return sE(n)}function Zn(n,e){e.split(/\s+/).forEach(t=>t&&n.classList.add(t)),(n[Eo]||(n[Eo]=new Set)).add(e)}function Ur(n,e){e.split(/\s+/).forEach(r=>r&&n.classList.remove(r));const t=n[Eo];t&&(t.delete(e),t.size||(n[Eo]=void 0))}function zf(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let lw=0;function Kf(n,e,t,r){const i=n._endId=++lw,s=()=>{i===n._endId&&r()};if(t!=null)return setTimeout(s,t);const{type:o,timeout:a,propCount:l}=uw(n,e);if(!o)return r();const u=o+"end";let h=0;const f=()=>{n.removeEventListener(u,m),s()},m=_=>{_.target===n&&++h>=l&&f()};setTimeout(()=>{h<l&&f()},a+1),n.addEventListener(u,m)}function uw(n,e){const t=window.getComputedStyle(n),r=R=>(t[R]||"").split(", "),i=r(`${Xn}Delay`),s=r(`${Xn}Duration`),o=Hf(i,s),a=r(`${Us}Delay`),l=r(`${Us}Duration`),u=Hf(a,l);let h=null,f=0,m=0;e===Xn?o>0&&(h=Xn,f=o,m=s.length):e===Us?u>0&&(h=Us,f=u,m=l.length):(f=Math.max(o,u),h=f>0?o>u?Xn:Us:null,m=h?h===Xn?s.length:l.length:0);const _=h===Xn&&/\b(transform|all)(,|$)/.test(r(`${Xn}Property`).toString());return{type:h,timeout:f,propCount:m,hasTransform:_}}function Hf(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max(...e.map((t,r)=>Qf(t)+Qf(n[r])))}function Qf(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function hw(){return document.body.offsetHeight}function dw(n,e,t){const r=n[Eo];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const Xa=Symbol("_vod"),l_=Symbol("_vsh"),u_={beforeMount(n,{value:e},{transition:t}){n[Xa]=n.style.display==="none"?"":n.style.display,t&&e?t.beforeEnter(n):qs(n,e)},mounted(n,{value:e},{transition:t}){t&&e&&t.enter(n)},updated(n,{value:e,oldValue:t},{transition:r}){!e!=!t&&(r?e?(r.beforeEnter(n),qs(n,!0),r.enter(n)):r.leave(n,()=>{qs(n,!1)}):qs(n,e))},beforeUnmount(n,{value:e}){qs(n,e)}};function qs(n,e){n.style.display=e?n[Xa]:"none",n[l_]=!e}const fw=Symbol(""),pw=/(^|;)\s*display\s*:/;function mw(n,e,t){const r=n.style,i=rt(t);let s=!1;if(t&&!i){if(e)if(rt(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&Ma(r,a,"")}else for(const o in e)t[o]==null&&Ma(r,o,"");for(const o in t)o==="display"&&(s=!0),Ma(r,o,t[o])}else if(i){if(e!==t){const o=r[fw];o&&(t+=";"+o),r.cssText=t,s=pw.test(t)}}else e&&n.removeAttribute("style");Xa in n&&(n[Xa]=s?r.display:"",n[l_]&&(r.display="none"))}const Wf=/\s*!important$/;function Ma(n,e,t){if(he(t))t.forEach(r=>Ma(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=gw(n,e);Wf.test(t)?n.setProperty(pi(r),t.replace(Wf,""),"important"):n[r]=t}}const Yf=["Webkit","Moz","ms"],Nl={};function gw(n,e){const t=Nl[e];if(t)return t;let r=dn(e);if(r!=="filter"&&r in n)return Nl[e]=r;r=Tc(r);for(let i=0;i<Yf.length;i++){const s=Yf[i]+r;if(s in n)return Nl[e]=s}return e}const Jf="http://www.w3.org/1999/xlink";function Xf(n,e,t,r,i,s=hE(e)){r&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(Jf,e.slice(6,e.length)):n.setAttributeNS(Jf,e,t):t==null||s&&!tg(t)?n.removeAttribute(e):n.setAttribute(e,s?"":Sn(t)?String(t):t)}function _w(n,e,t,r){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?a_(t):t);return}const i=n.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const o=i==="OPTION"?n.getAttribute("value")||"":n.value,a=t==null?n.type==="checkbox"?"on":"":String(t);(o!==a||!("_value"in n))&&(n.value=a),t==null&&n.removeAttribute(e),n._value=t;return}let s=!1;if(t===""||t==null){const o=typeof n[e];o==="boolean"?t=tg(t):t==null&&o==="string"?(t="",s=!0):o==="number"&&(t=0,s=!0)}try{n[e]=t}catch{}s&&n.removeAttribute(e)}function Kr(n,e,t,r){n.addEventListener(e,t,r)}function yw(n,e,t,r){n.removeEventListener(e,t,r)}const Zf=Symbol("_vei");function vw(n,e,t,r,i=null){const s=n[Zf]||(n[Zf]={}),o=s[e];if(r&&o)o.value=r;else{const[a,l]=Iw(e);if(r){const u=s[e]=ww(r,i);Kr(n,a,u,l)}else o&&(yw(n,a,o,l),s[e]=void 0)}}const ep=/(?:Once|Passive|Capture)$/;function Iw(n){let e;if(ep.test(n)){e={};let r;for(;r=n.match(ep);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):pi(n.slice(2)),e]}let Ol=0;const Ew=Promise.resolve(),Tw=()=>Ol||(Ew.then(()=>Ol=0),Ol=Date.now());function ww(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;fn(bw(r,t.value),e,5,[r])};return t.value=n,t.attached=Tw(),t}function bw(n,e){if(he(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>i=>!i._stopped&&r&&r(i))}else return e}const tp=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,Aw=(n,e,t,r,i,s)=>{const o=i==="svg";e==="class"?dw(n,r,o):e==="style"?mw(n,t,r):vc(e)?ju(e)||vw(n,e,t,r,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Sw(n,e,r,o))?(_w(n,e,r),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Xf(n,e,r,o,s,e!=="value")):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),Xf(n,e,r,o))};function Sw(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&tp(e)&&pe(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=n.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return tp(e)&&rt(t)?!1:!!(e in n||n._isVueCE&&(/[A-Z]/.test(e)||!rt(t)))}const Za=n=>{const e=n.props["onUpdate:modelValue"]||!1;return he(e)?t=>Na(e,t):e};function Rw(n){n.target.composing=!0}function np(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Yi=Symbol("_assign"),At={created(n,{modifiers:{lazy:e,trim:t,number:r}},i){n[Yi]=Za(i);const s=r||i.props&&i.props.type==="number";Kr(n,e?"change":"input",o=>{if(o.target.composing)return;let a=n.value;t&&(a=a.trim()),s&&(a=Ka(a)),n[Yi](a)}),t&&Kr(n,"change",()=>{n.value=n.value.trim()}),e||(Kr(n,"compositionstart",Rw),Kr(n,"compositionend",np),Kr(n,"change",np))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:r,trim:i,number:s}},o){if(n[Yi]=Za(o),n.composing)return;const a=(s||n.type==="number")&&!/^0\d/.test(n.value)?Ka(n.value):n.value,l=e??"";a!==l&&(document.activeElement===n&&n.type!=="range"&&(r&&e===t||i&&n.value.trim()===l)||(n.value=l))}},Pw={deep:!0,created(n,{value:e,modifiers:{number:t}},r){const i=Ic(e);Kr(n,"change",()=>{const s=Array.prototype.filter.call(n.options,o=>o.selected).map(o=>t?Ka(ec(o)):ec(o));n[Yi](n.multiple?i?new Set(s):s:s[0]),n._assigning=!0,nh(()=>{n._assigning=!1})}),n[Yi]=Za(r)},mounted(n,{value:e,modifiers:{number:t}}){rp(n,e)},beforeUpdate(n,e,t){n[Yi]=Za(t)},updated(n,{value:e,modifiers:{number:t}}){n._assigning||rp(n,e)}};function rp(n,e,t){const r=n.multiple,i=he(e);if(!(r&&!i&&!Ic(e))){for(let s=0,o=n.options.length;s<o;s++){const a=n.options[s],l=ec(a);if(r)if(i){const u=typeof l;u==="string"||u==="number"?a.selected=e.some(h=>String(h)===String(l)):a.selected=fE(e,l)>-1}else a.selected=e.has(l);else if(wc(ec(a),e)){n.selectedIndex!==s&&(n.selectedIndex=s);return}}!r&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function ec(n){return"_value"in n?n._value:n.value}const Cw=["ctrl","shift","alt","meta"],Dw={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>Cw.some(t=>n[`${t}Key`]&&!e.includes(t))},xw=(n,e)=>{const t=n._withMods||(n._withMods={}),r=e.join(".");return t[r]||(t[r]=(i,...s)=>{for(let o=0;o<e.length;o++){const a=Dw[e[o]];if(a&&a(i,e))return}return n(i,...s)})},Vw=at({patchProp:Aw},rw);let ip;function Nw(){return ip||(ip=ST(Vw))}const Ow=(...n)=>{const e=Nw().createApp(...n),{mount:t}=e;return e.mount=r=>{const i=Mw(r);if(!i)return;const s=e._component;!pe(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=t(i,!1,kw(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function kw(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function Mw(n){return rt(n)?document.querySelector(n):n}function Lw(){return h_().__VUE_DEVTOOLS_GLOBAL_HOOK__}function h_(){return typeof navigator<"u"&&typeof window<"u"?window:typeof globalThis<"u"?globalThis:{}}const Fw=typeof Proxy=="function",Bw="devtools-plugin:setup",Uw="plugin:settings:set";let Ci,au;function qw(){var n;return Ci!==void 0||(typeof window<"u"&&window.performance?(Ci=!0,au=window.performance):typeof globalThis<"u"&&(!((n=globalThis.perf_hooks)===null||n===void 0)&&n.performance)?(Ci=!0,au=globalThis.perf_hooks.performance):Ci=!1),Ci}function jw(){return qw()?au.now():Date.now()}class $w{constructor(e,t){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=t;const r={};if(e.settings)for(const o in e.settings){const a=e.settings[o];r[o]=a.defaultValue}const i=`__vue-devtools-plugin-settings__${e.id}`;let s=Object.assign({},r);try{const o=localStorage.getItem(i),a=JSON.parse(o);Object.assign(s,a)}catch{}this.fallbacks={getSettings(){return s},setSettings(o){try{localStorage.setItem(i,JSON.stringify(o))}catch{}s=o},now(){return jw()}},t&&t.on(Uw,(o,a)=>{o===this.plugin.id&&this.fallbacks.setSettings(a)}),this.proxiedOn=new Proxy({},{get:(o,a)=>this.target?this.target.on[a]:(...l)=>{this.onQueue.push({method:a,args:l})}}),this.proxiedTarget=new Proxy({},{get:(o,a)=>this.target?this.target[a]:a==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(a)?(...l)=>(this.targetQueue.push({method:a,args:l,resolve:()=>{}}),this.fallbacks[a](...l)):(...l)=>new Promise(u=>{this.targetQueue.push({method:a,args:l,resolve:u})})})}async setRealTarget(e){this.target=e;for(const t of this.onQueue)this.target.on[t.method](...t.args);for(const t of this.targetQueue)t.resolve(await this.target[t.method](...t.args))}}function Gw(n,e){const t=n,r=h_(),i=Lw(),s=Fw&&t.enableEarlyProxy;if(i&&(r.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!s))i.emit(Bw,n,e);else{const o=s?new $w(t,i):null;(r.__VUE_DEVTOOLS_PLUGINS__=r.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:t,setupFn:e,proxy:o}),o&&e(o.proxiedTarget)}}/*!
 * vuex v4.1.0
 * (c) 2022 Evan You
 * @license MIT
 */var zw="store";function _s(n,e){Object.keys(n).forEach(function(t){return e(n[t],t)})}function d_(n){return n!==null&&typeof n=="object"}function Kw(n){return n&&typeof n.then=="function"}function Hw(n,e){return function(){return n(e)}}function f_(n,e,t){return e.indexOf(n)<0&&(t&&t.prepend?e.unshift(n):e.push(n)),function(){var r=e.indexOf(n);r>-1&&e.splice(r,1)}}function p_(n,e){n._actions=Object.create(null),n._mutations=Object.create(null),n._wrappedGetters=Object.create(null),n._modulesNamespaceMap=Object.create(null);var t=n.state;Oc(n,t,[],n._modules.root,!0),lh(n,t,e)}function lh(n,e,t){var r=n._state,i=n._scope;n.getters={},n._makeLocalGettersCache=Object.create(null);var s=n._wrappedGetters,o={},a={},l=pE(!0);l.run(function(){_s(s,function(u,h){o[h]=Hw(u,n),a[h]=sn(function(){return o[h]()}),Object.defineProperty(n.getters,h,{get:function(){return a[h].value},enumerable:!0})})}),n._state=jo({data:e}),n._scope=l,n.strict&&Xw(n),r&&t&&n._withCommit(function(){r.data=null}),i&&i.stop()}function Oc(n,e,t,r,i){var s=!t.length,o=n._modules.getNamespace(t);if(r.namespaced&&(n._modulesNamespaceMap[o],n._modulesNamespaceMap[o]=r),!s&&!i){var a=uh(e,t.slice(0,-1)),l=t[t.length-1];n._withCommit(function(){a[l]=r.state})}var u=r.context=Qw(n,o,t);r.forEachMutation(function(h,f){var m=o+f;Ww(n,m,h,u)}),r.forEachAction(function(h,f){var m=h.root?f:o+f,_=h.handler||h;Yw(n,m,_,u)}),r.forEachGetter(function(h,f){var m=o+f;Jw(n,m,h,u)}),r.forEachChild(function(h,f){Oc(n,e,t.concat(f),h,i)})}function Qw(n,e,t){var r=e==="",i={dispatch:r?n.dispatch:function(s,o,a){var l=tc(s,o,a),u=l.payload,h=l.options,f=l.type;return(!h||!h.root)&&(f=e+f),n.dispatch(f,u)},commit:r?n.commit:function(s,o,a){var l=tc(s,o,a),u=l.payload,h=l.options,f=l.type;(!h||!h.root)&&(f=e+f),n.commit(f,u,h)}};return Object.defineProperties(i,{getters:{get:r?function(){return n.getters}:function(){return m_(n,e)}},state:{get:function(){return uh(n.state,t)}}}),i}function m_(n,e){if(!n._makeLocalGettersCache[e]){var t={},r=e.length;Object.keys(n.getters).forEach(function(i){if(i.slice(0,r)===e){var s=i.slice(r);Object.defineProperty(t,s,{get:function(){return n.getters[i]},enumerable:!0})}}),n._makeLocalGettersCache[e]=t}return n._makeLocalGettersCache[e]}function Ww(n,e,t,r){var i=n._mutations[e]||(n._mutations[e]=[]);i.push(function(o){t.call(n,r.state,o)})}function Yw(n,e,t,r){var i=n._actions[e]||(n._actions[e]=[]);i.push(function(o){var a=t.call(n,{dispatch:r.dispatch,commit:r.commit,getters:r.getters,state:r.state,rootGetters:n.getters,rootState:n.state},o);return Kw(a)||(a=Promise.resolve(a)),n._devtoolHook?a.catch(function(l){throw n._devtoolHook.emit("vuex:error",l),l}):a})}function Jw(n,e,t,r){n._wrappedGetters[e]||(n._wrappedGetters[e]=function(s){return t(r.state,r.getters,s.state,s.getters)})}function Xw(n){Wi(function(){return n._state.data},function(){},{deep:!0,flush:"sync"})}function uh(n,e){return e.reduce(function(t,r){return t[r]},n)}function tc(n,e,t){return d_(n)&&n.type&&(t=e,e=n,n=n.type),{type:n,payload:e,options:t}}var Zw="vuex bindings",sp="vuex:mutations",kl="vuex:actions",Di="vuex",eb=0;function tb(n,e){Gw({id:"org.vuejs.vuex",app:n,label:"Vuex",homepage:"https://next.vuex.vuejs.org/",logo:"https://vuejs.org/images/icons/favicon-96x96.png",packageName:"vuex",componentStateTypes:[Zw]},function(t){t.addTimelineLayer({id:sp,label:"Vuex Mutations",color:op}),t.addTimelineLayer({id:kl,label:"Vuex Actions",color:op}),t.addInspector({id:Di,label:"Vuex",icon:"storage",treeFilterPlaceholder:"Filter stores..."}),t.on.getInspectorTree(function(r){if(r.app===n&&r.inspectorId===Di)if(r.filter){var i=[];v_(i,e._modules.root,r.filter,""),r.rootNodes=i}else r.rootNodes=[y_(e._modules.root,"")]}),t.on.getInspectorState(function(r){if(r.app===n&&r.inspectorId===Di){var i=r.nodeId;m_(e,i),r.state=ib(ob(e._modules,i),i==="root"?e.getters:e._makeLocalGettersCache,i)}}),t.on.editInspectorState(function(r){if(r.app===n&&r.inspectorId===Di){var i=r.nodeId,s=r.path;i!=="root"&&(s=i.split("/").filter(Boolean).concat(s)),e._withCommit(function(){r.set(e._state.data,s,r.state.value)})}}),e.subscribe(function(r,i){var s={};r.payload&&(s.payload=r.payload),s.state=i,t.notifyComponentUpdate(),t.sendInspectorTree(Di),t.sendInspectorState(Di),t.addTimelineEvent({layerId:sp,event:{time:Date.now(),title:r.type,data:s}})}),e.subscribeAction({before:function(r,i){var s={};r.payload&&(s.payload=r.payload),r._id=eb++,r._time=Date.now(),s.state=i,t.addTimelineEvent({layerId:kl,event:{time:r._time,title:r.type,groupId:r._id,subtitle:"start",data:s}})},after:function(r,i){var s={},o=Date.now()-r._time;s.duration={_custom:{type:"duration",display:o+"ms",tooltip:"Action duration",value:o}},r.payload&&(s.payload=r.payload),s.state=i,t.addTimelineEvent({layerId:kl,event:{time:Date.now(),title:r.type,groupId:r._id,subtitle:"end",data:s}})}})})}var op=8702998,nb=6710886,rb=16777215,g_={label:"namespaced",textColor:rb,backgroundColor:nb};function __(n){return n&&n!=="root"?n.split("/").slice(-2,-1)[0]:"Root"}function y_(n,e){return{id:e||"root",label:__(e),tags:n.namespaced?[g_]:[],children:Object.keys(n._children).map(function(t){return y_(n._children[t],e+t+"/")})}}function v_(n,e,t,r){r.includes(t)&&n.push({id:r||"root",label:r.endsWith("/")?r.slice(0,r.length-1):r||"Root",tags:e.namespaced?[g_]:[]}),Object.keys(e._children).forEach(function(i){v_(n,e._children[i],t,r+i+"/")})}function ib(n,e,t){e=t==="root"?e:e[t];var r=Object.keys(e),i={state:Object.keys(n.state).map(function(o){return{key:o,editable:!0,value:n.state[o]}})};if(r.length){var s=sb(e);i.getters=Object.keys(s).map(function(o){return{key:o.endsWith("/")?__(o):o,editable:!1,value:cu(function(){return s[o]})}})}return i}function sb(n){var e={};return Object.keys(n).forEach(function(t){var r=t.split("/");if(r.length>1){var i=e,s=r.pop();r.forEach(function(o){i[o]||(i[o]={_custom:{value:{},display:o,tooltip:"Module",abstract:!0}}),i=i[o]._custom.value}),i[s]=cu(function(){return n[t]})}else e[t]=cu(function(){return n[t]})}),e}function ob(n,e){var t=e.split("/").filter(function(r){return r});return t.reduce(function(r,i,s){var o=r[i];if(!o)throw new Error('Missing module "'+i+'" for path "'+e+'".');return s===t.length-1?o:o._children},e==="root"?n:n.root._children)}function cu(n){try{return n()}catch(e){return e}}var gn=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var r=e.state;this.state=(typeof r=="function"?r():r)||{}},I_={namespaced:{configurable:!0}};I_.namespaced.get=function(){return!!this._rawModule.namespaced};gn.prototype.addChild=function(e,t){this._children[e]=t};gn.prototype.removeChild=function(e){delete this._children[e]};gn.prototype.getChild=function(e){return this._children[e]};gn.prototype.hasChild=function(e){return e in this._children};gn.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)};gn.prototype.forEachChild=function(e){_s(this._children,e)};gn.prototype.forEachGetter=function(e){this._rawModule.getters&&_s(this._rawModule.getters,e)};gn.prototype.forEachAction=function(e){this._rawModule.actions&&_s(this._rawModule.actions,e)};gn.prototype.forEachMutation=function(e){this._rawModule.mutations&&_s(this._rawModule.mutations,e)};Object.defineProperties(gn.prototype,I_);var mi=function(e){this.register([],e,!1)};mi.prototype.get=function(e){return e.reduce(function(t,r){return t.getChild(r)},this.root)};mi.prototype.getNamespace=function(e){var t=this.root;return e.reduce(function(r,i){return t=t.getChild(i),r+(t.namespaced?i+"/":"")},"")};mi.prototype.update=function(e){E_([],this.root,e)};mi.prototype.register=function(e,t,r){var i=this;r===void 0&&(r=!0);var s=new gn(t,r);if(e.length===0)this.root=s;else{var o=this.get(e.slice(0,-1));o.addChild(e[e.length-1],s)}t.modules&&_s(t.modules,function(a,l){i.register(e.concat(l),a,r)})};mi.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),r=e[e.length-1],i=t.getChild(r);i&&i.runtime&&t.removeChild(r)};mi.prototype.isRegistered=function(e){var t=this.get(e.slice(0,-1)),r=e[e.length-1];return t?t.hasChild(r):!1};function E_(n,e,t){if(e.update(t),t.modules)for(var r in t.modules){if(!e.getChild(r))return;E_(n.concat(r),e.getChild(r),t.modules[r])}}function ab(n){return new Ht(n)}var Ht=function(e){var t=this;e===void 0&&(e={});var r=e.plugins;r===void 0&&(r=[]);var i=e.strict;i===void 0&&(i=!1);var s=e.devtools;this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new mi(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null),this._scope=null,this._devtools=s;var o=this,a=this,l=a.dispatch,u=a.commit;this.dispatch=function(m,_){return l.call(o,m,_)},this.commit=function(m,_,R){return u.call(o,m,_,R)},this.strict=i;var h=this._modules.root.state;Oc(this,h,[],this._modules.root),lh(this,h),r.forEach(function(f){return f(t)})},hh={state:{configurable:!0}};Ht.prototype.install=function(e,t){e.provide(t||zw,this),e.config.globalProperties.$store=this;var r=this._devtools!==void 0?this._devtools:!1;r&&tb(e,this)};hh.state.get=function(){return this._state.data};hh.state.set=function(n){};Ht.prototype.commit=function(e,t,r){var i=this,s=tc(e,t,r),o=s.type,a=s.payload,l={type:o,payload:a},u=this._mutations[o];u&&(this._withCommit(function(){u.forEach(function(f){f(a)})}),this._subscribers.slice().forEach(function(h){return h(l,i.state)}))};Ht.prototype.dispatch=function(e,t){var r=this,i=tc(e,t),s=i.type,o=i.payload,a={type:s,payload:o},l=this._actions[s];if(l){try{this._actionSubscribers.slice().filter(function(h){return h.before}).forEach(function(h){return h.before(a,r.state)})}catch{}var u=l.length>1?Promise.all(l.map(function(h){return h(o)})):l[0](o);return new Promise(function(h,f){u.then(function(m){try{r._actionSubscribers.filter(function(_){return _.after}).forEach(function(_){return _.after(a,r.state)})}catch{}h(m)},function(m){try{r._actionSubscribers.filter(function(_){return _.error}).forEach(function(_){return _.error(a,r.state,m)})}catch{}f(m)})})}};Ht.prototype.subscribe=function(e,t){return f_(e,this._subscribers,t)};Ht.prototype.subscribeAction=function(e,t){var r=typeof e=="function"?{before:e}:e;return f_(r,this._actionSubscribers,t)};Ht.prototype.watch=function(e,t,r){var i=this;return Wi(function(){return e(i.state,i.getters)},t,Object.assign({},r))};Ht.prototype.replaceState=function(e){var t=this;this._withCommit(function(){t._state.data=e})};Ht.prototype.registerModule=function(e,t,r){r===void 0&&(r={}),typeof e=="string"&&(e=[e]),this._modules.register(e,t),Oc(this,this.state,e,this._modules.get(e),r.preserveState),lh(this,this.state)};Ht.prototype.unregisterModule=function(e){var t=this;typeof e=="string"&&(e=[e]),this._modules.unregister(e),this._withCommit(function(){var r=uh(t.state,e.slice(0,-1));delete r[e[e.length-1]]}),p_(this)};Ht.prototype.hasModule=function(e){return typeof e=="string"&&(e=[e]),this._modules.isRegistered(e)};Ht.prototype.hotUpdate=function(e){this._modules.update(e),p_(this,!0)};Ht.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t};Object.defineProperties(Ht.prototype,hh);var zo=ph(function(n,e){var t={};return fh(e).forEach(function(r){var i=r.key,s=r.val;t[i]=function(){var a=this.$store.state,l=this.$store.getters;if(n){var u=mh(this.$store,"mapState",n);if(!u)return;a=u.context.state,l=u.context.getters}return typeof s=="function"?s.call(this,a,l):a[s]},t[i].vuex=!0}),t}),kc=ph(function(n,e){var t={};return fh(e).forEach(function(r){var i=r.key,s=r.val;t[i]=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=this.$store.commit;if(n){var h=mh(this.$store,"mapMutations",n);if(!h)return;u=h.context.commit}return typeof s=="function"?s.apply(this,[u].concat(a)):u.apply(this.$store,[s].concat(a))}}),t}),dh=ph(function(n,e){var t={};return fh(e).forEach(function(r){var i=r.key,s=r.val;t[i]=function(){for(var a=[],l=arguments.length;l--;)a[l]=arguments[l];var u=this.$store.dispatch;if(n){var h=mh(this.$store,"mapActions",n);if(!h)return;u=h.context.dispatch}return typeof s=="function"?s.apply(this,[u].concat(a)):u.apply(this.$store,[s].concat(a))}}),t});function fh(n){return cb(n)?Array.isArray(n)?n.map(function(e){return{key:e,val:e}}):Object.keys(n).map(function(e){return{key:e,val:n[e]}}):[]}function cb(n){return Array.isArray(n)||d_(n)}function ph(n){return function(e,t){return typeof e!="string"?(t=e,e=""):e.charAt(e.length-1)!=="/"&&(e+="/"),n(e,t)}}function mh(n,e,t){var r=n._modulesNamespaceMap[t];return r}const lb="/assets/file-invoice-dollar-solid-DeMZw8qy.png",Pr=(n,e)=>{const t=n.__vccOpts||n;for(const[r,i]of e)t[r]=i;return t},ub={name:"navigation"},hb={class:"flex"};function db(n,e,t,r,i,s){return Ie(),De("header",hb,e[0]||(e[0]=[P("div",{class:"branding flex"},[P("img",{src:lb,alt:""})],-1)]))}const fb=Pr(ub,[["render",db],["__scopeId","data-v-11762157"]]);var Xr=256,T_=[],ap=256,Sa;for(;Xr--;)T_[Xr]=(Xr+256).toString(16).substring(1);function cp(n){var e=0,t=n||11;if(!Sa||Xr+t>ap*2)for(Sa="",Xr=0;e<ap;e++)Sa+=T_[Math.random()*256|0];return Sa.substring(Xr,Xr+++t)}var lp={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w_=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},pb=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],o=n[t++],a=n[t++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},b_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,a=o?n[i+1]:0,l=i+2<n.length,u=l?n[i+2]:0,h=s>>2,f=(s&3)<<4|a>>4;let m=(a&15)<<2|u>>6,_=u&63;l||(_=64,o||(m=64)),r.push(t[h],t[f],t[m],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(w_(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):pb(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;const u=i<n.length?t[n.charAt(i)]:64;++i;const f=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||u==null||f==null)throw new mb;const m=s<<2|a>>4;if(r.push(m),u!==64){const _=a<<4&240|u>>2;if(r.push(_),f!==64){const R=u<<6&192|f;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class mb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const gb=function(n){const e=w_(n);return b_.encodeByteArray(e,!0)},nc=function(n){return gb(n).replace(/\./g,"")},_b=function(n){try{return b_.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function rc(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!yb(t)||(n[t]=rc(n[t],e[t]));return n}function yb(n){return n!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vb=()=>A_().__FIREBASE_DEFAULTS__,Ib=()=>{if(typeof process>"u"||typeof lp>"u")return;const n=lp.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Eb=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&_b(n[1]);return e&&JSON.parse(e)},S_=()=>{try{return vb()||Ib()||Eb()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},R_=()=>{var n;return(n=S_())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wb(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[nc(JSON.stringify(t)),nc(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ic(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function bb(){var n;const e=(n=S_())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Ab(){return typeof window<"u"||P_()}function P_(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function C_(){return!bb()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function D_(){try{return typeof indexedDB=="object"}catch{return!1}}function Sb(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rb="FirebaseError";class gi extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Rb,Object.setPrototypeOf(this,gi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Mc.prototype.create)}}class Mc{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?Pb(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new gi(i,a,r)}}function Pb(n,e){return n.replace(Cb,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const Cb=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function up(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function To(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(hp(s)&&hp(o)){if(!To(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function hp(n){return n!==null&&typeof n=="object"}function Db(n,e){const t=new xb(n,e);return t.subscribe.bind(t)}class xb{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Vb(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Ml),i.error===void 0&&(i.error=Ml),i.complete===void 0&&(i.complete=Ml);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Vb(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ml(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function st(n){return n&&n._delegate?n._delegate:n}class ii{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $r="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new Tb;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(kb(e))try{this.getOrInitializeService({instanceIdentifier:$r})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=$r){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=$r){return this.instances.has(e)}getOptions(e=$r){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Ob(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=$r){return this.component?this.component.multipleInstances?e:$r:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Ob(n){return n===$r?void 0:n}function kb(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x_{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Nb(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gh=[];var ve;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ve||(ve={}));const V_={debug:ve.DEBUG,verbose:ve.VERBOSE,info:ve.INFO,warn:ve.WARN,error:ve.ERROR,silent:ve.SILENT},Mb=ve.INFO,Lb={[ve.DEBUG]:"log",[ve.VERBOSE]:"log",[ve.INFO]:"info",[ve.WARN]:"warn",[ve.ERROR]:"error"},Fb=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=Lb[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class _h{constructor(e){this.name=e,this._logLevel=Mb,this._logHandler=Fb,this._userLogHandler=null,gh.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ve))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?V_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ve.DEBUG,...e),this._logHandler(this,ve.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ve.VERBOSE,...e),this._logHandler(this,ve.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ve.INFO,...e),this._logHandler(this,ve.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ve.WARN,...e),this._logHandler(this,ve.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ve.ERROR,...e),this._logHandler(this,ve.ERROR,...e)}}function Bb(n){gh.forEach(e=>{e.setLogLevel(n)})}function Ub(n,e){for(const t of gh){let r=null;e&&e.level&&(r=V_[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{const a=o.map(l=>{if(l==null)return null;if(typeof l=="string")return l;if(typeof l=="number"||typeof l=="boolean")return l.toString();if(l instanceof Error)return l.message;try{return JSON.stringify(l)}catch{return null}}).filter(l=>l).join(" ");s>=(r??i.logLevel)&&n({level:ve[s].toLowerCase(),message:a,args:o,type:i.name})}}}const qb=(n,e)=>e.some(t=>n instanceof t);let dp,fp;function jb(){return dp||(dp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $b(){return fp||(fp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const N_=new WeakMap,lu=new WeakMap,O_=new WeakMap,Ll=new WeakMap,yh=new WeakMap;function Gb(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(dr(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&N_.set(t,n)}).catch(()=>{}),yh.set(e,n),e}function zb(n){if(lu.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});lu.set(n,e)}let uu={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return lu.get(n);if(e==="objectStoreNames")return n.objectStoreNames||O_.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return dr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Kb(n){uu=n(uu)}function Hb(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Fl(this),e,...t);return O_.set(r,e.sort?e.sort():[e]),dr(r)}:$b().includes(n)?function(...e){return n.apply(Fl(this),e),dr(N_.get(this))}:function(...e){return dr(n.apply(Fl(this),e))}}function Qb(n){return typeof n=="function"?Hb(n):(n instanceof IDBTransaction&&zb(n),qb(n,jb())?new Proxy(n,uu):n)}function dr(n){if(n instanceof IDBRequest)return Gb(n);if(Ll.has(n))return Ll.get(n);const e=Qb(n);return e!==n&&(Ll.set(n,e),yh.set(e,n)),e}const Fl=n=>yh.get(n);function Wb(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,e),a=dr(o);return r&&o.addEventListener("upgradeneeded",l=>{r(dr(o.result),l.oldVersion,l.newVersion,dr(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const Yb=["get","getKey","getAll","getAllKeys","count"],Jb=["put","add","delete","clear"],Bl=new Map;function pp(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Bl.get(e))return Bl.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=Jb.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Yb.includes(t)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),i&&l.done]))[0]};return Bl.set(e,s),s}Kb(n=>({...n,get:(e,t,r)=>pp(e,t)||n.get(e,t,r),has:(e,t)=>!!pp(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Zb(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Zb(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const sc="@firebase/app",hu="0.10.11";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bn=new _h("@firebase/app"),eA="@firebase/app-compat",tA="@firebase/analytics-compat",nA="@firebase/analytics",rA="@firebase/app-check-compat",iA="@firebase/app-check",sA="@firebase/auth",oA="@firebase/auth-compat",aA="@firebase/database",cA="@firebase/database-compat",lA="@firebase/functions",uA="@firebase/functions-compat",hA="@firebase/installations",dA="@firebase/installations-compat",fA="@firebase/messaging",pA="@firebase/messaging-compat",mA="@firebase/performance",gA="@firebase/performance-compat",_A="@firebase/remote-config",yA="@firebase/remote-config-compat",vA="@firebase/storage",IA="@firebase/storage-compat",EA="@firebase/firestore",TA="@firebase/vertexai-preview",wA="@firebase/firestore-compat",bA="firebase",AA="10.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gr="[DEFAULT]",SA={[sc]:"fire-core",[eA]:"fire-core-compat",[nA]:"fire-analytics",[tA]:"fire-analytics-compat",[iA]:"fire-app-check",[rA]:"fire-app-check-compat",[sA]:"fire-auth",[oA]:"fire-auth-compat",[aA]:"fire-rtdb",[cA]:"fire-rtdb-compat",[lA]:"fire-fn",[uA]:"fire-fn-compat",[hA]:"fire-iid",[dA]:"fire-iid-compat",[fA]:"fire-fcm",[pA]:"fire-fcm-compat",[mA]:"fire-perf",[gA]:"fire-perf-compat",[_A]:"fire-rc",[yA]:"fire-rc-compat",[vA]:"fire-gcs",[IA]:"fire-gcs-compat",[EA]:"fire-fst",[wA]:"fire-fst-compat",[TA]:"fire-vertex","fire-js":"fire-js",[bA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _r=new Map,Zi=new Map,es=new Map;function wo(n,e){try{n.container.addComponent(e)}catch(t){Bn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function k_(n,e){n.container.addOrOverwriteComponent(e)}function ts(n){const e=n.name;if(es.has(e))return Bn.debug(`There were multiple attempts to register component ${e}.`),!1;es.set(e,n);for(const t of _r.values())wo(t,n);for(const t of Zi.values())wo(t,n);return!0}function M_(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function RA(n,e,t=gr){M_(n,e).clearInstance(t)}function L_(n){return n.options!==void 0}function PA(n){return n.settings!==void 0}function CA(){es.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},cn=new Mc("app","Firebase",DA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let F_=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ii("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw cn.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA extends F_{constructor(e,t,r,i){const s=t.automaticDataCollectionEnabled!==void 0?t.automaticDataCollectionEnabled:!1,o={name:r,automaticDataCollectionEnabled:s};if(e.apiKey!==void 0)super(e,o,i);else{const a=e;super(a.options,o,i)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:s},t),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,Fn(sc,hu,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Eh(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw cn.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vh=AA;function Ih(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:gr,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw cn.create("bad-app-name",{appName:String(i)});if(t||(t=R_()),!t)throw cn.create("no-options");const s=_r.get(i);if(s){if(To(t,s.options)&&To(r,s.config))return s;throw cn.create("duplicate-app",{appName:i})}const o=new x_(i);for(const l of es.values())o.addComponent(l);const a=new F_(t,r,o);return _r.set(i,a),a}function VA(n,e){if(Ab()&&!P_())throw cn.create("invalid-server-app-environment");e.automaticDataCollectionEnabled===void 0&&(e.automaticDataCollectionEnabled=!1);let t;L_(n)?t=n.options:t=n;const r=Object.assign(Object.assign({},e),t);r.releaseOnDeref!==void 0&&delete r.releaseOnDeref;const i=u=>[...u].reduce((h,f)=>Math.imul(31,h)+f.charCodeAt(0)|0,0);if(e.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw cn.create("finalization-registry-not-supported",{});const s=""+i(JSON.stringify(r)),o=Zi.get(s);if(o)return o.incRefCount(e.releaseOnDeref),o;const a=new x_(s);for(const u of es.values())a.addComponent(u);const l=new xA(t,e,s,a);return Zi.set(s,l),l}function NA(n=gr){const e=_r.get(n);if(!e&&n===gr&&R_())return Ih();if(!e)throw cn.create("no-app",{appName:n});return e}function OA(){return Array.from(_r.values())}async function Eh(n){let e=!1;const t=n.name;_r.has(t)?(e=!0,_r.delete(t)):Zi.has(t)&&n.decRefCount()<=0&&(Zi.delete(t),e=!0),e&&(await Promise.all(n.container.getProviders().map(r=>r.delete())),n.isDeleted=!0)}function Fn(n,e,t){var r;let i=(r=SA[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Bn.warn(a.join(" "));return}ts(new ii(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function B_(n,e){if(n!==null&&typeof n!="function")throw cn.create("invalid-log-argument");Ub(n,e)}function U_(n){Bb(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kA="firebase-heartbeat-database",MA=1,bo="firebase-heartbeat-store";let Ul=null;function q_(){return Ul||(Ul=Wb(kA,MA,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(bo)}catch(t){console.warn(t)}}}}).catch(n=>{throw cn.create("idb-open",{originalErrorMessage:n.message})})),Ul}async function LA(n){try{const t=(await q_()).transaction(bo),r=await t.objectStore(bo).get(j_(n));return await t.done,r}catch(e){if(e instanceof gi)Bn.warn(e.message);else{const t=cn.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Bn.warn(t.message)}}}async function mp(n,e){try{const r=(await q_()).transaction(bo,"readwrite");await r.objectStore(bo).put(e,j_(n)),await r.done}catch(t){if(t instanceof gi)Bn.warn(t.message);else{const r=cn.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Bn.warn(r.message)}}}function j_(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FA=1024,BA=30*24*60*60*1e3;class UA{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new jA(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=gp();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=BA}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Bn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=gp(),{heartbeatsToSend:r,unsentEntries:i}=qA(this._heartbeatsCache.heartbeats),s=nc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Bn.warn(t),""}}}function gp(){return new Date().toISOString().substring(0,10)}function qA(n,e=FA){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),_p(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),_p(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class jA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return D_()?Sb().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await LA(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return mp(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return mp(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function _p(n){return nc(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $A(n){ts(new ii("platform-logger",e=>new Xb(e),"PRIVATE")),ts(new ii("heartbeat",e=>new UA(e),"PRIVATE")),Fn(sc,hu,n),Fn(sc,hu,"esm2017"),Fn("fire-js","")}$A("");const GA=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:gi,SDK_VERSION:vh,_DEFAULT_ENTRY_NAME:gr,_addComponent:wo,_addOrOverwriteComponent:k_,_apps:_r,_clearComponents:CA,_components:es,_getProvider:M_,_isFirebaseApp:L_,_isFirebaseServerApp:PA,_registerComponent:ts,_removeServiceInstance:RA,_serverApps:Zi,deleteApp:Eh,getApp:NA,getApps:OA,initializeApp:Ih,initializeServerApp:VA,onLog:B_,registerVersion:Fn,setLogLevel:U_},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zA{constructor(e,t){this._delegate=e,this.firebase=t,wo(e,new ii("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),Eh(this._delegate)))}_getService(e,t=gr){var r;this._delegate.checkDestroyed();const i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=gr){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){wo(this._delegate,e)}_addOrOverwriteComponent(e){k_(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KA={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},yp=new Mc("app-compat","Firebase",KA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HA(n){const e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:Fn,setLogLevel:U_,onLog:B_,apps:null,SDK_VERSION:vh,INTERNAL:{registerComponent:a,removeApp:r,useAsService:l,modularAPIs:GA}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(u){delete e[u]}function i(u){if(u=u||gr,!up(e,u))throw yp.create("no-app",{appName:u});return e[u]}i.App=n;function s(u,h={}){const f=Ih(u,h);if(up(e,f.name))return e[f.name];const m=new n(f,t);return e[f.name]=m,m}function o(){return Object.keys(e).map(u=>e[u])}function a(u){const h=u.name,f=h.replace("-compat","");if(ts(u)&&u.type==="PUBLIC"){const m=(_=i())=>{if(typeof _[f]!="function")throw yp.create("invalid-app-argument",{appName:h});return _[f]()};u.serviceProps!==void 0&&rc(m,u.serviceProps),t[f]=m,n.prototype[f]=function(..._){return this._getService.bind(this,h).apply(this,u.multipleInstances?_:[])}}return u.type==="PUBLIC"?t[f]:null}function l(u,h){return h==="serverAuth"?null:h}return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $_(){const n=HA(zA);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:$_,extendNamespace:e,createSubscribe:Db,ErrorFactory:Mc,deepExtend:rc});function e(t){rc(n,t)}return n}const QA=$_();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vp=new _h("@firebase/app-compat"),WA="@firebase/app-compat",YA="0.2.41";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JA(n){Fn(WA,YA,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const n=A_();if(n.firebase!==void 0){vp.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=n.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&vp.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const Lc=QA;JA();var XA="firebase",ZA="10.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Lc.registerVersion(XA,ZA,"app-compat");var Ip=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ni,G_;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,v){function I(){}I.prototype=v.prototype,A.D=v.prototype,A.prototype=new I,A.prototype.constructor=A,A.C=function(b,S,w){for(var E=Array(arguments.length-2),Ne=2;Ne<arguments.length;Ne++)E[Ne-2]=arguments[Ne];return v.prototype[S].apply(b,E)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,v,I){I||(I=0);var b=Array(16);if(typeof v=="string")for(var S=0;16>S;++S)b[S]=v.charCodeAt(I++)|v.charCodeAt(I++)<<8|v.charCodeAt(I++)<<16|v.charCodeAt(I++)<<24;else for(S=0;16>S;++S)b[S]=v[I++]|v[I++]<<8|v[I++]<<16|v[I++]<<24;v=A.g[0],I=A.g[1],S=A.g[2];var w=A.g[3],E=v+(w^I&(S^w))+b[0]+3614090360&4294967295;v=I+(E<<7&4294967295|E>>>25),E=w+(S^v&(I^S))+b[1]+3905402710&4294967295,w=v+(E<<12&4294967295|E>>>20),E=S+(I^w&(v^I))+b[2]+606105819&4294967295,S=w+(E<<17&4294967295|E>>>15),E=I+(v^S&(w^v))+b[3]+3250441966&4294967295,I=S+(E<<22&4294967295|E>>>10),E=v+(w^I&(S^w))+b[4]+4118548399&4294967295,v=I+(E<<7&4294967295|E>>>25),E=w+(S^v&(I^S))+b[5]+1200080426&4294967295,w=v+(E<<12&4294967295|E>>>20),E=S+(I^w&(v^I))+b[6]+2821735955&4294967295,S=w+(E<<17&4294967295|E>>>15),E=I+(v^S&(w^v))+b[7]+4249261313&4294967295,I=S+(E<<22&4294967295|E>>>10),E=v+(w^I&(S^w))+b[8]+1770035416&4294967295,v=I+(E<<7&4294967295|E>>>25),E=w+(S^v&(I^S))+b[9]+2336552879&4294967295,w=v+(E<<12&4294967295|E>>>20),E=S+(I^w&(v^I))+b[10]+4294925233&4294967295,S=w+(E<<17&4294967295|E>>>15),E=I+(v^S&(w^v))+b[11]+2304563134&4294967295,I=S+(E<<22&4294967295|E>>>10),E=v+(w^I&(S^w))+b[12]+1804603682&4294967295,v=I+(E<<7&4294967295|E>>>25),E=w+(S^v&(I^S))+b[13]+4254626195&4294967295,w=v+(E<<12&4294967295|E>>>20),E=S+(I^w&(v^I))+b[14]+2792965006&4294967295,S=w+(E<<17&4294967295|E>>>15),E=I+(v^S&(w^v))+b[15]+1236535329&4294967295,I=S+(E<<22&4294967295|E>>>10),E=v+(S^w&(I^S))+b[1]+4129170786&4294967295,v=I+(E<<5&4294967295|E>>>27),E=w+(I^S&(v^I))+b[6]+3225465664&4294967295,w=v+(E<<9&4294967295|E>>>23),E=S+(v^I&(w^v))+b[11]+643717713&4294967295,S=w+(E<<14&4294967295|E>>>18),E=I+(w^v&(S^w))+b[0]+3921069994&4294967295,I=S+(E<<20&4294967295|E>>>12),E=v+(S^w&(I^S))+b[5]+3593408605&4294967295,v=I+(E<<5&4294967295|E>>>27),E=w+(I^S&(v^I))+b[10]+38016083&4294967295,w=v+(E<<9&4294967295|E>>>23),E=S+(v^I&(w^v))+b[15]+3634488961&4294967295,S=w+(E<<14&4294967295|E>>>18),E=I+(w^v&(S^w))+b[4]+3889429448&4294967295,I=S+(E<<20&4294967295|E>>>12),E=v+(S^w&(I^S))+b[9]+568446438&4294967295,v=I+(E<<5&4294967295|E>>>27),E=w+(I^S&(v^I))+b[14]+3275163606&4294967295,w=v+(E<<9&4294967295|E>>>23),E=S+(v^I&(w^v))+b[3]+4107603335&4294967295,S=w+(E<<14&4294967295|E>>>18),E=I+(w^v&(S^w))+b[8]+1163531501&4294967295,I=S+(E<<20&4294967295|E>>>12),E=v+(S^w&(I^S))+b[13]+2850285829&4294967295,v=I+(E<<5&4294967295|E>>>27),E=w+(I^S&(v^I))+b[2]+4243563512&4294967295,w=v+(E<<9&4294967295|E>>>23),E=S+(v^I&(w^v))+b[7]+1735328473&4294967295,S=w+(E<<14&4294967295|E>>>18),E=I+(w^v&(S^w))+b[12]+2368359562&4294967295,I=S+(E<<20&4294967295|E>>>12),E=v+(I^S^w)+b[5]+4294588738&4294967295,v=I+(E<<4&4294967295|E>>>28),E=w+(v^I^S)+b[8]+2272392833&4294967295,w=v+(E<<11&4294967295|E>>>21),E=S+(w^v^I)+b[11]+1839030562&4294967295,S=w+(E<<16&4294967295|E>>>16),E=I+(S^w^v)+b[14]+4259657740&4294967295,I=S+(E<<23&4294967295|E>>>9),E=v+(I^S^w)+b[1]+2763975236&4294967295,v=I+(E<<4&4294967295|E>>>28),E=w+(v^I^S)+b[4]+1272893353&4294967295,w=v+(E<<11&4294967295|E>>>21),E=S+(w^v^I)+b[7]+4139469664&4294967295,S=w+(E<<16&4294967295|E>>>16),E=I+(S^w^v)+b[10]+3200236656&4294967295,I=S+(E<<23&4294967295|E>>>9),E=v+(I^S^w)+b[13]+681279174&4294967295,v=I+(E<<4&4294967295|E>>>28),E=w+(v^I^S)+b[0]+3936430074&4294967295,w=v+(E<<11&4294967295|E>>>21),E=S+(w^v^I)+b[3]+3572445317&4294967295,S=w+(E<<16&4294967295|E>>>16),E=I+(S^w^v)+b[6]+76029189&4294967295,I=S+(E<<23&4294967295|E>>>9),E=v+(I^S^w)+b[9]+3654602809&4294967295,v=I+(E<<4&4294967295|E>>>28),E=w+(v^I^S)+b[12]+3873151461&4294967295,w=v+(E<<11&4294967295|E>>>21),E=S+(w^v^I)+b[15]+530742520&4294967295,S=w+(E<<16&4294967295|E>>>16),E=I+(S^w^v)+b[2]+3299628645&4294967295,I=S+(E<<23&4294967295|E>>>9),E=v+(S^(I|~w))+b[0]+4096336452&4294967295,v=I+(E<<6&4294967295|E>>>26),E=w+(I^(v|~S))+b[7]+1126891415&4294967295,w=v+(E<<10&4294967295|E>>>22),E=S+(v^(w|~I))+b[14]+2878612391&4294967295,S=w+(E<<15&4294967295|E>>>17),E=I+(w^(S|~v))+b[5]+4237533241&4294967295,I=S+(E<<21&4294967295|E>>>11),E=v+(S^(I|~w))+b[12]+1700485571&4294967295,v=I+(E<<6&4294967295|E>>>26),E=w+(I^(v|~S))+b[3]+2399980690&4294967295,w=v+(E<<10&4294967295|E>>>22),E=S+(v^(w|~I))+b[10]+4293915773&4294967295,S=w+(E<<15&4294967295|E>>>17),E=I+(w^(S|~v))+b[1]+2240044497&4294967295,I=S+(E<<21&4294967295|E>>>11),E=v+(S^(I|~w))+b[8]+1873313359&4294967295,v=I+(E<<6&4294967295|E>>>26),E=w+(I^(v|~S))+b[15]+4264355552&4294967295,w=v+(E<<10&4294967295|E>>>22),E=S+(v^(w|~I))+b[6]+2734768916&4294967295,S=w+(E<<15&4294967295|E>>>17),E=I+(w^(S|~v))+b[13]+1309151649&4294967295,I=S+(E<<21&4294967295|E>>>11),E=v+(S^(I|~w))+b[4]+4149444226&4294967295,v=I+(E<<6&4294967295|E>>>26),E=w+(I^(v|~S))+b[11]+3174756917&4294967295,w=v+(E<<10&4294967295|E>>>22),E=S+(v^(w|~I))+b[2]+718787259&4294967295,S=w+(E<<15&4294967295|E>>>17),E=I+(w^(S|~v))+b[9]+3951481745&4294967295,A.g[0]=A.g[0]+v&4294967295,A.g[1]=A.g[1]+(S+(E<<21&4294967295|E>>>11))&4294967295,A.g[2]=A.g[2]+S&4294967295,A.g[3]=A.g[3]+w&4294967295}r.prototype.u=function(A,v){v===void 0&&(v=A.length);for(var I=v-this.blockSize,b=this.B,S=this.h,w=0;w<v;){if(S==0)for(;w<=I;)i(this,A,w),w+=this.blockSize;if(typeof A=="string"){for(;w<v;)if(b[S++]=A.charCodeAt(w++),S==this.blockSize){i(this,b),S=0;break}}else for(;w<v;)if(b[S++]=A[w++],S==this.blockSize){i(this,b),S=0;break}}this.h=S,this.o+=v},r.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var v=1;v<A.length-8;++v)A[v]=0;var I=8*this.o;for(v=A.length-8;v<A.length;++v)A[v]=I&255,I/=256;for(this.u(A),A=Array(16),v=I=0;4>v;++v)for(var b=0;32>b;b+=8)A[I++]=this.g[v]>>>b&255;return A};function s(A,v){var I=a;return Object.prototype.hasOwnProperty.call(I,A)?I[A]:I[A]=v(A)}function o(A,v){this.h=v;for(var I=[],b=!0,S=A.length-1;0<=S;S--){var w=A[S]|0;b&&w==v||(I[S]=w,b=!1)}this.g=I}var a={};function l(A){return-128<=A&&128>A?s(A,function(v){return new o([v|0],0>v?-1:0)}):new o([A|0],0>A?-1:0)}function u(A){if(isNaN(A)||!isFinite(A))return f;if(0>A)return N(u(-A));for(var v=[],I=1,b=0;A>=I;b++)v[b]=A/I|0,I*=4294967296;return new o(v,0)}function h(A,v){if(A.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(A.charAt(0)=="-")return N(h(A.substring(1),v));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=u(Math.pow(v,8)),b=f,S=0;S<A.length;S+=8){var w=Math.min(8,A.length-S),E=parseInt(A.substring(S,S+w),v);8>w?(w=u(Math.pow(v,w)),b=b.j(w).add(u(E))):(b=b.j(I),b=b.add(u(E)))}return b}var f=l(0),m=l(1),_=l(16777216);n=o.prototype,n.m=function(){if(x(this))return-N(this).m();for(var A=0,v=1,I=0;I<this.g.length;I++){var b=this.i(I);A+=(0<=b?b:4294967296+b)*v,v*=4294967296}return A},n.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(R(this))return"0";if(x(this))return"-"+N(this).toString(A);for(var v=u(Math.pow(A,6)),I=this,b="";;){var S=z(I,v).g;I=j(I,S.j(v));var w=((0<I.g.length?I.g[0]:I.h)>>>0).toString(A);if(I=S,R(I))return w+b;for(;6>w.length;)w="0"+w;b=w+b}},n.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function R(A){if(A.h!=0)return!1;for(var v=0;v<A.g.length;v++)if(A.g[v]!=0)return!1;return!0}function x(A){return A.h==-1}n.l=function(A){return A=j(this,A),x(A)?-1:R(A)?0:1};function N(A){for(var v=A.g.length,I=[],b=0;b<v;b++)I[b]=~A.g[b];return new o(I,~A.h).add(m)}n.abs=function(){return x(this)?N(this):this},n.add=function(A){for(var v=Math.max(this.g.length,A.g.length),I=[],b=0,S=0;S<=v;S++){var w=b+(this.i(S)&65535)+(A.i(S)&65535),E=(w>>>16)+(this.i(S)>>>16)+(A.i(S)>>>16);b=E>>>16,w&=65535,E&=65535,I[S]=E<<16|w}return new o(I,I[I.length-1]&-2147483648?-1:0)};function j(A,v){return A.add(N(v))}n.j=function(A){if(R(this)||R(A))return f;if(x(this))return x(A)?N(this).j(N(A)):N(N(this).j(A));if(x(A))return N(this.j(N(A)));if(0>this.l(_)&&0>A.l(_))return u(this.m()*A.m());for(var v=this.g.length+A.g.length,I=[],b=0;b<2*v;b++)I[b]=0;for(b=0;b<this.g.length;b++)for(var S=0;S<A.g.length;S++){var w=this.i(b)>>>16,E=this.i(b)&65535,Ne=A.i(S)>>>16,mt=A.i(S)&65535;I[2*b+2*S]+=E*mt,U(I,2*b+2*S),I[2*b+2*S+1]+=w*mt,U(I,2*b+2*S+1),I[2*b+2*S+1]+=E*Ne,U(I,2*b+2*S+1),I[2*b+2*S+2]+=w*Ne,U(I,2*b+2*S+2)}for(b=0;b<v;b++)I[b]=I[2*b+1]<<16|I[2*b];for(b=v;b<2*v;b++)I[b]=0;return new o(I,0)};function U(A,v){for(;(A[v]&65535)!=A[v];)A[v+1]+=A[v]>>>16,A[v]&=65535,v++}function F(A,v){this.g=A,this.h=v}function z(A,v){if(R(v))throw Error("division by zero");if(R(A))return new F(f,f);if(x(A))return v=z(N(A),v),new F(N(v.g),N(v.h));if(x(v))return v=z(A,N(v)),new F(N(v.g),v.h);if(30<A.g.length){if(x(A)||x(v))throw Error("slowDivide_ only works with positive integers.");for(var I=m,b=v;0>=b.l(A);)I=se(I),b=se(b);var S=oe(I,1),w=oe(b,1);for(b=oe(b,2),I=oe(I,2);!R(b);){var E=w.add(b);0>=E.l(A)&&(S=S.add(I),w=E),b=oe(b,1),I=oe(I,1)}return v=j(A,S.j(v)),new F(S,v)}for(S=f;0<=A.l(v);){for(I=Math.max(1,Math.floor(A.m()/v.m())),b=Math.ceil(Math.log(I)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),w=u(I),E=w.j(v);x(E)||0<E.l(A);)I-=b,w=u(I),E=w.j(v);R(w)&&(w=m),S=S.add(w),A=j(A,E)}return new F(S,A)}n.A=function(A){return z(this,A).h},n.and=function(A){for(var v=Math.max(this.g.length,A.g.length),I=[],b=0;b<v;b++)I[b]=this.i(b)&A.i(b);return new o(I,this.h&A.h)},n.or=function(A){for(var v=Math.max(this.g.length,A.g.length),I=[],b=0;b<v;b++)I[b]=this.i(b)|A.i(b);return new o(I,this.h|A.h)},n.xor=function(A){for(var v=Math.max(this.g.length,A.g.length),I=[],b=0;b<v;b++)I[b]=this.i(b)^A.i(b);return new o(I,this.h^A.h)};function se(A){for(var v=A.g.length+1,I=[],b=0;b<v;b++)I[b]=A.i(b)<<1|A.i(b-1)>>>31;return new o(I,A.h)}function oe(A,v){var I=v>>5;v%=32;for(var b=A.g.length-I,S=[],w=0;w<b;w++)S[w]=0<v?A.i(w+I)>>>v|A.i(w+I+1)<<32-v:A.i(w+I);return new o(S,A.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,G_=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,ni=o}).apply(typeof Ip<"u"?Ip:typeof self<"u"?self:typeof window<"u"?window:{});var Ra=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var z_,K_,Ws,H_,La,du,Q_,W_,Y_;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,d,p){return c==Array.prototype||c==Object.prototype||(c[d]=p.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ra=="object"&&Ra];for(var d=0;d<c.length;++d){var p=c[d];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function i(c,d){if(d)e:{var p=r;c=c.split(".");for(var g=0;g<c.length-1;g++){var C=c[g];if(!(C in p))break e;p=p[C]}c=c[c.length-1],g=p[c],d=d(g),d!=g&&d!=null&&e(p,c,{configurable:!0,writable:!0,value:d})}}function s(c,d){c instanceof String&&(c+="");var p=0,g=!1,C={next:function(){if(!g&&p<c.length){var k=p++;return{value:d(k,c[k]),done:!1}}return g=!0,{done:!0,value:void 0}}};return C[Symbol.iterator]=function(){return C},C}i("Array.prototype.values",function(c){return c||function(){return s(this,function(d,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(c){var d=typeof c;return d=d!="object"?d:c?Array.isArray(c)?"array":d:"null",d=="array"||d=="object"&&typeof c.length=="number"}function u(c){var d=typeof c;return d=="object"&&c!=null||d=="function"}function h(c,d,p){return c.call.apply(c.bind,arguments)}function f(c,d,p){if(!c)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var C=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(C,g),c.apply(d,C)}}return function(){return c.apply(d,arguments)}}function m(c,d,p){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,m.apply(null,arguments)}function _(c,d){var p=Array.prototype.slice.call(arguments,1);return function(){var g=p.slice();return g.push.apply(g,arguments),c.apply(this,g)}}function R(c,d){function p(){}p.prototype=d.prototype,c.aa=d.prototype,c.prototype=new p,c.prototype.constructor=c,c.Qb=function(g,C,k){for(var W=Array(arguments.length-2),Me=2;Me<arguments.length;Me++)W[Me-2]=arguments[Me];return d.prototype[C].apply(g,W)}}function x(c){const d=c.length;if(0<d){const p=Array(d);for(let g=0;g<d;g++)p[g]=c[g];return p}return[]}function N(c,d){for(let p=1;p<arguments.length;p++){const g=arguments[p];if(l(g)){const C=c.length||0,k=g.length||0;c.length=C+k;for(let W=0;W<k;W++)c[C+W]=g[W]}else c.push(g)}}class j{constructor(d,p){this.i=d,this.j=p,this.h=0,this.g=null}get(){let d;return 0<this.h?(this.h--,d=this.g,this.g=d.next,d.next=null):d=this.i(),d}}function U(c){return/^[\s\xa0]*$/.test(c)}function F(){var c=a.navigator;return c&&(c=c.userAgent)?c:""}function z(c){return z[" "](c),c}z[" "]=function(){};var se=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function oe(c,d,p){for(const g in c)d.call(p,c[g],g,c)}function A(c,d){for(const p in c)d.call(void 0,c[p],p,c)}function v(c){const d={};for(const p in c)d[p]=c[p];return d}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(c,d){let p,g;for(let C=1;C<arguments.length;C++){g=arguments[C];for(p in g)c[p]=g[p];for(let k=0;k<I.length;k++)p=I[k],Object.prototype.hasOwnProperty.call(g,p)&&(c[p]=g[p])}}function S(c){var d=1;c=c.split(":");const p=[];for(;0<d&&c.length;)p.push(c.shift()),d--;return c.length&&p.push(c.join(":")),p}function w(c){a.setTimeout(()=>{throw c},0)}function E(){var c=Qt;let d=null;return c.g&&(d=c.g,c.g=c.g.next,c.g||(c.h=null),d.next=null),d}class Ne{constructor(){this.h=this.g=null}add(d,p){const g=mt.get();g.set(d,p),this.h?this.h.next=g:this.g=g,this.h=g}}var mt=new j(()=>new Qe,c=>c.reset());class Qe{constructor(){this.next=this.g=this.h=null}set(d,p){this.h=d,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let Ee,ge=!1,Qt=new Ne,ln=()=>{const c=a.Promise.resolve(void 0);Ee=()=>{c.then(tn)}};var tn=()=>{for(var c;c=E();){try{c.h.call(c.g)}catch(p){w(p)}var d=mt;d.j(c),100>d.h&&(d.h++,c.next=d.g,d.g=c)}ge=!1};function We(){this.s=this.s,this.C=this.C}We.prototype.s=!1,We.prototype.ma=function(){this.s||(this.s=!0,this.N())},We.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ye(c,d){this.type=c,this.g=this.target=d,this.defaultPrevented=!1}Ye.prototype.h=function(){this.defaultPrevented=!0};var Kn=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,d=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const p=()=>{};a.addEventListener("test",p,d),a.removeEventListener("test",p,d)}catch{}return c}();function _n(c,d){if(Ye.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var p=this.type=c.type,g=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=d,d=c.relatedTarget){if(se){e:{try{z(d.nodeName);var C=!0;break e}catch{}C=!1}C||(d=null)}}else p=="mouseover"?d=c.fromElement:p=="mouseout"&&(d=c.toElement);this.relatedTarget=d,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:Ut[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&_n.aa.h.call(this)}}R(_n,Ye);var Ut={2:"touch",3:"pen",4:"mouse"};_n.prototype.h=function(){_n.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var L="closure_listenable_"+(1e6*Math.random()|0),te=0;function Z(c,d,p,g,C){this.listener=c,this.proxy=null,this.src=d,this.type=p,this.capture=!!g,this.ha=C,this.key=++te,this.da=this.fa=!1}function re(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Te(c){this.src=c,this.g={},this.h=0}Te.prototype.add=function(c,d,p,g,C){var k=c.toString();c=this.g[k],c||(c=this.g[k]=[],this.h++);var W=y(c,d,g,C);return-1<W?(d=c[W],p||(d.fa=!1)):(d=new Z(d,this.src,k,!!g,C),d.fa=p,c.push(d)),d};function ke(c,d){var p=d.type;if(p in c.g){var g=c.g[p],C=Array.prototype.indexOf.call(g,d,void 0),k;(k=0<=C)&&Array.prototype.splice.call(g,C,1),k&&(re(d),c.g[p].length==0&&(delete c.g[p],c.h--))}}function y(c,d,p,g){for(var C=0;C<c.length;++C){var k=c[C];if(!k.da&&k.listener==d&&k.capture==!!p&&k.ha==g)return C}return-1}var T="closure_lm_"+(1e6*Math.random()|0),V={};function $(c,d,p,g,C){if(Array.isArray(d)){for(var k=0;k<d.length;k++)$(c,d[k],p,g,C);return null}return p=ce(p),c&&c[L]?c.K(d,p,u(g)?!!g.capture:!!g,C):M(c,d,p,!1,g,C)}function M(c,d,p,g,C,k){if(!d)throw Error("Invalid event type");var W=u(C)?!!C.capture:!!C,Me=ue(c);if(Me||(c[T]=Me=new Te(c)),p=Me.add(d,p,g,W,k),p.proxy)return p;if(g=G(),p.proxy=g,g.src=c,g.listener=p,c.addEventListener)Kn||(C=W),C===void 0&&(C=!1),c.addEventListener(d.toString(),g,C);else if(c.attachEvent)c.attachEvent(H(d.toString()),g);else if(c.addListener&&c.removeListener)c.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return p}function G(){function c(p){return d.call(c.src,c.listener,p)}const d=K;return c}function X(c,d,p,g,C){if(Array.isArray(d))for(var k=0;k<d.length;k++)X(c,d[k],p,g,C);else g=u(g)?!!g.capture:!!g,p=ce(p),c&&c[L]?(c=c.i,d=String(d).toString(),d in c.g&&(k=c.g[d],p=y(k,p,g,C),-1<p&&(re(k[p]),Array.prototype.splice.call(k,p,1),k.length==0&&(delete c.g[d],c.h--)))):c&&(c=ue(c))&&(d=c.g[d.toString()],c=-1,d&&(c=y(d,p,g,C)),(p=-1<c?d[c]:null)&&Q(p))}function Q(c){if(typeof c!="number"&&c&&!c.da){var d=c.src;if(d&&d[L])ke(d.i,c);else{var p=c.type,g=c.proxy;d.removeEventListener?d.removeEventListener(p,g,c.capture):d.detachEvent?d.detachEvent(H(p),g):d.addListener&&d.removeListener&&d.removeListener(g),(p=ue(d))?(ke(p,c),p.h==0&&(p.src=null,d[T]=null)):re(c)}}}function H(c){return c in V?V[c]:V[c]="on"+c}function K(c,d){if(c.da)c=!0;else{d=new _n(d,this);var p=c.listener,g=c.ha||c.src;c.fa&&Q(c),c=p.call(g,d)}return c}function ue(c){return c=c[T],c instanceof Te?c:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function ce(c){return typeof c=="function"?c:(c[ee]||(c[ee]=function(d){return c.handleEvent(d)}),c[ee])}function ie(){We.call(this),this.i=new Te(this),this.M=this,this.F=null}R(ie,We),ie.prototype[L]=!0,ie.prototype.removeEventListener=function(c,d,p,g){X(this,c,d,p,g)};function de(c,d){var p,g=c.F;if(g)for(p=[];g;g=g.F)p.push(g);if(c=c.M,g=d.type||d,typeof d=="string")d=new Ye(d,c);else if(d instanceof Ye)d.target=d.target||c;else{var C=d;d=new Ye(g,c),b(d,C)}if(C=!0,p)for(var k=p.length-1;0<=k;k--){var W=d.g=p[k];C=Re(W,g,!0,d)&&C}if(W=d.g=c,C=Re(W,g,!0,d)&&C,C=Re(W,g,!1,d)&&C,p)for(k=0;k<p.length;k++)W=d.g=p[k],C=Re(W,g,!1,d)&&C}ie.prototype.N=function(){if(ie.aa.N.call(this),this.i){var c=this.i,d;for(d in c.g){for(var p=c.g[d],g=0;g<p.length;g++)re(p[g]);delete c.g[d],c.h--}}this.F=null},ie.prototype.K=function(c,d,p,g){return this.i.add(String(c),d,!1,p,g)},ie.prototype.L=function(c,d,p,g){return this.i.add(String(c),d,!0,p,g)};function Re(c,d,p,g){if(d=c.i.g[String(d)],!d)return!0;d=d.concat();for(var C=!0,k=0;k<d.length;++k){var W=d[k];if(W&&!W.da&&W.capture==p){var Me=W.listener,_t=W.ha||W.src;W.fa&&ke(c.i,W),C=Me.call(_t,g)!==!1&&C}}return C&&!g.defaultPrevented}function Ae(c,d,p){if(typeof c=="function")p&&(c=m(c,p));else if(c&&typeof c.handleEvent=="function")c=m(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(d)?-1:a.setTimeout(c,d||0)}function Et(c){c.g=Ae(()=>{c.g=null,c.i&&(c.i=!1,Et(c))},c.l);const d=c.h;c.h=null,c.m.apply(null,d)}class lt extends We{constructor(d,p){super(),this.m=d,this.l=p,this.h=null,this.i=!1,this.g=null}j(d){this.h=arguments,this.g?this.i=!0:Et(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function gt(c){We.call(this),this.h=c,this.g={}}R(gt,We);var Tt=[];function Hn(c){oe(c.g,function(d,p){this.g.hasOwnProperty(p)&&Q(d)},c),c.g={}}gt.prototype.N=function(){gt.aa.N.call(this),Hn(this)},gt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ti=a.JSON.stringify,xt=a.JSON.parse,nn=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function wi(){}wi.prototype.h=null;function Pd(c){return c.h||(c.h=c.i())}function Cd(){}var Ss={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function cl(){Ye.call(this,"d")}R(cl,Ye);function ll(){Ye.call(this,"c")}R(ll,Ye);var Nr={},Dd=null;function sa(){return Dd=Dd||new ie}Nr.La="serverreachability";function xd(c){Ye.call(this,Nr.La,c)}R(xd,Ye);function Rs(c){const d=sa();de(d,new xd(d))}Nr.STAT_EVENT="statevent";function Vd(c,d){Ye.call(this,Nr.STAT_EVENT,c),this.stat=d}R(Vd,Ye);function Vt(c){const d=sa();de(d,new Vd(d,c))}Nr.Ma="timingevent";function Nd(c,d){Ye.call(this,Nr.Ma,c),this.size=d}R(Nd,Ye);function Ps(c,d){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},d)}function Cs(){this.g=!0}Cs.prototype.xa=function(){this.g=!1};function xI(c,d,p,g,C,k){c.info(function(){if(c.g)if(k)for(var W="",Me=k.split("&"),_t=0;_t<Me.length;_t++){var Se=Me[_t].split("=");if(1<Se.length){var wt=Se[0];Se=Se[1];var bt=wt.split("_");W=2<=bt.length&&bt[1]=="type"?W+(wt+"="+Se+"&"):W+(wt+"=redacted&")}}else W=null;else W=k;return"XMLHTTP REQ ("+g+") [attempt "+C+"]: "+d+`
`+p+`
`+W})}function VI(c,d,p,g,C,k,W){c.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+C+"]: "+d+`
`+p+`
`+k+" "+W})}function bi(c,d,p,g){c.info(function(){return"XMLHTTP TEXT ("+d+"): "+OI(c,p)+(g?" "+g:"")})}function NI(c,d){c.info(function(){return"TIMEOUT: "+d})}Cs.prototype.info=function(){};function OI(c,d){if(!c.g)return d;if(!d)return null;try{var p=JSON.parse(d);if(p){for(c=0;c<p.length;c++)if(Array.isArray(p[c])){var g=p[c];if(!(2>g.length)){var C=g[1];if(Array.isArray(C)&&!(1>C.length)){var k=C[0];if(k!="noop"&&k!="stop"&&k!="close")for(var W=1;W<C.length;W++)C[W]=""}}}}return Ti(p)}catch{return d}}var oa={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Od={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ul;function aa(){}R(aa,wi),aa.prototype.g=function(){return new XMLHttpRequest},aa.prototype.i=function(){return{}},ul=new aa;function Qn(c,d,p,g){this.j=c,this.i=d,this.l=p,this.R=g||1,this.U=new gt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new kd}function kd(){this.i=null,this.g="",this.h=!1}var Md={},hl={};function dl(c,d,p){c.L=1,c.v=ha(Cn(d)),c.m=p,c.P=!0,Ld(c,null)}function Ld(c,d){c.F=Date.now(),ca(c),c.A=Cn(c.v);var p=c.A,g=c.R;Array.isArray(g)||(g=[String(g)]),Jd(p.i,"t",g),c.C=0,p=c.j.J,c.h=new kd,c.g=gf(c.j,p?d:null,!c.m),0<c.O&&(c.M=new lt(m(c.Y,c,c.g),c.O)),d=c.U,p=c.g,g=c.ca;var C="readystatechange";Array.isArray(C)||(C&&(Tt[0]=C.toString()),C=Tt);for(var k=0;k<C.length;k++){var W=$(p,C[k],g||d.handleEvent,!1,d.h||d);if(!W)break;d.g[W.key]=W}d=c.H?v(c.H):{},c.m?(c.u||(c.u="POST"),d["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,d)):(c.u="GET",c.g.ea(c.A,c.u,null,d)),Rs(),xI(c.i,c.u,c.A,c.l,c.R,c.m)}Qn.prototype.ca=function(c){c=c.target;const d=this.M;d&&Dn(c)==3?d.j():this.Y(c)},Qn.prototype.Y=function(c){try{if(c==this.g)e:{const bt=Dn(this.g);var d=this.g.Ba();const Ri=this.g.Z();if(!(3>bt)&&(bt!=3||this.g&&(this.h.h||this.g.oa()||sf(this.g)))){this.J||bt!=4||d==7||(d==8||0>=Ri?Rs(3):Rs(2)),fl(this);var p=this.g.Z();this.X=p;t:if(Fd(this)){var g=sf(this.g);c="";var C=g.length,k=Dn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Or(this),Ds(this);var W="";break t}this.h.i=new a.TextDecoder}for(d=0;d<C;d++)this.h.h=!0,c+=this.h.i.decode(g[d],{stream:!(k&&d==C-1)});g.length=0,this.h.g+=c,this.C=0,W=this.h.g}else W=this.g.oa();if(this.o=p==200,VI(this.i,this.u,this.A,this.l,this.R,bt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Me,_t=this.g;if((Me=_t.g?_t.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(Me)){var Se=Me;break t}}Se=null}if(p=Se)bi(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,pl(this,p);else{this.o=!1,this.s=3,Vt(12),Or(this),Ds(this);break e}}if(this.P){p=!0;let un;for(;!this.J&&this.C<W.length;)if(un=kI(this,W),un==hl){bt==4&&(this.s=4,Vt(14),p=!1),bi(this.i,this.l,null,"[Incomplete Response]");break}else if(un==Md){this.s=4,Vt(15),bi(this.i,this.l,W,"[Invalid Chunk]"),p=!1;break}else bi(this.i,this.l,un,null),pl(this,un);if(Fd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),bt!=4||W.length!=0||this.h.h||(this.s=1,Vt(16),p=!1),this.o=this.o&&p,!p)bi(this.i,this.l,W,"[Invalid Chunked Response]"),Or(this),Ds(this);else if(0<W.length&&!this.W){this.W=!0;var wt=this.j;wt.g==this&&wt.ba&&!wt.M&&(wt.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),Il(wt),wt.M=!0,Vt(11))}}else bi(this.i,this.l,W,null),pl(this,W);bt==4&&Or(this),this.o&&!this.J&&(bt==4?df(this.j,this):(this.o=!1,ca(this)))}else XI(this.g),p==400&&0<W.indexOf("Unknown SID")?(this.s=3,Vt(12)):(this.s=0,Vt(13)),Or(this),Ds(this)}}}catch{}finally{}};function Fd(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function kI(c,d){var p=c.C,g=d.indexOf(`
`,p);return g==-1?hl:(p=Number(d.substring(p,g)),isNaN(p)?Md:(g+=1,g+p>d.length?hl:(d=d.slice(g,g+p),c.C=g+p,d)))}Qn.prototype.cancel=function(){this.J=!0,Or(this)};function ca(c){c.S=Date.now()+c.I,Bd(c,c.I)}function Bd(c,d){if(c.B!=null)throw Error("WatchDog timer not null");c.B=Ps(m(c.ba,c),d)}function fl(c){c.B&&(a.clearTimeout(c.B),c.B=null)}Qn.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(NI(this.i,this.A),this.L!=2&&(Rs(),Vt(17)),Or(this),this.s=2,Ds(this)):Bd(this,this.S-c)};function Ds(c){c.j.G==0||c.J||df(c.j,c)}function Or(c){fl(c);var d=c.M;d&&typeof d.ma=="function"&&d.ma(),c.M=null,Hn(c.U),c.g&&(d=c.g,c.g=null,d.abort(),d.ma())}function pl(c,d){try{var p=c.j;if(p.G!=0&&(p.g==c||ml(p.h,c))){if(!c.K&&ml(p.h,c)&&p.G==3){try{var g=p.Da.g.parse(d)}catch{g=null}if(Array.isArray(g)&&g.length==3){var C=g;if(C[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<c.F)ga(p),pa(p);else break e;vl(p),Vt(18)}}else p.za=C[1],0<p.za-p.T&&37500>C[2]&&p.F&&p.v==0&&!p.C&&(p.C=Ps(m(p.Za,p),6e3));if(1>=jd(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Mr(p,11)}else if((c.K||p.g==c)&&ga(p),!U(d))for(C=p.Da.g.parse(d),d=0;d<C.length;d++){let Se=C[d];if(p.T=Se[0],Se=Se[1],p.G==2)if(Se[0]=="c"){p.K=Se[1],p.ia=Se[2];const wt=Se[3];wt!=null&&(p.la=wt,p.j.info("VER="+p.la));const bt=Se[4];bt!=null&&(p.Aa=bt,p.j.info("SVER="+p.Aa));const Ri=Se[5];Ri!=null&&typeof Ri=="number"&&0<Ri&&(g=1.5*Ri,p.L=g,p.j.info("backChannelRequestTimeoutMs_="+g)),g=p;const un=c.g;if(un){const ya=un.g?un.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ya){var k=g.h;k.g||ya.indexOf("spdy")==-1&&ya.indexOf("quic")==-1&&ya.indexOf("h2")==-1||(k.j=k.l,k.g=new Set,k.h&&(gl(k,k.h),k.h=null))}if(g.D){const El=un.g?un.g.getResponseHeader("X-HTTP-Session-Id"):null;El&&(g.ya=El,je(g.I,g.D,El))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-c.F,p.j.info("Handshake RTT: "+p.R+"ms")),g=p;var W=c;if(g.qa=mf(g,g.J?g.ia:null,g.W),W.K){$d(g.h,W);var Me=W,_t=g.L;_t&&(Me.I=_t),Me.B&&(fl(Me),ca(Me)),g.g=W}else uf(g);0<p.i.length&&ma(p)}else Se[0]!="stop"&&Se[0]!="close"||Mr(p,7);else p.G==3&&(Se[0]=="stop"||Se[0]=="close"?Se[0]=="stop"?Mr(p,7):yl(p):Se[0]!="noop"&&p.l&&p.l.ta(Se),p.v=0)}}Rs(4)}catch{}}var MI=class{constructor(c,d){this.g=c,this.map=d}};function Ud(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function qd(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function jd(c){return c.h?1:c.g?c.g.size:0}function ml(c,d){return c.h?c.h==d:c.g?c.g.has(d):!1}function gl(c,d){c.g?c.g.add(d):c.h=d}function $d(c,d){c.h&&c.h==d?c.h=null:c.g&&c.g.has(d)&&c.g.delete(d)}Ud.prototype.cancel=function(){if(this.i=Gd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Gd(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let d=c.i;for(const p of c.g.values())d=d.concat(p.D);return d}return x(c.i)}function LI(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(l(c)){for(var d=[],p=c.length,g=0;g<p;g++)d.push(c[g]);return d}d=[],p=0;for(g in c)d[p++]=c[g];return d}function FI(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(l(c)||typeof c=="string"){var d=[];c=c.length;for(var p=0;p<c;p++)d.push(p);return d}d=[],p=0;for(const g in c)d[p++]=g;return d}}}function zd(c,d){if(c.forEach&&typeof c.forEach=="function")c.forEach(d,void 0);else if(l(c)||typeof c=="string")Array.prototype.forEach.call(c,d,void 0);else for(var p=FI(c),g=LI(c),C=g.length,k=0;k<C;k++)d.call(void 0,g[k],p&&p[k],c)}var Kd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function BI(c,d){if(c){c=c.split("&");for(var p=0;p<c.length;p++){var g=c[p].indexOf("="),C=null;if(0<=g){var k=c[p].substring(0,g);C=c[p].substring(g+1)}else k=c[p];d(k,C?decodeURIComponent(C.replace(/\+/g," ")):"")}}}function kr(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof kr){this.h=c.h,la(this,c.j),this.o=c.o,this.g=c.g,ua(this,c.s),this.l=c.l;var d=c.i,p=new Ns;p.i=d.i,d.g&&(p.g=new Map(d.g),p.h=d.h),Hd(this,p),this.m=c.m}else c&&(d=String(c).match(Kd))?(this.h=!1,la(this,d[1]||"",!0),this.o=xs(d[2]||""),this.g=xs(d[3]||"",!0),ua(this,d[4]),this.l=xs(d[5]||"",!0),Hd(this,d[6]||"",!0),this.m=xs(d[7]||"")):(this.h=!1,this.i=new Ns(null,this.h))}kr.prototype.toString=function(){var c=[],d=this.j;d&&c.push(Vs(d,Qd,!0),":");var p=this.g;return(p||d=="file")&&(c.push("//"),(d=this.o)&&c.push(Vs(d,Qd,!0),"@"),c.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&c.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&c.push("/"),c.push(Vs(p,p.charAt(0)=="/"?jI:qI,!0))),(p=this.i.toString())&&c.push("?",p),(p=this.m)&&c.push("#",Vs(p,GI)),c.join("")};function Cn(c){return new kr(c)}function la(c,d,p){c.j=p?xs(d,!0):d,c.j&&(c.j=c.j.replace(/:$/,""))}function ua(c,d){if(d){if(d=Number(d),isNaN(d)||0>d)throw Error("Bad port number "+d);c.s=d}else c.s=null}function Hd(c,d,p){d instanceof Ns?(c.i=d,zI(c.i,c.h)):(p||(d=Vs(d,$I)),c.i=new Ns(d,c.h))}function je(c,d,p){c.i.set(d,p)}function ha(c){return je(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function xs(c,d){return c?d?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Vs(c,d,p){return typeof c=="string"?(c=encodeURI(c).replace(d,UI),p&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function UI(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Qd=/[#\/\?@]/g,qI=/[#\?:]/g,jI=/[#\?]/g,$I=/[#\?@]/g,GI=/#/g;function Ns(c,d){this.h=this.g=null,this.i=c||null,this.j=!!d}function Wn(c){c.g||(c.g=new Map,c.h=0,c.i&&BI(c.i,function(d,p){c.add(decodeURIComponent(d.replace(/\+/g," ")),p)}))}n=Ns.prototype,n.add=function(c,d){Wn(this),this.i=null,c=Ai(this,c);var p=this.g.get(c);return p||this.g.set(c,p=[]),p.push(d),this.h+=1,this};function Wd(c,d){Wn(c),d=Ai(c,d),c.g.has(d)&&(c.i=null,c.h-=c.g.get(d).length,c.g.delete(d))}function Yd(c,d){return Wn(c),d=Ai(c,d),c.g.has(d)}n.forEach=function(c,d){Wn(this),this.g.forEach(function(p,g){p.forEach(function(C){c.call(d,C,g,this)},this)},this)},n.na=function(){Wn(this);const c=Array.from(this.g.values()),d=Array.from(this.g.keys()),p=[];for(let g=0;g<d.length;g++){const C=c[g];for(let k=0;k<C.length;k++)p.push(d[g])}return p},n.V=function(c){Wn(this);let d=[];if(typeof c=="string")Yd(this,c)&&(d=d.concat(this.g.get(Ai(this,c))));else{c=Array.from(this.g.values());for(let p=0;p<c.length;p++)d=d.concat(c[p])}return d},n.set=function(c,d){return Wn(this),this.i=null,c=Ai(this,c),Yd(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[d]),this.h+=1,this},n.get=function(c,d){return c?(c=this.V(c),0<c.length?String(c[0]):d):d};function Jd(c,d,p){Wd(c,d),0<p.length&&(c.i=null,c.g.set(Ai(c,d),x(p)),c.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],d=Array.from(this.g.keys());for(var p=0;p<d.length;p++){var g=d[p];const k=encodeURIComponent(String(g)),W=this.V(g);for(g=0;g<W.length;g++){var C=k;W[g]!==""&&(C+="="+encodeURIComponent(String(W[g]))),c.push(C)}}return this.i=c.join("&")};function Ai(c,d){return d=String(d),c.j&&(d=d.toLowerCase()),d}function zI(c,d){d&&!c.j&&(Wn(c),c.i=null,c.g.forEach(function(p,g){var C=g.toLowerCase();g!=C&&(Wd(this,g),Jd(this,C,p))},c)),c.j=d}function KI(c,d){const p=new Cs;if(a.Image){const g=new Image;g.onload=_(Yn,p,"TestLoadImage: loaded",!0,d,g),g.onerror=_(Yn,p,"TestLoadImage: error",!1,d,g),g.onabort=_(Yn,p,"TestLoadImage: abort",!1,d,g),g.ontimeout=_(Yn,p,"TestLoadImage: timeout",!1,d,g),a.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=c}else d(!1)}function HI(c,d){const p=new Cs,g=new AbortController,C=setTimeout(()=>{g.abort(),Yn(p,"TestPingServer: timeout",!1,d)},1e4);fetch(c,{signal:g.signal}).then(k=>{clearTimeout(C),k.ok?Yn(p,"TestPingServer: ok",!0,d):Yn(p,"TestPingServer: server error",!1,d)}).catch(()=>{clearTimeout(C),Yn(p,"TestPingServer: error",!1,d)})}function Yn(c,d,p,g,C){try{C&&(C.onload=null,C.onerror=null,C.onabort=null,C.ontimeout=null),g(p)}catch{}}function QI(){this.g=new nn}function WI(c,d,p){const g=p||"";try{zd(c,function(C,k){let W=C;u(C)&&(W=Ti(C)),d.push(g+k+"="+encodeURIComponent(W))})}catch(C){throw d.push(g+"type="+encodeURIComponent("_badmap")),C}}function Os(c){this.l=c.Ub||null,this.j=c.eb||!1}R(Os,wi),Os.prototype.g=function(){return new da(this.l,this.j)},Os.prototype.i=function(c){return function(){return c}}({});function da(c,d){ie.call(this),this.D=c,this.o=d,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(da,ie),n=da.prototype,n.open=function(c,d){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=d,this.readyState=1,Ms(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const d={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(d.body=c),(this.D||a).fetch(new Request(this.A,d)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ks(this)),this.readyState=0},n.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Ms(this)),this.g&&(this.readyState=3,Ms(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Xd(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function Xd(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}n.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var d=c.value?c.value:new Uint8Array(0);(d=this.v.decode(d,{stream:!c.done}))&&(this.response=this.responseText+=d)}c.done?ks(this):Ms(this),this.readyState==3&&Xd(this)}},n.Ra=function(c){this.g&&(this.response=this.responseText=c,ks(this))},n.Qa=function(c){this.g&&(this.response=c,ks(this))},n.ga=function(){this.g&&ks(this)};function ks(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Ms(c)}n.setRequestHeader=function(c,d){this.u.append(c,d)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],d=this.h.entries();for(var p=d.next();!p.done;)p=p.value,c.push(p[0]+": "+p[1]),p=d.next();return c.join(`\r
`)};function Ms(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(da.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Zd(c){let d="";return oe(c,function(p,g){d+=g,d+=":",d+=p,d+=`\r
`}),d}function _l(c,d,p){e:{for(g in p){var g=!1;break e}g=!0}g||(p=Zd(p),typeof c=="string"?p!=null&&encodeURIComponent(String(p)):je(c,d,p))}function Xe(c){ie.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(Xe,ie);var YI=/^https?$/i,JI=["POST","PUT"];n=Xe.prototype,n.Ha=function(c){this.J=c},n.ea=function(c,d,p,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);d=d?d.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ul.g(),this.v=this.o?Pd(this.o):Pd(ul),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(d,String(c),!0),this.B=!1}catch(k){ef(this,k);return}if(c=p||"",p=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var C in g)p.set(C,g[C]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(const k of g.keys())p.set(k,g.get(k));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(p.keys()).find(k=>k.toLowerCase()=="content-type"),C=a.FormData&&c instanceof a.FormData,!(0<=Array.prototype.indexOf.call(JI,d,void 0))||g||C||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[k,W]of p)this.g.setRequestHeader(k,W);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{rf(this),this.u=!0,this.g.send(c),this.u=!1}catch(k){ef(this,k)}};function ef(c,d){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=d,c.m=5,tf(c),fa(c)}function tf(c){c.A||(c.A=!0,de(c,"complete"),de(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,de(this,"complete"),de(this,"abort"),fa(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),fa(this,!0)),Xe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?nf(this):this.bb())},n.bb=function(){nf(this)};function nf(c){if(c.h&&typeof o<"u"&&(!c.v[1]||Dn(c)!=4||c.Z()!=2)){if(c.u&&Dn(c)==4)Ae(c.Ea,0,c);else if(de(c,"readystatechange"),Dn(c)==4){c.h=!1;try{const W=c.Z();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var d=!0;break e;default:d=!1}var p;if(!(p=d)){var g;if(g=W===0){var C=String(c.D).match(Kd)[1]||null;!C&&a.self&&a.self.location&&(C=a.self.location.protocol.slice(0,-1)),g=!YI.test(C?C.toLowerCase():"")}p=g}if(p)de(c,"complete"),de(c,"success");else{c.m=6;try{var k=2<Dn(c)?c.g.statusText:""}catch{k=""}c.l=k+" ["+c.Z()+"]",tf(c)}}finally{fa(c)}}}}function fa(c,d){if(c.g){rf(c);const p=c.g,g=c.v[0]?()=>{}:null;c.g=null,c.v=null,d||de(c,"ready");try{p.onreadystatechange=g}catch{}}}function rf(c){c.I&&(a.clearTimeout(c.I),c.I=null)}n.isActive=function(){return!!this.g};function Dn(c){return c.g?c.g.readyState:0}n.Z=function(){try{return 2<Dn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(c){if(this.g){var d=this.g.responseText;return c&&d.indexOf(c)==0&&(d=d.substring(c.length)),xt(d)}};function sf(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function XI(c){const d={};c=(c.g&&2<=Dn(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<c.length;g++){if(U(c[g]))continue;var p=S(c[g]);const C=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const k=d[C]||[];d[C]=k,k.push(p)}A(d,function(g){return g.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ls(c,d,p){return p&&p.internalChannelParams&&p.internalChannelParams[c]||d}function of(c){this.Aa=0,this.i=[],this.j=new Cs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ls("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ls("baseRetryDelayMs",5e3,c),this.cb=Ls("retryDelaySeedMs",1e4,c),this.Wa=Ls("forwardChannelMaxRetries",2,c),this.wa=Ls("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Ud(c&&c.concurrentRequestLimit),this.Da=new QI,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=of.prototype,n.la=8,n.G=1,n.connect=function(c,d,p,g){Vt(0),this.W=c,this.H=d||{},p&&g!==void 0&&(this.H.OSID=p,this.H.OAID=g),this.F=this.X,this.I=mf(this,null,this.W),ma(this)};function yl(c){if(af(c),c.G==3){var d=c.U++,p=Cn(c.I);if(je(p,"SID",c.K),je(p,"RID",d),je(p,"TYPE","terminate"),Fs(c,p),d=new Qn(c,c.j,d),d.L=2,d.v=ha(Cn(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(d.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=d.v,p=!0),p||(d.g=gf(d.j,null),d.g.ea(d.v)),d.F=Date.now(),ca(d)}pf(c)}function pa(c){c.g&&(Il(c),c.g.cancel(),c.g=null)}function af(c){pa(c),c.u&&(a.clearTimeout(c.u),c.u=null),ga(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&a.clearTimeout(c.s),c.s=null)}function ma(c){if(!qd(c.h)&&!c.s){c.s=!0;var d=c.Ga;Ee||ln(),ge||(Ee(),ge=!0),Qt.add(d,c),c.B=0}}function ZI(c,d){return jd(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=d.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=Ps(m(c.Ga,c,d),ff(c,c.B)),c.B++,!0)}n.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const C=new Qn(this,this.j,c);let k=this.o;if(this.S&&(k?(k=v(k),b(k,this.S)):k=this.S),this.m!==null||this.O||(C.H=k,k=null),this.P)e:{for(var d=0,p=0;p<this.i.length;p++){t:{var g=this.i[p];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(d+=g,4096<d){d=p;break e}if(d===4096||p===this.i.length-1){d=p+1;break e}}d=1e3}else d=1e3;d=lf(this,C,d),p=Cn(this.I),je(p,"RID",c),je(p,"CVER",22),this.D&&je(p,"X-HTTP-Session-Id",this.D),Fs(this,p),k&&(this.O?d="headers="+encodeURIComponent(String(Zd(k)))+"&"+d:this.m&&_l(p,this.m,k)),gl(this.h,C),this.Ua&&je(p,"TYPE","init"),this.P?(je(p,"$req",d),je(p,"SID","null"),C.T=!0,dl(C,p,null)):dl(C,p,d),this.G=2}}else this.G==3&&(c?cf(this,c):this.i.length==0||qd(this.h)||cf(this))};function cf(c,d){var p;d?p=d.l:p=c.U++;const g=Cn(c.I);je(g,"SID",c.K),je(g,"RID",p),je(g,"AID",c.T),Fs(c,g),c.m&&c.o&&_l(g,c.m,c.o),p=new Qn(c,c.j,p,c.B+1),c.m===null&&(p.H=c.o),d&&(c.i=d.D.concat(c.i)),d=lf(c,p,1e3),p.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),gl(c.h,p),dl(p,g,d)}function Fs(c,d){c.H&&oe(c.H,function(p,g){je(d,g,p)}),c.l&&zd({},function(p,g){je(d,g,p)})}function lf(c,d,p){p=Math.min(c.i.length,p);var g=c.l?m(c.l.Na,c.l,c):null;e:{var C=c.i;let k=-1;for(;;){const W=["count="+p];k==-1?0<p?(k=C[0].g,W.push("ofs="+k)):k=0:W.push("ofs="+k);let Me=!0;for(let _t=0;_t<p;_t++){let Se=C[_t].g;const wt=C[_t].map;if(Se-=k,0>Se)k=Math.max(0,C[_t].g-100),Me=!1;else try{WI(wt,W,"req"+Se+"_")}catch{g&&g(wt)}}if(Me){g=W.join("&");break e}}}return c=c.i.splice(0,p),d.D=c,g}function uf(c){if(!c.g&&!c.u){c.Y=1;var d=c.Fa;Ee||ln(),ge||(Ee(),ge=!0),Qt.add(d,c),c.v=0}}function vl(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=Ps(m(c.Fa,c),ff(c,c.v)),c.v++,!0)}n.Fa=function(){if(this.u=null,hf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=Ps(m(this.ab,this),c)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Vt(10),pa(this),hf(this))};function Il(c){c.A!=null&&(a.clearTimeout(c.A),c.A=null)}function hf(c){c.g=new Qn(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var d=Cn(c.qa);je(d,"RID","rpc"),je(d,"SID",c.K),je(d,"AID",c.T),je(d,"CI",c.F?"0":"1"),!c.F&&c.ja&&je(d,"TO",c.ja),je(d,"TYPE","xmlhttp"),Fs(c,d),c.m&&c.o&&_l(d,c.m,c.o),c.L&&(c.g.I=c.L);var p=c.g;c=c.ia,p.L=1,p.v=ha(Cn(d)),p.m=null,p.P=!0,Ld(p,c)}n.Za=function(){this.C!=null&&(this.C=null,pa(this),vl(this),Vt(19))};function ga(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function df(c,d){var p=null;if(c.g==d){ga(c),Il(c),c.g=null;var g=2}else if(ml(c.h,d))p=d.D,$d(c.h,d),g=1;else return;if(c.G!=0){if(d.o)if(g==1){p=d.m?d.m.length:0,d=Date.now()-d.F;var C=c.B;g=sa(),de(g,new Nd(g,p)),ma(c)}else uf(c);else if(C=d.s,C==3||C==0&&0<d.X||!(g==1&&ZI(c,d)||g==2&&vl(c)))switch(p&&0<p.length&&(d=c.h,d.i=d.i.concat(p)),C){case 1:Mr(c,5);break;case 4:Mr(c,10);break;case 3:Mr(c,6);break;default:Mr(c,2)}}}function ff(c,d){let p=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(p*=2),p*d}function Mr(c,d){if(c.j.info("Error code "+d),d==2){var p=m(c.fb,c),g=c.Xa;const C=!g;g=new kr(g||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||la(g,"https"),ha(g),C?KI(g.toString(),p):HI(g.toString(),p)}else Vt(2);c.G=0,c.l&&c.l.sa(d),pf(c),af(c)}n.fb=function(c){c?(this.j.info("Successfully pinged google.com"),Vt(2)):(this.j.info("Failed to ping google.com"),Vt(1))};function pf(c){if(c.G=0,c.ka=[],c.l){const d=Gd(c.h);(d.length!=0||c.i.length!=0)&&(N(c.ka,d),N(c.ka,c.i),c.h.i.length=0,x(c.i),c.i.length=0),c.l.ra()}}function mf(c,d,p){var g=p instanceof kr?Cn(p):new kr(p);if(g.g!="")d&&(g.g=d+"."+g.g),ua(g,g.s);else{var C=a.location;g=C.protocol,d=d?d+"."+C.hostname:C.hostname,C=+C.port;var k=new kr(null);g&&la(k,g),d&&(k.g=d),C&&ua(k,C),p&&(k.l=p),g=k}return p=c.D,d=c.ya,p&&d&&je(g,p,d),je(g,"VER",c.la),Fs(c,g),g}function gf(c,d,p){if(d&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return d=c.Ca&&!c.pa?new Xe(new Os({eb:p})):new Xe(c.pa),d.Ha(c.J),d}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function _f(){}n=_f.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function _a(){}_a.prototype.g=function(c,d){return new Wt(c,d)};function Wt(c,d){ie.call(this),this.g=new of(d),this.l=c,this.h=d&&d.messageUrlParams||null,c=d&&d.messageHeaders||null,d&&d.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=d&&d.initMessageHeaders||null,d&&d.messageContentType&&(c?c["X-WebChannel-Content-Type"]=d.messageContentType:c={"X-WebChannel-Content-Type":d.messageContentType}),d&&d.va&&(c?c["X-WebChannel-Client-Profile"]=d.va:c={"X-WebChannel-Client-Profile":d.va}),this.g.S=c,(c=d&&d.Sb)&&!U(c)&&(this.g.m=c),this.v=d&&d.supportsCrossDomainXhr||!1,this.u=d&&d.sendRawJson||!1,(d=d&&d.httpSessionIdParam)&&!U(d)&&(this.g.D=d,c=this.h,c!==null&&d in c&&(c=this.h,d in c&&delete c[d])),this.j=new Si(this)}R(Wt,ie),Wt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Wt.prototype.close=function(){yl(this.g)},Wt.prototype.o=function(c){var d=this.g;if(typeof c=="string"){var p={};p.__data__=c,c=p}else this.u&&(p={},p.__data__=Ti(c),c=p);d.i.push(new MI(d.Ya++,c)),d.G==3&&ma(d)},Wt.prototype.N=function(){this.g.l=null,delete this.j,yl(this.g),delete this.g,Wt.aa.N.call(this)};function yf(c){cl.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var d=c.__sm__;if(d){e:{for(const p in d){c=p;break e}c=void 0}(this.i=c)&&(c=this.i,d=d!==null&&c in d?d[c]:void 0),this.data=d}else this.data=c}R(yf,cl);function vf(){ll.call(this),this.status=1}R(vf,ll);function Si(c){this.g=c}R(Si,_f),Si.prototype.ua=function(){de(this.g,"a")},Si.prototype.ta=function(c){de(this.g,new yf(c))},Si.prototype.sa=function(c){de(this.g,new vf)},Si.prototype.ra=function(){de(this.g,"b")},_a.prototype.createWebChannel=_a.prototype.g,Wt.prototype.send=Wt.prototype.o,Wt.prototype.open=Wt.prototype.m,Wt.prototype.close=Wt.prototype.close,Y_=function(){return new _a},W_=function(){return sa()},Q_=Nr,du={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},oa.NO_ERROR=0,oa.TIMEOUT=8,oa.HTTP_ERROR=6,La=oa,Od.COMPLETE="complete",H_=Od,Cd.EventType=Ss,Ss.OPEN="a",Ss.CLOSE="b",Ss.ERROR="c",Ss.MESSAGE="d",ie.prototype.listen=ie.prototype.K,Ws=Cd,K_=Os,Xe.prototype.listenOnce=Xe.prototype.L,Xe.prototype.getLastError=Xe.prototype.Ka,Xe.prototype.getLastErrorCode=Xe.prototype.Ba,Xe.prototype.getStatus=Xe.prototype.Z,Xe.prototype.getResponseJson=Xe.prototype.Oa,Xe.prototype.getResponseText=Xe.prototype.oa,Xe.prototype.send=Xe.prototype.ea,Xe.prototype.setWithCredentials=Xe.prototype.Ha,z_=Xe}).apply(typeof Ra<"u"?Ra:typeof self<"u"?self:typeof window<"u"?window:{});const Ep="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ht.UNAUTHENTICATED=new ht(null),ht.GOOGLE_CREDENTIALS=new ht("google-credentials-uid"),ht.FIRST_PARTY=new ht("first-party-uid"),ht.MOCK_USER=new ht("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ys="10.13.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yr=new _h("@firebase/firestore");function Mi(){return yr.logLevel}function e0(n){yr.setLogLevel(n)}function q(n,...e){if(yr.logLevel<=ve.DEBUG){const t=e.map(Th);yr.debug(`Firestore (${ys}): ${n}`,...t)}}function tt(n,...e){if(yr.logLevel<=ve.ERROR){const t=e.map(Th);yr.error(`Firestore (${ys}): ${n}`,...t)}}function pn(n,...e){if(yr.logLevel<=ve.WARN){const t=e.map(Th);yr.warn(`Firestore (${ys}): ${n}`,...t)}}function Th(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ne(n="Unexpected state"){const e=`FIRESTORE (${ys}) INTERNAL ASSERTION FAILED: `+n;throw tt(e),new Error(e)}function ae(n,e){n||ne()}function t0(n,e){n||ne()}function J(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class B extends gi{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class n0{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ht.UNAUTHENTICATED))}shutdown(){}}class r0{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class i0{constructor(e){this.t=e,this.currentUser=ht.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let s=new ft;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ft,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(q("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ft)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ae(typeof r.accessToken=="string"),new J_(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ae(e===null||typeof e=="string"),new ht(e)}}class s0{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=ht.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class o0{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new s0(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(ht.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class a0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class c0{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const r=s=>{s.error!=null&&q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,q("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ae(typeof t.token=="string"),this.R=t.token,new a0(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l0(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=l0(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function fe(n,e){return n<e?-1:n>e?1:0}function ns(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function Z_(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new B(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new B(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new B(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new B(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return He.fromMillis(Date.now())}static fromDate(e){return He.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new He(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?fe(this.nanoseconds,e.nanoseconds):fe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.timestamp=e}static fromTimestamp(e){return new le(e)}static min(){return new le(new He(0,0))}static max(){return new le(new He(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{constructor(e,t,r){t===void 0?t=0:t>e.length&&ne(),r===void 0?r=e.length-t:r>e.length-t&&ne(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ao.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ao?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class _e extends Ao{construct(e,t,r){return new _e(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new B(O.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new _e(t)}static emptyPath(){return new _e([])}}const u0=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ze extends Ao{construct(e,t,r){return new ze(e,t,r)}static isValidIdentifier(e){return u0.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ze.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ze(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new B(O.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new B(O.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new B(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new B(O.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ze(t)}static emptyPath(){return new ze([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.path=e}static fromPath(e){return new Y(_e.fromString(e))}static fromName(e){return new Y(_e.fromString(e).popFirst(5))}static empty(){return new Y(_e.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&_e.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return _e.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Y(new _e(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function fu(n){return n.fields.find(e=>e.kind===2)}function Gr(n){return n.fields.filter(e=>e.kind!==2)}oc.UNKNOWN_ID=-1;class Fa{constructor(e,t){this.fieldPath=e,this.kind=t}}class So{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new So(0,en.min())}}function ey(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=le.fromTimestamp(r===1e9?new He(t+1,0):new He(t,r));return new en(i,Y.empty(),e)}function ty(n){return new en(n.readTime,n.key,-1)}class en{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new en(le.min(),Y.empty(),-1)}static max(){return new en(le.max(),Y.empty(),-1)}}function wh(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Y.comparator(n.documentKey,e.documentKey),t!==0?t:fe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ny="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ry{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cr(n){if(n.code!==O.FAILED_PRECONDITION||n.message!==ny)throw n;q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ne(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new D((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof D?t:D.resolve(t)}catch(t){return D.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):D.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):D.reject(t)}static resolve(e){return new D((t,r)=>{t(e)})}static reject(e){return new D((t,r)=>{r(e)})}static waitFor(e){return new D((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},l=>r(l))}),o=!0,s===i&&t()})}static or(e){let t=D.resolve(!1);for(const r of e)t=t.next(i=>i?D.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new D((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;t(e[u]).next(h=>{o[u]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,t){return new D((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new ft,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new io(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=bh(r.target.error);this.V.reject(new io(e,i))}}static open(e,t,r,i){try{return new Fc(t,e.transaction(i,r))}catch(s){throw new io(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(q("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new d0(t)}}class bn{constructor(e,t,r){this.name=e,this.version=t,this.p=r,bn.S(ic())===12.2&&tt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return q("SimpleDb","Removing database:",e),Hr(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!D_())return!1;if(bn.v())return!0;const e=ic(),t=bn.S(e),r=0<t&&t<10,i=iy(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(q("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;t(o)},i.onblocked=()=>{r(new io(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new B(O.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new B(O.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new io(e,o))},i.onupgradeneeded=s=>{q("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{q("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=Fc.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(u=>(a.g(),u)).catch(u=>(a.abort(u),D.reject(u))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,u=l.name!=="FirebaseError"&&o<3;if(q("SimpleDb","Transaction failed with error:",l.message,"Retrying:",u),this.close(),!u)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function iy(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class h0{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Hr(this.B.delete())}}class io extends B{constructor(e,t){super(O.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Dr(n){return n.name==="IndexedDbTransactionError"}class d0{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(q("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(q("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Hr(r)}add(e){return q("SimpleDb","ADD",this.store.name,e,e),Hr(this.store.add(e))}get(e){return Hr(this.store.get(e)).next(t=>(t===void 0&&(t=null),q("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return q("SimpleDb","DELETE",this.store.name,e),Hr(this.store.delete(e))}count(){return q("SimpleDb","COUNT",this.store.name),Hr(this.store.count())}U(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new D((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.W(s,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new D((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){q("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.W(i,t)}Y(e){const t=this.cursor({});return new D((r,i)=>{t.onerror=s=>{const o=bh(s.target.error);i(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){const r=[];return new D((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new h0(a),u=t(a.primaryKey,a.value,l);if(u instanceof D){const h=u.catch(f=>(l.done(),D.reject(f)));r.push(h)}l.isDone?i():l.K===null?a.continue():a.continue(l.K)}}).next(()=>D.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Hr(n){return new D((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=bh(r.target.error);t(i)}})}let Tp=!1;function bh(n){const e=bn.S(ic());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new B("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Tp||(Tp=!0,setTimeout(()=>{throw r},0)),r}}return n}class f0{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){q("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{q("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){Dr(t)?q("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await Cr(t)}await this.X(6e4)})}}class p0{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let i=t,s=!0;return D.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return q("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(q("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{const o=ty(s);wh(o,r)>0&&(r=o)}),new en(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Gt.oe=-1;function Ko(n){return n==null}function Ro(n){return n===0&&1/n==-1/0}function sy(n){return typeof n=="number"&&Number.isInteger(n)&&!Ro(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=wp(e)),e=m0(n.get(t),e);return wp(e)}function m0(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function wp(n){return n+""}function En(n){const e=n.length;if(ae(e>=2),e===2)return ae(n.charAt(0)===""&&n.charAt(1)===""),_e.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const o=n.indexOf("",s);switch((o<0||o>t)&&ne(),n.charAt(o+1)){case"":const a=n.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:ne()}s=o+2}return new _e(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bp=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ba(n,e){return[n,Lt(e)]}function oy(n,e,t){return[n,Lt(e),t]}const g0={},_0=["prefixPath","collectionGroup","readTime","documentId"],y0=["prefixPath","collectionGroup","documentId"],v0=["collectionGroup","readTime","prefixPath","documentId"],I0=["canonicalId","targetId"],E0=["targetId","path"],T0=["path","targetId"],w0=["collectionId","parent"],b0=["indexId","uid"],A0=["uid","sequenceNumber"],S0=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],R0=["indexId","uid","orderedDocumentKey"],P0=["userId","collectionPath","documentId"],C0=["userId","collectionPath","largestBatchId"],D0=["userId","collectionGroup","largestBatchId"],ay=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],x0=[...ay,"documentOverlays"],cy=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],ly=cy,Ah=[...ly,"indexConfiguration","indexState","indexEntries"],V0=Ah,N0=[...Ah,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu extends ry{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function ct(n,e){const t=J(n);return bn.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ap(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function _i(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function uy(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e,t){this.comparator=e,this.root=t||yt.EMPTY}insert(e,t){return new qe(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,yt.BLACK,null,null))}remove(e){return new qe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,yt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Pa(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Pa(this.root,e,this.comparator,!1)}getReverseIterator(){return new Pa(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Pa(this.root,e,this.comparator,!0)}}class Pa{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class yt{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??yt.RED,this.left=i??yt.EMPTY,this.right=s??yt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new yt(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return yt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return yt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,yt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,yt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ne();const e=this.left.check();if(e!==this.right.check())throw ne();return e+(this.isRed()?0:1)}}yt.EMPTY=null,yt.RED=!0,yt.BLACK=!1;yt.EMPTY=new class{constructor(){this.size=0}get key(){throw ne()}get value(){throw ne()}get color(){throw ne()}get left(){throw ne()}get right(){throw ne()}copy(e,t,r,i,s){return this}insert(e,t,r){return new yt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(e){this.comparator=e,this.data=new qe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Sp(this.data.getIterator())}getIteratorFrom(e){return new Sp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Oe)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Oe(this.comparator);return t.data=e,t}}class Sp{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function xi(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.fields=e,e.sort(ze.comparator)}static empty(){return new zt([])}unionWith(e){let t=new Oe(ze.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new zt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ns(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O0(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new hy("Invalid base64 string: "+s):s}}(e);return new Ze(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Ze(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return fe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ze.EMPTY_BYTE_STRING=new Ze("");const k0=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Un(n){if(ae(!!n),typeof n=="string"){let e=0;const t=k0.exec(n);if(ae(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ge(n.seconds),nanos:Ge(n.nanos)}}function Ge(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function vr(n){return typeof n=="string"?Ze.fromBase64String(n):Ze.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bc(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Sh(n){const e=n.mapValue.fields.__previous_value__;return Bc(e)?Sh(e):e}function Po(n){const e=Un(n.mapValue.fields.__local_write_time__.timestampValue);return new He(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(e,t,r,i,s,o,a,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}class Ir{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Ir("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ir&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ua={nullValue:"NULL_VALUE"};function si(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Bc(n)?4:dy(n)?9007199254740991:Uc(n)?10:11:ne()}function Rn(n,e){if(n===e)return!0;const t=si(n);if(t!==si(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Po(n).isEqual(Po(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Un(i.timestampValue),a=Un(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return vr(i.bytesValue).isEqual(vr(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Ge(i.geoPointValue.latitude)===Ge(s.geoPointValue.latitude)&&Ge(i.geoPointValue.longitude)===Ge(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ge(i.integerValue)===Ge(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Ge(i.doubleValue),a=Ge(s.doubleValue);return o===a?Ro(o)===Ro(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return ns(n.arrayValue.values||[],e.arrayValue.values||[],Rn);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(Ap(o)!==Ap(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Rn(o[l],a[l])))return!1;return!0}(n,e);default:return ne()}}function Co(n,e){return(n.values||[]).find(t=>Rn(t,e))!==void 0}function Er(n,e){if(n===e)return 0;const t=si(n),r=si(e);if(t!==r)return fe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return fe(n.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Ge(s.integerValue||s.doubleValue),l=Ge(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return Rp(n.timestampValue,e.timestampValue);case 4:return Rp(Po(n),Po(e));case 5:return fe(n.stringValue,e.stringValue);case 6:return function(s,o){const a=vr(s),l=vr(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const h=fe(a[u],l[u]);if(h!==0)return h}return fe(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const a=fe(Ge(s.latitude),Ge(o.latitude));return a!==0?a:fe(Ge(s.longitude),Ge(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Pp(n.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,u,h;const f=s.fields||{},m=o.fields||{},_=(a=f.value)===null||a===void 0?void 0:a.arrayValue,R=(l=m.value)===null||l===void 0?void 0:l.arrayValue,x=fe(((u=_==null?void 0:_.values)===null||u===void 0?void 0:u.length)||0,((h=R==null?void 0:R.values)===null||h===void 0?void 0:h.length)||0);return x!==0?x:Pp(_,R)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===hr.mapValue&&o===hr.mapValue)return 0;if(s===hr.mapValue)return 1;if(o===hr.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},h=Object.keys(u);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const m=fe(l[f],h[f]);if(m!==0)return m;const _=Er(a[l[f]],u[h[f]]);if(_!==0)return _}return fe(l.length,h.length)}(n.mapValue,e.mapValue);default:throw ne()}}function Rp(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return fe(n,e);const t=Un(n),r=Un(e),i=fe(t.seconds,r.seconds);return i!==0?i:fe(t.nanos,r.nanos)}function Pp(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=Er(t[i],r[i]);if(s)return s}return fe(t.length,r.length)}function rs(n){return mu(n)}function mu(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Un(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return vr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Y.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=mu(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${mu(t.fields[o])}`;return i+"}"}(n.mapValue):ne()}function oi(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function gu(n){return!!n&&"integerValue"in n}function Do(n){return!!n&&"arrayValue"in n}function Cp(n){return!!n&&"nullValue"in n}function Dp(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function qa(n){return!!n&&"mapValue"in n}function Uc(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function so(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return _i(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=so(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=so(n.arrayValue.values[t]);return e}return Object.assign({},n)}function dy(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const fy={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function L0(n){return"nullValue"in n?Ua:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?oi(Ir.empty(),Y.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Uc(n)?fy:{mapValue:{}}:ne()}function F0(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?oi(Ir.empty(),Y.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?fy:"mapValue"in n?Uc(n)?{mapValue:{}}:hr:ne()}function xp(n,e){const t=Er(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Vp(n,e){const t=Er(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.value=e}static empty(){return new It({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!qa(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=so(t)}setAll(e){let t=ze.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=so(o):i.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());qa(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Rn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];qa(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){_i(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new It(so(this.value))}}function py(n){const e=[];return _i(n.fields,(t,r)=>{const i=new ze([t]);if(qa(r)){const s=py(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new zt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new $e(e,0,le.min(),le.min(),le.min(),It.empty(),0)}static newFoundDocument(e,t,r,i){return new $e(e,1,t,le.min(),r,i,0)}static newNoDocument(e,t){return new $e(e,2,t,le.min(),le.min(),It.empty(),0)}static newUnknownDocument(e,t){return new $e(e,3,t,le.min(),le.min(),It.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(le.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=It.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=It.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=le.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof $e&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new $e(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e,t){this.position=e,this.inclusive=t}}function Np(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(s.field.isKeyField()?r=Y.comparator(Y.fromName(o.referenceValue),t.key):r=Er(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Op(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Rn(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{constructor(e,t="asc"){this.field=e,this.dir=t}}function B0(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class my{}class ye extends my{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new U0(e,t,r):t==="array-contains"?new $0(e,r):t==="in"?new Ey(e,r):t==="not-in"?new G0(e,r):t==="array-contains-any"?new z0(e,r):new ye(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new q0(e,r):new j0(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Er(t,this.value)):t!==null&&si(this.value)===si(t)&&this.matchesComparison(Er(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ne()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ve extends my{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Ve(e,t)}matches(e){return is(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function is(n){return n.op==="and"}function _u(n){return n.op==="or"}function Rh(n){return gy(n)&&is(n)}function gy(n){for(const e of n.filters)if(e instanceof Ve)return!1;return!0}function yu(n){if(n instanceof ye)return n.field.canonicalString()+n.op.toString()+rs(n.value);if(Rh(n))return n.filters.map(e=>yu(e)).join(",");{const e=n.filters.map(t=>yu(t)).join(",");return`${n.op}(${e})`}}function _y(n,e){return n instanceof ye?function(r,i){return i instanceof ye&&r.op===i.op&&r.field.isEqual(i.field)&&Rn(r.value,i.value)}(n,e):n instanceof Ve?function(r,i){return i instanceof Ve&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&_y(o,i.filters[a]),!0):!1}(n,e):void ne()}function yy(n,e){const t=n.filters.concat(e);return Ve.create(t,n.op)}function vy(n){return n instanceof ye?function(t){return`${t.field.canonicalString()} ${t.op} ${rs(t.value)}`}(n):n instanceof Ve?function(t){return t.op.toString()+" {"+t.getFilters().map(vy).join(" ,")+"}"}(n):"Filter"}class U0 extends ye{constructor(e,t,r){super(e,t,r),this.key=Y.fromName(r.referenceValue)}matches(e){const t=Y.comparator(e.key,this.key);return this.matchesComparison(t)}}class q0 extends ye{constructor(e,t){super(e,"in",t),this.keys=Iy("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class j0 extends ye{constructor(e,t){super(e,"not-in",t),this.keys=Iy("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Iy(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>Y.fromName(r.referenceValue))}class $0 extends ye{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Do(t)&&Co(t.arrayValue,this.value)}}class Ey extends ye{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Co(this.value.arrayValue,t)}}class G0 extends ye{constructor(e,t){super(e,"not-in",t)}matches(e){if(Co(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Co(this.value.arrayValue,t)}}class z0 extends ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Do(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Co(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function vu(n,e=null,t=[],r=[],i=null,s=null,o=null){return new K0(n,e,t,r,i,s,o)}function ai(n){const e=J(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>yu(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Ko(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>rs(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>rs(r)).join(",")),e.ue=t}return e.ue}function Ho(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!B0(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!_y(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Op(n.startAt,e.startAt)&&Op(n.endAt,e.endAt)}function ac(n){return Y.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function cc(n,e){return n.filters.filter(t=>t instanceof ye&&t.field.isEqual(e))}function kp(n,e,t){let r=Ua,i=!0;for(const s of cc(n,e)){let o=Ua,a=!0;switch(s.op){case"<":case"<=":o=L0(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Ua}xp({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];xp({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function Mp(n,e,t){let r=hr,i=!0;for(const s of cc(n,e)){let o=hr,a=!0;switch(s.op){case">=":case">":o=F0(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=hr}Vp({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];Vp({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Ty(n,e,t,r,i,s,o,a){return new $n(n,e,t,r,i,s,o,a)}function vs(n){return new $n(n)}function Lp(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Ph(n){return n.collectionGroup!==null}function Ji(n){const e=J(n);if(e.ce===null){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Oe(ze.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new xo(s,r))}),t.has(ze.keyField().canonicalString())||e.ce.push(new xo(ze.keyField(),r))}return e.ce}function Ft(n){const e=J(n);return e.le||(e.le=H0(e,Ji(n))),e.le}function H0(n,e){if(n.limitType==="F")return vu(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new xo(i.field,s)});const t=n.endAt?new Tr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Tr(n.startAt.position,n.startAt.inclusive):null;return vu(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Iu(n,e){const t=n.filters.concat([e]);return new $n(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function lc(n,e,t){return new $n(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Qo(n,e){return Ho(Ft(n),Ft(e))&&n.limitType===e.limitType}function wy(n){return`${ai(Ft(n))}|lt:${n.limitType}`}function Li(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>vy(i)).join(", ")}]`),Ko(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>rs(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>rs(i)).join(",")),`Target(${r})`}(Ft(n))}; limitType=${n.limitType})`}function Wo(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Y.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of Ji(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=Np(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,Ji(r),i)||r.endAt&&!function(o,a,l){const u=Np(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,Ji(r),i))}(n,e)}function by(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Ay(n){return(e,t)=>{let r=!1;for(const i of Ji(n)){const s=Q0(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Q0(n,e,t){const r=n.field.isKeyField()?Y.comparator(e.key,t.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?Er(l,u):ne()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ne()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){_i(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return uy(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W0=new qe(Y.comparator);function Kt(){return W0}const Sy=new qe(Y.comparator);function Ys(...n){let e=Sy;for(const t of n)e=e.insert(t.key,t);return e}function Ry(n){let e=Sy;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Tn(){return oo()}function Py(){return oo()}function oo(){return new xr(n=>n.toString(),(n,e)=>n.isEqual(e))}const Y0=new qe(Y.comparator),J0=new Oe(Y.comparator);function me(...n){let e=J0;for(const t of n)e=e.add(t);return e}const X0=new Oe(fe);function Ch(){return X0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dh(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ro(e)?"-0":e}}function Cy(n){return{integerValue:""+n}}function Dy(n,e){return sy(e)?Cy(e):Dh(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(){this._=void 0}}function Z0(n,e,t){return n instanceof ss?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Bc(s)&&(s=Sh(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof ci?Vy(n,e):n instanceof li?Ny(n,e):function(i,s){const o=xy(i,s),a=Fp(o)+Fp(i.Pe);return gu(o)&&gu(i.Pe)?Cy(a):Dh(i.serializer,a)}(n,e)}function eS(n,e,t){return n instanceof ci?Vy(n,e):n instanceof li?Ny(n,e):t}function xy(n,e){return n instanceof os?function(r){return gu(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class ss extends qc{}class ci extends qc{constructor(e){super(),this.elements=e}}function Vy(n,e){const t=Oy(e);for(const r of n.elements)t.some(i=>Rn(i,r))||t.push(r);return{arrayValue:{values:t}}}class li extends qc{constructor(e){super(),this.elements=e}}function Ny(n,e){let t=Oy(e);for(const r of n.elements)t=t.filter(i=>!Rn(i,r));return{arrayValue:{values:t}}}class os extends qc{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Fp(n){return Ge(n.integerValue||n.doubleValue)}function Oy(n){return Do(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yo{constructor(e,t){this.field=e,this.transform=t}}function tS(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof ci&&i instanceof ci||r instanceof li&&i instanceof li?ns(r.elements,i.elements,Rn):r instanceof os&&i instanceof os?Rn(r.Pe,i.Pe):r instanceof ss&&i instanceof ss}(n.transform,e.transform)}class nS{constructor(e,t){this.version=e,this.transformResults=t}}class Ke{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ke}static exists(e){return new Ke(void 0,e)}static updateTime(e){return new Ke(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ja(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class jc{}function ky(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Es(n.key,Ke.none()):new Is(n.key,n.data,Ke.none());{const t=n.data,r=It.empty();let i=new Oe(ze.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Gn(n.key,r,new zt(i.toArray()),Ke.none())}}function rS(n,e,t){n instanceof Is?function(i,s,o){const a=i.value.clone(),l=Up(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Gn?function(i,s,o){if(!ja(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=Up(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(My(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function ao(n,e,t,r){return n instanceof Is?function(s,o,a,l){if(!ja(s.precondition,o))return a;const u=s.value.clone(),h=qp(s.fieldTransforms,l,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof Gn?function(s,o,a,l){if(!ja(s.precondition,o))return a;const u=qp(s.fieldTransforms,l,o),h=o.data;return h.setAll(My(s)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(s,o,a){return ja(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function iS(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=xy(r.transform,i||null);s!=null&&(t===null&&(t=It.empty()),t.set(r.field,s))}return t||null}function Bp(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ns(r,i,(s,o)=>tS(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Is extends jc{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Gn extends jc{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function My(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function Up(n,e,t){const r=new Map;ae(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,eS(o,a,t[i]))}return r}function qp(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,Z0(s,o,e))}return r}class Es extends jc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class xh extends jc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&rS(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=ao(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=ao(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Py();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const l=ky(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(le.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),me())}isEqual(e){return this.batchId===e.batchId&&ns(this.mutations,e.mutations,(t,r)=>Bp(t,r))&&ns(this.baseMutations,e.baseMutations,(t,r)=>Bp(t,r))}}class Nh{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ae(e.mutations.length===r.length);let i=function(){return Y0}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Nh(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var it,we;function Ly(n){switch(n){default:return ne();case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0}}function Fy(n){if(n===void 0)return tt("GRPC error has no .code"),O.UNKNOWN;switch(n){case it.OK:return O.OK;case it.CANCELLED:return O.CANCELLED;case it.UNKNOWN:return O.UNKNOWN;case it.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case it.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case it.INTERNAL:return O.INTERNAL;case it.UNAVAILABLE:return O.UNAVAILABLE;case it.UNAUTHENTICATED:return O.UNAUTHENTICATED;case it.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case it.NOT_FOUND:return O.NOT_FOUND;case it.ALREADY_EXISTS:return O.ALREADY_EXISTS;case it.PERMISSION_DENIED:return O.PERMISSION_DENIED;case it.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case it.ABORTED:return O.ABORTED;case it.OUT_OF_RANGE:return O.OUT_OF_RANGE;case it.UNIMPLEMENTED:return O.UNIMPLEMENTED;case it.DATA_LOSS:return O.DATA_LOSS;default:return ne()}}(we=it||(it={}))[we.OK=0]="OK",we[we.CANCELLED=1]="CANCELLED",we[we.UNKNOWN=2]="UNKNOWN",we[we.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",we[we.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",we[we.NOT_FOUND=5]="NOT_FOUND",we[we.ALREADY_EXISTS=6]="ALREADY_EXISTS",we[we.PERMISSION_DENIED=7]="PERMISSION_DENIED",we[we.UNAUTHENTICATED=16]="UNAUTHENTICATED",we[we.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",we[we.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",we[we.ABORTED=10]="ABORTED",we[we.OUT_OF_RANGE=11]="OUT_OF_RANGE",we[we.UNIMPLEMENTED=12]="UNIMPLEMENTED",we[we.INTERNAL=13]="INTERNAL",we[we.UNAVAILABLE=14]="UNAVAILABLE",we[we.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function By(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oS=new ni([4294967295,4294967295],0);function jp(n){const e=By().encode(n),t=new G_;return t.update(e),new Uint8Array(t.digest())}function $p(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new ni([t,r],0),new ni([i,s],0)]}class kh{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Js(`Invalid padding: ${t}`);if(r<0)throw new Js(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Js(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Js(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=ni.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(ni.fromNumber(r)));return i.compare(oS)===1&&(i=new ni([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=jp(e),[r,i]=$p(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new kh(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=jp(e),[r,i]=$p(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Js extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Xo.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Jo(le.min(),i,new qe(fe),Kt(),me())}}class Xo{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Xo(r,t,me(),me(),me())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}}class Uy{constructor(e,t){this.targetId=e,this.me=t}}class qy{constructor(e,t,r=Ze.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Gp{constructor(){this.fe=0,this.ge=Kp(),this.pe=Ze.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=me(),t=me(),r=me();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ne()}}),new Xo(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Kp()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ae(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class aS{constructor(e){this.Le=e,this.Be=new Map,this.ke=Kt(),this.qe=zp(),this.Qe=new qe(fe)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:ne()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,r=e.me.count,i=this.Je(t);if(i){const s=i.target;if(ac(s))if(r===0){const o=new Y(s.path);this.Ue(t,o,$e.newNoDocument(o,le.min()))}else ae(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(t);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,a;try{o=vr(r).toUint8Array()}catch(l){if(l instanceof hy)return pn("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new kh(o,i,s)}catch(l){return pn(l instanceof Js?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((s,o)=>{const a=this.Je(o);if(a){if(s.current&&ac(a.target)){const l=new Y(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,$e.newNoDocument(l,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=me();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new Jo(e,t,this.Qe,this.ke,r);return this.ke=Kt(),this.qe=zp(),this.Qe=new qe(fe),i}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Gp,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Oe(fe),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||q("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Gp),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function zp(){return new qe(Y.comparator)}function Kp(){return new qe(Y.comparator)}const cS={asc:"ASCENDING",desc:"DESCENDING"},lS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},uS={and:"AND",or:"OR"};class hS{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Eu(n,e){return n.useProto3Json||Ko(e)?e:{value:e}}function as(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function jy(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function dS(n,e){return as(n,e.toTimestamp())}function nt(n){return ae(!!n),le.fromTimestamp(function(t){const r=Un(t);return new He(r.seconds,r.nanos)}(n))}function Mh(n,e){return Tu(n,e).canonicalString()}function Tu(n,e){const t=function(i){return new _e(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function $y(n){const e=_e.fromString(n);return ae(Zy(e)),e}function Vo(n,e){return Mh(n.databaseId,e.path)}function An(n,e){const t=$y(e);if(t.get(1)!==n.databaseId.projectId)throw new B(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new B(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Y(Ky(t))}function Gy(n,e){return Mh(n.databaseId,e)}function zy(n){const e=$y(n);return e.length===4?_e.emptyPath():Ky(e)}function wu(n){return new _e(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Ky(n){return ae(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Hp(n,e,t){return{name:Vo(n,e),fields:t.value.mapValue.fields}}function Hy(n,e,t){const r=An(n,e.name),i=nt(e.updateTime),s=e.createTime?nt(e.createTime):le.min(),o=new It({mapValue:{fields:e.fields}}),a=$e.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function fS(n,e){return"found"in e?function(r,i){ae(!!i.found),i.found.name,i.found.updateTime;const s=An(r,i.found.name),o=nt(i.found.updateTime),a=i.found.createTime?nt(i.found.createTime):le.min(),l=new It({mapValue:{fields:i.found.fields}});return $e.newFoundDocument(s,o,a,l)}(n,e):"missing"in e?function(r,i){ae(!!i.missing),ae(!!i.readTime);const s=An(r,i.missing),o=nt(i.readTime);return $e.newNoDocument(s,o)}(n,e):ne()}function pS(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ne()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,h){return u.useProto3Json?(ae(h===void 0||typeof h=="string"),Ze.fromBase64String(h||"")):(ae(h===void 0||h instanceof Buffer||h instanceof Uint8Array),Ze.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const h=u.code===void 0?O.UNKNOWN:Fy(u.code);return new B(h,u.message||"")}(o);t=new qy(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=An(n,r.document.name),s=nt(r.document.updateTime),o=r.document.createTime?nt(r.document.createTime):le.min(),a=new It({mapValue:{fields:r.document.fields}}),l=$e.newFoundDocument(i,s,o,a),u=r.targetIds||[],h=r.removedTargetIds||[];t=new $a(u,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=An(n,r.document),s=r.readTime?nt(r.readTime):le.min(),o=$e.newNoDocument(i,s),a=r.removedTargetIds||[];t=new $a([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=An(n,r.document),s=r.removedTargetIds||[];t=new $a([],s,i,null)}else{if(!("filter"in e))return ne();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new sS(i,s),a=r.targetId;t=new Uy(a,o)}}return t}function No(n,e){let t;if(e instanceof Is)t={update:Hp(n,e.key,e.value)};else if(e instanceof Es)t={delete:Vo(n,e.key)};else if(e instanceof Gn)t={update:Hp(n,e.key,e.data),updateMask:IS(e.fieldMask)};else{if(!(e instanceof xh))return ne();t={verify:Vo(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof ss)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ci)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof li)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof os)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw ne()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:dS(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ne()}(n,e.precondition)),t}function bu(n,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?Ke.updateTime(nt(s.updateTime)):s.exists!==void 0?Ke.exists(s.exists):Ke.none()}(e.currentDocument):Ke.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)ae(a.setToServerValue==="REQUEST_TIME"),l=new ss;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];l=new ci(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];l=new li(h)}else"increment"in a?l=new os(o,a.increment):ne();const u=ze.fromServerFormat(a.fieldPath);return new Yo(u,l)}(n,i)):[];if(e.update){e.update.name;const i=An(n,e.update.name),s=new It({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const u=l.fieldPaths||[];return new zt(u.map(h=>ze.fromServerFormat(h)))}(e.updateMask);return new Gn(i,s,o,t,r)}return new Is(i,s,t,r)}if(e.delete){const i=An(n,e.delete);return new Es(i,t)}if(e.verify){const i=An(n,e.verify);return new xh(i,t)}return ne()}function mS(n,e){return n&&n.length>0?(ae(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?nt(i.updateTime):nt(s);return o.isEqual(le.min())&&(o=nt(s)),new nS(o,i.transformResults||[])}(t,e))):[]}function Qy(n,e){return{documents:[Gy(n,e.path)]}}function Wy(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Gy(n,i);const s=function(u){if(u.length!==0)return Xy(Ve.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(h=>function(m){return{field:Fi(m.field),direction:_S(m.dir)}}(h))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=Eu(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:i}}function Yy(n){let e=zy(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){ae(r===1);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=function(f){const m=Jy(f);return m instanceof Ve&&Rh(m)?m.getFilters():[m]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(m=>function(R){return new xo(Bi(R.field),function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(m))}(t.orderBy));let a=null;t.limit&&(a=function(f){let m;return m=typeof f=="object"?f.value:f,Ko(m)?null:m}(t.limit));let l=null;t.startAt&&(l=function(f){const m=!!f.before,_=f.values||[];return new Tr(_,m)}(t.startAt));let u=null;return t.endAt&&(u=function(f){const m=!f.before,_=f.values||[];return new Tr(_,m)}(t.endAt)),Ty(e,i,o,s,a,"F",l,u)}function gS(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ne()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Jy(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Bi(t.unaryFilter.field);return ye.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Bi(t.unaryFilter.field);return ye.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Bi(t.unaryFilter.field);return ye.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Bi(t.unaryFilter.field);return ye.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ne()}}(n):n.fieldFilter!==void 0?function(t){return ye.create(Bi(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ne()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ve.create(t.compositeFilter.filters.map(r=>Jy(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ne()}}(t.compositeFilter.op))}(n):ne()}function _S(n){return cS[n]}function yS(n){return lS[n]}function vS(n){return uS[n]}function Fi(n){return{fieldPath:n.canonicalString()}}function Bi(n){return ze.fromServerFormat(n.fieldPath)}function Xy(n){return n instanceof ye?function(t){if(t.op==="=="){if(Dp(t.value))return{unaryFilter:{field:Fi(t.field),op:"IS_NAN"}};if(Cp(t.value))return{unaryFilter:{field:Fi(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Dp(t.value))return{unaryFilter:{field:Fi(t.field),op:"IS_NOT_NAN"}};if(Cp(t.value))return{unaryFilter:{field:Fi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fi(t.field),op:yS(t.op),value:t.value}}}(n):n instanceof Ve?function(t){const r=t.getFilters().map(i=>Xy(i));return r.length===1?r[0]:{compositeFilter:{op:vS(t.op),filters:r}}}(n):ne()}function IS(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Zy(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e,t,r,i,s=le.min(),o=le.min(),a=Ze.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new kn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new kn(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new kn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new kn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ev{constructor(e){this.ct=e}}function ES(n,e){let t;if(e.document)t=Hy(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Y.fromSegments(e.noDocument.path),i=hi(e.noDocument.readTime);t=$e.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ne();{const r=Y.fromSegments(e.unknownDocument.path),i=hi(e.unknownDocument.version);t=$e.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const s=new He(i[0],i[1]);return le.fromTimestamp(s)}(e.readTime)),t}function Qp(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:uc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Vo(s,o.key),fields:o.data.value.mapValue.fields,updateTime:as(s,o.version.toTimestamp()),createTime:as(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:ui(e.version)};else{if(!e.isUnknownDocument())return ne();r.unknownDocument={path:t.path.toArray(),version:ui(e.version)}}return r}function uc(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function ui(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function hi(n){const e=new He(n.seconds,n.nanoseconds);return le.fromTimestamp(e)}function Qr(n,e){const t=(e.baseMutations||[]).map(s=>bu(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>bu(n.ct,s)),i=He.fromMillis(e.localWriteTimeMs);return new Vh(e.batchId,i,t,r)}function Xs(n){const e=hi(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?hi(n.lastLimboFreeSnapshotVersion):le.min();let r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return ae(s.documents.length===1),Ft(vs(zy(s.documents[0])))}(n.query):function(s){return Ft(Yy(s))}(n.query),new kn(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Ze.fromBase64String(n.resumeToken))}function tv(n,e){const t=ui(e.snapshotVersion),r=ui(e.lastLimboFreeSnapshotVersion);let i;i=ac(e.target)?Qy(n.ct,e.target):Wy(n.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ai(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Lh(n){const e=Yy({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?lc(e,e.limit,"L"):e}function ql(n,e){return new Oh(e.largestBatchId,bu(n.ct,e.overlayMutation))}function Wp(n,e){const t=e.path.lastSegment();return[n,Lt(e.path.popLast()),t]}function Yp(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:ui(r.readTime),documentKey:Lt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TS{getBundleMetadata(e,t){return Jp(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:hi(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return Jp(e).put(function(i){return{bundleId:i.id,createTime:ui(nt(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return Xp(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:Lh(s.bundledQuery),readTime:hi(s.readTime)}}(r)})}saveNamedQuery(e,t){return Xp(e).put(function(i){return{name:i.name,readTime:ui(nt(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function Jp(n){return ct(n,"bundles")}function Xp(n){return ct(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new $c(e,r)}getOverlay(e,t){return js(e).get(Wp(this.userId,t)).next(r=>r?ql(this.serializer,r):null)}getOverlays(e,t){const r=Tn();return D.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,o)=>{const a=new Oh(t,o);i.push(this.ht(e,a))}),D.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(o=>i.add(Lt(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(js(e).j("collectionPathOverlayIndex",a))}),D.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Tn(),s=Lt(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return js(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const u=ql(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=Tn();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return js(e).J({index:"collectionGroupOverlayIndex",range:a},(l,u,h)=>{const f=ql(this.serializer,u);s.size()<i||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):h.done()}).next(()=>s)}ht(e,t){return js(e).put(function(i,s,o){const[a,l,u]=Wp(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:No(i.ct,o.mutation)}}(this.serializer,this.userId,t))}}function js(n){return ct(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{Pt(e){return ct(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?Ze.fromUint8Array(r):Ze.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Ge(e.integerValue));else if("doubleValue"in e){const r=Ge(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Ro(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Un(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(vr(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?dy(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Uc(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):ne()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;const s=e.fields||{};this.dt(t,53);const o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(Ge(a)),this.Vt(o,t),this.Tt(s[o],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),Y.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}Wr.vt=new Wr;function bS(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function Zp(n){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=bS(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}class AS{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const t=this.qt(e),r=Zp(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){const t=this.qt(e),r=Zp(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class SS{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class RS{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class $s{constructor(){this.jt=new AS,this.Ht=new SS(this.jt),this.Jt=new RS(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Yr(this.indexId,this.documentKey,this.arrayValue,r)}}function er(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=em(n.arrayValue,e.arrayValue),t!==0?t:(t=em(n.directionalValue,e.directionalValue),t!==0?t:Y.comparator(n.documentKey,e.documentKey)))}function em(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm{constructor(e){this.Xt=new Oe((t,r)=>ze.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(ae(e.collectionGroup===this.collectionId),this.nn)return!1;const t=fu(e);if(t!==void 0&&!this.sn(t))return!1;const r=Gr(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.on(a,l)||!this._n(this.en[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new Oe(ze.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Fa(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Fa(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Fa(r.field,r.dir==="asc"?0:1)));return new oc(oc.UNKNOWN_ID,this.collectionId,t,So.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nv(n){var e,t;if(ae(n instanceof ye||n instanceof Ve),n instanceof ye){if(n instanceof Ey){const i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>ye.create(n.field,"==",s)))||[];return Ve.create(i,"or")}return n}const r=n.filters.map(i=>nv(i));return Ve.create(r,n.op)}function PS(n){if(n.getFilters().length===0)return[];const e=Ru(nv(n));return ae(rv(e)),Au(e)||Su(e)?[e]:e.getFilters()}function Au(n){return n instanceof ye}function Su(n){return n instanceof Ve&&Rh(n)}function rv(n){return Au(n)||Su(n)||function(t){if(t instanceof Ve&&_u(t)){for(const r of t.getFilters())if(!Au(r)&&!Su(r))return!1;return!0}return!1}(n)}function Ru(n){if(ae(n instanceof ye||n instanceof Ve),n instanceof ye)return n;if(n.filters.length===1)return Ru(n.filters[0]);const e=n.filters.map(r=>Ru(r));let t=Ve.create(e,n.op);return t=hc(t),rv(t)?t:(ae(t instanceof Ve),ae(is(t)),ae(t.filters.length>1),t.filters.reduce((r,i)=>Fh(r,i)))}function Fh(n,e){let t;return ae(n instanceof ye||n instanceof Ve),ae(e instanceof ye||e instanceof Ve),t=n instanceof ye?e instanceof ye?function(i,s){return Ve.create([i,s],"and")}(n,e):nm(n,e):e instanceof ye?nm(e,n):function(i,s){if(ae(i.filters.length>0&&s.filters.length>0),is(i)&&is(s))return yy(i,s.getFilters());const o=_u(i)?i:s,a=_u(i)?s:i,l=o.filters.map(u=>Fh(u,a));return Ve.create(l,"or")}(n,e),hc(t)}function nm(n,e){if(is(e))return yy(e,n.getFilters());{const t=e.filters.map(r=>Fh(n,r));return Ve.create(t,"or")}}function hc(n){if(ae(n instanceof ye||n instanceof Ve),n instanceof ye)return n;const e=n.getFilters();if(e.length===1)return hc(e[0]);if(gy(n))return n;const t=e.map(i=>hc(i)),r=[];return t.forEach(i=>{i instanceof ye?r.push(i):i instanceof Ve&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Ve.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS{constructor(){this.un=new Bh}addToCollectionParentIndex(e,t){return this.un.add(t),D.resolve()}getCollectionParents(e,t){return D.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return D.resolve()}deleteFieldIndex(e,t){return D.resolve()}deleteAllFieldIndexes(e){return D.resolve()}createTargetIndexes(e,t){return D.resolve()}getDocumentsMatchingTarget(e,t){return D.resolve(null)}getIndexType(e,t){return D.resolve(0)}getFieldIndexes(e,t){return D.resolve([])}getNextCollectionGroupToUpdate(e){return D.resolve(null)}getMinOffset(e,t){return D.resolve(en.min())}getMinOffsetFromCollectionGroup(e,t){return D.resolve(en.min())}updateCollectionGroup(e,t,r){return D.resolve()}updateIndexEntries(e,t){return D.resolve()}}class Bh{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Oe(_e.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Oe(_e.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ca=new Uint8Array(0);class DS{constructor(e,t){this.databaseId=t,this.cn=new Bh,this.ln=new xr(r=>ai(r),(r,i)=>Ho(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const s={collectionId:r,parent:Lt(i)};return rm(e).put(s)}return D.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[Z_(t),""],!1,!0);return rm(e).U(i).next(s=>{for(const o of s){if(o.collectionId!==t)break;r.push(En(o.parent))}return r})}addFieldIndex(e,t){const r=Gs(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(t);delete i.indexId;const s=r.add(i);if(t.indexState){const o=Ni(e);return s.next(a=>{o.put(Yp(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=Gs(e),i=Ni(e),s=Vi(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Gs(e),r=Vi(e),i=Ni(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return D.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new tm(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const r=Vi(e);let i=!0;const s=new Map;return D.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=me();const a=[];return D.forEach(s,(l,u)=>{q("IndexedDbIndexManager",`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(z=>`${z.fieldPath}:${z.kind}`).join(",")}`}(l)} to execute ${ai(t)}`);const h=function(F,z){const se=fu(z);if(se===void 0)return null;for(const oe of cc(F,se.fieldPath))switch(oe.op){case"array-contains-any":return oe.value.arrayValue.values||[];case"array-contains":return[oe.value]}return null}(u,l),f=function(F,z){const se=new Map;for(const oe of Gr(z))for(const A of cc(F,oe.fieldPath))switch(A.op){case"==":case"in":se.set(oe.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return se.set(oe.fieldPath.canonicalString(),A.value),Array.from(se.values())}return null}(u,l),m=function(F,z){const se=[];let oe=!0;for(const A of Gr(z)){const v=A.kind===0?kp(F,A.fieldPath,F.startAt):Mp(F,A.fieldPath,F.startAt);se.push(v.value),oe&&(oe=v.inclusive)}return new Tr(se,oe)}(u,l),_=function(F,z){const se=[];let oe=!0;for(const A of Gr(z)){const v=A.kind===0?Mp(F,A.fieldPath,F.endAt):kp(F,A.fieldPath,F.endAt);se.push(v.value),oe&&(oe=v.inclusive)}return new Tr(se,oe)}(u,l),R=this.In(l,u,m),x=this.In(l,u,_),N=this.Tn(l,u,f),j=this.En(l.indexId,h,R,m.inclusive,x,_.inclusive,N);return D.forEach(j,U=>r.G(U,t.limit).next(F=>{F.forEach(z=>{const se=Y.fromSegments(z.documentKey);o.has(se)||(o=o.add(se),a.push(se))})}))}).next(()=>a)}return D.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=PS(Ve.create(e.filters,"and")).map(r=>vu(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,s,o,a){const l=(t!=null?t.length:1)*Math.max(r.length,s.length),u=l/(t!=null?t.length:1),h=[];for(let f=0;f<l;++f){const m=t?this.dn(t[f/u]):Ca,_=this.An(e,m,r[f%u],i),R=this.Rn(e,m,s[f%u],o),x=a.map(N=>this.An(e,m,N,!0));h.push(...this.createRange(_,R,x))}return h}An(e,t,r,i){const s=new Yr(e,Y.empty(),t,r);return i?s:s.Zt()}Rn(e,t,r,i){const s=new Yr(e,Y.empty(),t,r);return i?s.Zt():s}Pn(e,t){const r=new tm(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const i=this.hn(t);return D.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let u=new Oe(ze.comparator),h=!1;for(const f of l.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:u=u.add(m.field));for(const f of l.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(h?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}Vn(e,t){const r=new $s;for(const i of Gr(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const o=r.Yt(i.kind);Wr.vt.It(s,o)}return r.zt()}dn(e){const t=new $s;return Wr.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new $s;return Wr.vt.It(oi(this.databaseId,t),r.Yt(function(s){const o=Gr(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let i=[];i.push(new $s);let s=0;for(const o of Gr(e)){const a=r[s++];for(const l of i)if(this.fn(t,o.fieldPath)&&Do(a))i=this.gn(i,o,a);else{const u=l.Yt(o.kind);Wr.vt.It(a,u)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new $s;l.seed(a.zt()),Wr.vt.It(o,l.Yt(t.kind)),s.push(l)}return s}fn(e,t){return!!e.filters.find(r=>r instanceof ye&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=Gs(e),i=Ni(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{const o=[];return D.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(h,f){const m=f?new So(f.sequenceNumber,new en(hi(f.readTime),new Y(En(f.documentKey)),f.largestBatchId)):So.empty(),_=h.fields.map(([R,x])=>new Fa(ze.fromServerFormat(R),x));return new oc(h.indexId,h.collectionGroup,_,m)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:fe(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=Gs(e),s=Ni(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>D.forEach(a,l=>s.put(Yp(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return D.forEach(t,(i,s)=>{const o=r.get(i.collectionGroup);return(o?D.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),D.forEach(a,l=>this.wn(e,i,l).next(u=>{const h=this.Sn(s,l);return u.isEqual(h)?D.resolve():this.bn(e,s,l,u,h)}))))})}Dn(e,t,r,i){return Vi(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return Vi(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const i=Vi(e);let s=new Oe(er);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{s=s.add(new Yr(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}Sn(e,t){let r=new Oe(er);const i=this.Vn(t,e);if(i==null)return r;const s=fu(t);if(s!=null){const o=e.data.field(s.fieldPath);if(Do(o))for(const a of o.arrayValue.values||[])r=r.add(new Yr(t.indexId,e.key,this.dn(a),i))}else r=r.add(new Yr(t.indexId,e.key,Ca,i));return r}bn(e,t,r,i,s){q("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(l,u,h,f,m){const _=l.getIterator(),R=u.getIterator();let x=xi(_),N=xi(R);for(;x||N;){let j=!1,U=!1;if(x&&N){const F=h(x,N);F<0?U=!0:F>0&&(j=!0)}else x!=null?U=!0:j=!0;j?(f(N),N=xi(R)):U?(m(x),x=xi(_)):(x=xi(_),N=xi(R))}}(i,s,er,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),D.waitFor(o)}yn(e){let t=1;return Ni(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>er(o,a)).filter((o,a,l)=>!a||er(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=er(o,e),l=er(o,t);if(a===0)i[0]=e.Zt();else if(a>0&&l<0)i.push(o),i.push(o.Zt());else if(l>0)break}i.push(t);const s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];const a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Ca,[]],l=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Ca,[]];s.push(IDBKeyRange.bound(a,l))}return s}Cn(e,t){return er(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(im)}getMinOffset(e,t){return D.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||ne())).next(im)}}function rm(n){return ct(n,"collectionParents")}function Vi(n){return ct(n,"indexEntries")}function Gs(n){return ct(n,"indexConfiguration")}function Ni(n){return ct(n,"indexState")}function im(n){ae(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;wh(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new en(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sm={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class qt{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new qt(e,qt.DEFAULT_COLLECTION_PERCENTILE,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iv(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const l=r.J({range:o},(h,f,m)=>(a++,m.delete()));s.push(l.next(()=>{ae(a===1)}));const u=[];for(const h of t.mutations){const f=oy(e,h.key.path,t.batchId);s.push(i.delete(f)),u.push(h.key)}return D.waitFor(s).next(()=>u)}function dc(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ne();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */qt.DEFAULT_COLLECTION_PERCENTILE=10,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,qt.DEFAULT=new qt(41943040,qt.DEFAULT_COLLECTION_PERCENTILE,qt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),qt.DISABLED=new qt(-1,0,0);class Gc{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){ae(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Gc(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return tr(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=Ui(e),o=tr(e);return o.add({}).next(a=>{ae(typeof a=="number");const l=new Vh(a,t,r,i),u=function(_,R,x){const N=x.baseMutations.map(U=>No(_.ct,U)),j=x.mutations.map(U=>No(_.ct,U));return{userId:R,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:N,mutations:j}}(this.serializer,this.userId,l),h=[];let f=new Oe((m,_)=>fe(m.canonicalString(),_.canonicalString()));for(const m of i){const _=oy(this.userId,m.key.path,a);f=f.add(m.key.path.popLast()),h.push(o.put(u)),h.push(s.put(_,g0))}return f.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[a]=l.keys()}),D.waitFor(h).next(()=>l)})}lookupMutationBatch(e,t){return tr(e).get(t).next(r=>r?(ae(r.userId===this.userId),Qr(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?D.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return tr(e).J({index:"userMutationsIndex",range:i},(o,a,l)=>{a.userId===this.userId&&(ae(a.batchId>=r),s=Qr(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return tr(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return tr(e).U("userMutationsIndex",t).next(r=>r.map(i=>Qr(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Ba(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Ui(e).J({range:i},(o,a,l)=>{const[u,h,f]=o,m=En(h);if(u===this.userId&&t.path.isEqual(m))return tr(e).get(f).next(_=>{if(!_)throw ne();ae(_.userId===this.userId),s.push(Qr(this.serializer,_))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Oe(fe);const i=[];return t.forEach(s=>{const o=Ba(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=Ui(e).J({range:a},(u,h,f)=>{const[m,_,R]=u,x=En(_);m===this.userId&&s.path.isEqual(x)?r=r.add(R):f.done()});i.push(l)}),D.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=Ba(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Oe(fe);return Ui(e).J({range:o},(l,u,h)=>{const[f,m,_]=l,R=En(m);f===this.userId&&r.isPrefixOf(R)?R.length===i&&(a=a.add(_)):h.done()}).next(()=>this.xn(e,a))}xn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(tr(e).get(s).next(o=>{if(o===null)throw ne();ae(o.userId===this.userId),r.push(Qr(this.serializer,o))}))}),D.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return iv(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),D.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return D.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Ui(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=En(s[1]);i.push(l)}else a.done()}).next(()=>{ae(i.length===0)})})}containsKey(e,t){return sv(e,this.userId,t)}Nn(e){return ov(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function sv(n,e,t){const r=Ba(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Ui(n).J({range:s,H:!0},(a,l,u)=>{const[h,f,m]=a;h===e&&f===i&&(o=!0),u.done()}).next(()=>o)}function tr(n){return ct(n,"mutations")}function Ui(n){return ct(n,"documentMutations")}function ov(n){return ct(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new di(0)}static kn(){return new di(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new di(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>le.fromTimestamp(new He(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Oi(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(ae(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return Oi(e).J((o,a)=>{const l=Xs(a);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>D.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Oi(e).J((r,i)=>{const s=Xs(i);t(s)})}qn(e){return om(e).get("targetGlobalKey").next(t=>(ae(t!==null),t))}Qn(e,t){return om(e).put("targetGlobalKey",t)}Kn(e,t){return Oi(e).put(tv(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=ai(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Oi(e).J({range:i,index:"queryTargetsIndex"},(o,a,l)=>{const u=Xs(a);Ho(t,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=cr(e);return t.forEach(o=>{const a=Lt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),D.waitFor(i)}removeMatchingKeys(e,t,r){const i=cr(e);return D.forEach(t,s=>{const o=Lt(s.path);return D.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=cr(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=cr(e);let s=me();return i.J({range:r,H:!0},(o,a,l)=>{const u=En(o[1]),h=new Y(u);s=s.add(h)}).next(()=>s)}containsKey(e,t){const r=Lt(t.path),i=IDBKeyRange.bound([r],[Z_(r)],!1,!0);let s=0;return cr(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],l,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}ot(e,t){return Oi(e).get(t).next(r=>r?Xs(r):null)}}function Oi(n){return ct(n,"targets")}function om(n){return ct(n,"targetGlobal")}function cr(n){return ct(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function am([n,e],[t,r]){const i=fe(n,t);return i===0?fe(e,r):i}class VS{constructor(e){this.Un=e,this.buffer=new Oe(am),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();am(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class NS{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){q("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Dr(t)?q("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Cr(t)}await this.Hn(3e5)})}}class OS{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return D.resolve(Gt.oe);const r=new VS(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(q("LruGarbageCollector","Garbage collection skipped; disabled"),D.resolve(sm)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(q("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),sm):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,s,o,a,l,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(s=f,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(u=Date.now(),Mi()<=ve.DEBUG&&q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${f} documents in `+(u-l)+`ms
Total Duration: ${u-h}ms`),D.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}function kS(n,e){return new OS(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(e,t){this.db=e,this.garbageCollector=kS(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return Da(e,r)}removeReference(e,t,r){return Da(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Da(e,t)}nr(e,t){return function(i,s){let o=!1;return ov(i).Y(a=>sv(i,a,s).next(l=>(l&&(o=!0),D.resolve(!l)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.tr(e,(o,a)=>{if(a<=t){const l=this.nr(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,le.min()),cr(e).delete(function(f){return[0,Lt(f.path)]}(o))))});i.push(l)}}).next(()=>D.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Da(e,t)}tr(e,t){const r=cr(e);let i,s=Gt.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:u})=>{o===0?(s!==Gt.oe&&t(new Y(En(i)),s),s=u,i=l):s=Gt.oe}).next(()=>{s!==Gt.oe&&t(new Y(En(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Da(n,e){return cr(n).put(function(r,i){return{targetId:0,path:Lt(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(){this.changes=new xr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,$e.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?D.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return qr(e).put(r)}removeEntry(e,t,r){return qr(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],uc(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=$e.newInvalidDocument(t);return qr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(zs(t))},(i,s)=>{r=this.ir(t,s)}).next(()=>r)}sr(e,t){let r={size:0,document:$e.newInvalidDocument(t)};return qr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(zs(t))},(i,s)=>{r={document:this.ir(t,s),size:dc(s)}}).next(()=>r)}getEntries(e,t){let r=Kt();return this._r(e,t,(i,s)=>{const o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,t){let r=Kt(),i=new qe(Y.comparator);return this._r(e,t,(s,o)=>{const a=this.ir(s,o);r=r.insert(s,a),i=i.insert(s,dc(o))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return D.resolve();let i=new Oe(um);t.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(zs(i.first()),zs(i.last())),o=i.getIterator();let a=o.getNext();return qr(e).J({index:"documentKeyIndex",range:s},(l,u,h)=>{const f=Y.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&um(a,f)<0;)r(a,null),a=o.getNext();a&&a.isEqual(f)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?h.$(zs(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),uc(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return qr(e).U(IDBKeyRange.bound(a,l,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let h=Kt();for(const f of u){const m=this.ir(Y.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(Wo(t,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,t,r,i){let s=Kt();const o=lm(t,r),a=lm(t,en.max());return qr(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,u,h)=>{const f=this.ir(Y.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(f.key,f),s.size===i&&h.done()}).next(()=>s)}newChangeBuffer(e){return new FS(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return cm(e).get("remoteDocumentGlobalKey").next(t=>(ae(!!t),t))}rr(e,t){return cm(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=ES(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(le.min())))return r}return $e.newInvalidDocument(e)}}function cv(n){return new LS(n)}class FS extends av{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new xr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new Oe((s,o)=>fe(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.lr.get(s);if(t.push(this.cr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=Qp(this.cr.serializer,o);i=i.add(s.path.popLast());const u=dc(l);r+=u-a.size,t.push(this.cr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=Qp(this.cr.serializer,o.convertToNoDocument(le.min()));t.push(this.cr.addEntry(e,s,l))}}),i.forEach(s=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.cr.updateMetadata(e,r)),D.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function cm(n){return ct(n,"remoteDocumentGlobal")}function qr(n){return ct(n,"remoteDocumentsV14")}function zs(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function lm(n,e){const t=e.documentKey.path.toArray();return[n,uc(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function um(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=fe(t[s],r[s]),i)return i;return i=fe(t.length,r.length),i||(i=fe(t[t.length-2],r[r.length-2]),i||fe(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BS{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ao(r.mutation,i,zt.empty(),He.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,me()).next(()=>r))}getLocalViewOfDocuments(e,t,r=me()){const i=Tn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Ys();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Tn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,me()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Kt();const o=oo(),a=function(){return oo()}();return t.forEach((l,u)=>{const h=r.get(u.key);i.has(u.key)&&(h===void 0||h.mutation instanceof Gn)?s=s.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),ao(h.mutation,u,h.mutation.getFieldMask(),He.now())):o.set(u.key,zt.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,h)=>o.set(u,h)),t.forEach((u,h)=>{var f;return a.set(u,new BS(h,(f=o.get(u))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){const r=oo();let i=new qe((o,a)=>o-a),s=me();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=t.get(l);if(u===null)return;let h=r.get(l)||zt.empty();h=a.applyToLocalView(u,h),r.set(l,h);const f=(i.get(a.batchId)||me()).add(l);i=i.insert(a.batchId,f)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,h=l.value,f=Py();h.forEach(m=>{if(!s.has(m)){const _=ky(t.get(m),r.get(m));_!==null&&f.set(m,_),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return D.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return Y.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ph(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):D.resolve(Tn());let a=-1,l=s;return o.next(u=>D.forEach(u,(h,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),s.get(h)?D.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{l=l.insert(h,m)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,me())).next(h=>({batchId:a,changes:Ry(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Y(t)).next(r=>{let i=Ys();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=Ys();return this.indexManager.getCollectionParents(e,s).next(a=>D.forEach(a,l=>{const u=function(f,m){return new $n(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((l,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,$e.newInvalidDocument(h)))});let a=Ys();return o.forEach((l,u)=>{const h=s.get(l);h!==void 0&&ao(h.mutation,u,zt.empty(),He.now()),Wo(t,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class US{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return D.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:nt(i.createTime)}}(t)),D.resolve()}getNamedQuery(e,t){return D.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:Lh(i.bundledQuery),readTime:nt(i.readTime)}}(t)),D.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(){this.overlays=new qe(Y.comparator),this.Ir=new Map}getOverlay(e,t){return D.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Tn();return D.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),D.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),D.resolve()}getOverlaysForCollection(e,t,r){const i=Tn(),s=t.length+1,o=new Y(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return D.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new qe((u,h)=>u-h);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let h=s.get(u.largestBatchId);h===null&&(h=Tn(),s=s.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const a=Tn(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,h)=>a.set(u,h)),!(a.size()>=i)););return D.resolve(a)}ht(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Oh(t,r));let s=this.Ir.get(t);s===void 0&&(s=me(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(){this.sessionToken=Ze.EMPTY_BYTE_STRING}getSessionToken(e){return D.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,D.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(){this.Tr=new Oe(ut.Er),this.dr=new Oe(ut.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new ut(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new ut(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new Y(new _e([])),r=new ut(t,e),i=new ut(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new Y(new _e([])),r=new ut(t,e),i=new ut(t,e+1);let s=me();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new ut(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class ut{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return Y.comparator(e.key,t.key)||fe(e.wr,t.wr)}static Ar(e,t){return fe(e.wr,t.wr)||Y.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Oe(ut.Er)}checkEmpty(e){return D.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Vh(s,t,r,i);this.mutationQueue.push(o);for(const a of i)this.br=this.br.add(new ut(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return D.resolve(o)}lookupMutationBatch(e,t){return D.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.vr(r),s=i<0?0:i;return D.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return D.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return D.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ut(t,0),i=new ut(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const a=this.Dr(o.wr);s.push(a)}),D.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Oe(fe);return t.forEach(i=>{const s=new ut(i,0),o=new ut(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),D.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;Y.isDocumentKey(s)||(s=s.child(""));const o=new ut(new Y(s),0);let a=new Oe(fe);return this.br.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.wr)),!0)},o),D.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ae(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return D.forEach(t.mutations,i=>{const s=new ut(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new ut(t,0),i=this.br.firstAfterOrEqual(r);return D.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,D.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS{constructor(e){this.Mr=e,this.docs=function(){return new qe(Y.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return D.resolve(r?r.document.mutableCopy():$e.newInvalidDocument(t))}getEntries(e,t){let r=Kt();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():$e.newInvalidDocument(i))}),D.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Kt();const o=t.path,a=new Y(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:h}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||wh(ty(h),r)<=0||(i.has(h.key)||Wo(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return D.resolve(s)}getAllFromCollectionGroup(e,t,r,i){ne()}Or(e,t){return D.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new zS(this)}getSize(e){return D.resolve(this.size)}}class zS extends av{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),D.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KS{constructor(e){this.persistence=e,this.Nr=new xr(t=>ai(t),Ho),this.lastRemoteSnapshotVersion=le.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Uh,this.targetCount=0,this.kr=di.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),D.resolve()}getLastRemoteSnapshotVersion(e){return D.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return D.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),D.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),D.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new di(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,D.resolve()}updateTargetData(e,t){return this.Kn(t),D.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,D.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),D.waitFor(s).next(()=>i)}getTargetCount(e){return D.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return D.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),D.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),D.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),D.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return D.resolve(r)}containsKey(e,t){return D.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Gt(0),this.Kr=!1,this.Kr=!0,this.$r=new jS,this.referenceDelegate=e(this),this.Ur=new KS(this),this.indexManager=new CS,this.remoteDocumentCache=function(i){return new GS(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new ev(t),this.Gr=new US(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new qS,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new $S(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){q("MemoryPersistence","Starting transaction:",e);const i=new HS(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return D.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class HS extends ry{constructor(e){super(),this.currentSequenceNumber=e}}class zc{constructor(e){this.persistence=e,this.Jr=new Uh,this.Yr=null}static Zr(e){return new zc(e)}get Xr(){if(this.Yr)return this.Yr;throw ne()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),D.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),D.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),D.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return D.forEach(this.Xr,r=>{const i=Y.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,le.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return D.or([()=>D.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e){this.serializer=e}O(e,t,r,i){const s=new Fc("createOrUpgrade",t);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",bp,{unique:!0}),l.createObjectStore("documentMutations")}(e),hm(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=D.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),hm(e)),o=o.next(()=>function(l){const u=l.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:le.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",h)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,u){return u.store("mutations").U().next(h=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",bp,{unique:!0});const f=u.store("mutations"),m=h.map(_=>f.put(_));return D.waitFor(m)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const u=l.createObjectStore("documentOverlays",{keyPath:P0});u.createIndex("collectionPathOverlayIndex",C0,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",D0,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore("remoteDocumentsV14",{keyPath:_0});u.createIndex("documentKeyIndex",y0),u.createIndex("collectionGroupIndex",v0)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:b0}).createIndex("sequenceNumberIndex",A0,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:S0}).createIndex("documentKeyIndex",R0,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=dc(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>D.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>D.forEach(a,l=>{ae(l.userId===s.userId);const u=Qr(this.serializer,l);return iv(e,s.userId,u).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,a)=>{const l=new _e(o),u=function(f){return[0,Lt(f)]}(l);s.push(t.get(u).next(h=>h?D.resolve():(f=>t.put({targetId:0,path:Lt(f),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>D.waitFor(s))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:w0});const r=t.store("collectionParents"),i=new Bh,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:Lt(l)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new _e(o);return s(l.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,l],u)=>{const h=En(a);return s(h.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,i)=>{const s=Xs(i),o=tv(this.serializer,s);return t.put(o)})}_i(e,t){const r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{const a=t.store("remoteDocumentsV14"),l=function(f){return f.document?new Y(_e.fromString(f.document.name).popFirst(5)):f.noDocument?Y.fromSegments(f.noDocument.path):f.unknownDocument?Y.fromSegments(f.unknownDocument.path):ne()}(o).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>D.waitFor(i))}ai(e,t){const r=t.store("mutations"),i=cv(this.serializer),s=new uv(zc.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var u;let h=(u=a.get(l.userId))!==null&&u!==void 0?u:me();Qr(this.serializer,l).keys().forEach(f=>h=h.add(f)),a.set(l.userId,h)}),D.forEach(a,(l,u)=>{const h=new ht(u),f=$c.lt(this.serializer,h),m=s.getIndexManager(h),_=Gc.lt(h,this.serializer,m,s.referenceDelegate);return new lv(i,_,f,m).recalculateAndSaveOverlaysForDocumentKeys(new pu(t,Gt.oe),l).next()})})}}function hm(n){n.createObjectStore("targetDocuments",{keyPath:E0}).createIndex("documentTargetsIndex",T0,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",I0,{unique:!0}),n.createObjectStore("targetGlobal")}const jl="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class qh{constructor(e,t,r,i,s,o,a,l,u,h,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=s,this.window=o,this.document=a,this.ci=u,this.li=h,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!qh.D())throw new B(O.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new MS(this,i),this.Ai=t+"main",this.serializer=new ev(l),this.Ri=new bn(this.Ai,this.hi,new QS(this.serializer)),this.$r=new wS,this.Ur=new xS(this.referenceDelegate,this.serializer),this.remoteDocumentCache=cv(this.serializer),this.Gr=new TS,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,h===!1&&tt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new B(O.FAILED_PRECONDITION,jl);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Gt(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>xa(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Dr(e))return q("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return q("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Ks(e).get("owner").next(t=>D.resolve(this.vi(t)))}Ci(e){return xa(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=ct(t,"clientMetadata");return r.U().next(i=>{const s=this.xi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return D.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?D.resolve(!0):Ks(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new B(O.FAILED_PRECONDITION,jl);return!1}}return!(!this.networkEnabled||!this.inForeground)||xa(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&q("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new pu(e,Gt.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>xa(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return Gc.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new DS(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return $c.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){q("IndexedDbPersistence","Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=function(l){return l===17?N0:l===16?V0:l===15?Ah:l===14?ly:l===13?cy:l===12?x0:l===11?ay:void ne()}(this.hi);let o;return this.Ri.runTransaction(e,i,s,a=>(o=new pu(a,this.Qr?this.Qr.next():Gt.oe),t==="readwrite-primary"?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw tt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new B(O.FAILED_PRECONDITION,ny);return r(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return Ks(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new B(O.FAILED_PRECONDITION,jl)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ks(e).put("owner",t)}static D(){return bn.D()}bi(e){const t=Ks(e);return t.get("owner").next(r=>this.vi(r)?(q("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):D.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(tt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;C_()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return q("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return tt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){tt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ks(n){return ct(n,"owner")}function xa(n){return ct(n,"clientMetadata")}function jh(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=me(),i=me();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new $h(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return C_()?8:iy(ic())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new WS;return this.Xi(e,t,o).next(a=>{if(s.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Mi()<=ve.DEBUG&&q("QueryEngine","SDK will not create cache indexes for query:",Li(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),D.resolve()):(Mi()<=ve.DEBUG&&q("QueryEngine","Query:",Li(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Mi()<=ve.DEBUG&&q("QueryEngine","The SDK decides to create cache indexes for query:",Li(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ft(t))):D.resolve())}Yi(e,t){if(Lp(t))return D.resolve(null);let r=Ft(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=lc(t,null,"F"),r=Ft(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=me(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.ts(t,a);return this.ns(t,u,o,l.readTime)?this.Yi(e,lc(t,null,"F")):this.rs(e,u,t,l)}))})))}Zi(e,t,r,i){return Lp(t)||i.isEqual(le.min())?D.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(t,s);return this.ns(t,o,r,i)?D.resolve(null):(Mi()<=ve.DEBUG&&q("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Li(t)),this.rs(e,o,t,ey(i,-1)).next(a=>a))})}ts(e,t){let r=new Oe(Ay(e));return t.forEach((i,s)=>{Wo(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return Mi()<=ve.DEBUG&&q("QueryEngine","Using full collection scan to execute query:",Li(t)),this.Ji.getDocumentsMatchingQuery(e,t,en.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YS{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new qe(fe),this._s=new xr(s=>ai(s),Ho),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new lv(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function dv(n,e,t,r){return new YS(n,e,t,r)}async function fv(n,e){const t=J(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=me();for(const u of i){o.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}for(const u of s){a.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:a}))})})}function JS(n,e){const t=J(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,u,h){const f=u.batch,m=f.keys();let _=D.resolve();return m.forEach(R=>{_=_.next(()=>h.getEntry(l,R)).next(x=>{const N=u.docVersions.get(R);ae(N!==null),x.version.compareTo(N)<0&&(f.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),h.addEntry(x)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=me();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function pv(n){const e=J(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function XS(n,e){const t=J(n),r=e.snapshotVersion;let i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;const a=[];e.targetChanges.forEach((h,f)=>{const m=i.get(f);if(!m)return;a.push(t.Ur.removeMatchingKeys(s,h.removedDocuments,f).next(()=>t.Ur.addMatchingKeys(s,h.addedDocuments,f)));let _=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?_=_.withResumeToken(Ze.EMPTY_BYTE_STRING,le.min()).withLastLimboFreeSnapshotVersion(le.min()):h.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(h.resumeToken,r)),i=i.insert(f,_),function(x,N,j){return x.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:j.addedDocuments.size+j.modifiedDocuments.size+j.removedDocuments.size>0}(m,_,h)&&a.push(t.Ur.updateTargetData(s,_))});let l=Kt(),u=me();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(mv(s,o,e.documentUpdates).next(h=>{l=h.Ps,u=h.Is})),!r.isEqual(le.min())){const h=t.Ur.getLastRemoteSnapshotVersion(s).next(f=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return D.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(t.os=i,s))}function mv(n,e,t){let r=me(),i=me();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Kt();return t.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(le.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):q("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{Ps:o,Is:i}})}function ZS(n,e){const t=J(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function cs(n,e){const t=J(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,D.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new kn(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function ls(n,e,t){const r=J(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Dr(o))throw o;q("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function fc(n,e,t){const r=J(n);let i=le.min(),s=me();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,h){const f=J(l),m=f._s.get(h);return m!==void 0?D.resolve(f.os.get(m)):f.Ur.getTargetData(u,h)}(r,o,Ft(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:le.min(),t?s:me())).next(a=>(yv(r,by(e),a),{documents:a,Ts:s})))}function gv(n,e){const t=J(n),r=J(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function _v(n,e){const t=J(n),r=t.us.get(e)||le.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,ey(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(yv(t,e,i),i))}function yv(n,e,t){let r=n.us.get(e)||le.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}async function eR(n,e,t,r){const i=J(n);let s=me(),o=Kt();for(const u of t){const h=e.Es(u.metadata.name);u.document&&(s=s.add(h));const f=e.ds(u);f.setReadTime(e.As(u.metadata.readTime)),o=o.insert(h,f)}const a=i.cs.newChangeBuffer({trackRemovals:!0}),l=await cs(i,function(h){return Ft(vs(_e.fromString(`__bundle__/docs/${h}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>mv(u,a,o).next(h=>(a.apply(u),h)).next(h=>i.Ur.removeMatchingKeysForTargetId(u,l.targetId).next(()=>i.Ur.addMatchingKeys(u,s,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,h.Ps,h.Is)).next(()=>h.Ps)))}async function tR(n,e,t=me()){const r=await cs(n,Ft(Lh(e.bundledQuery))),i=J(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=nt(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Gr.saveNamedQuery(s,e);const a=r.withResumeToken(Ze.EMPTY_BYTE_STRING,o);return i.os=i.os.insert(a.targetId,a),i.Ur.updateTargetData(s,a).next(()=>i.Ur.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Ur.addMatchingKeys(s,t,r.targetId)).next(()=>i.Gr.saveNamedQuery(s,e))})}function dm(n,e){return`firestore_clients_${n}_${e}`}function fm(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function $l(n,e){return`firestore_targets_${n}_${e}`}class pc{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Rs(e,t,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new B(i.error.code,i.error.message))),o?new pc(e,t,i.state,s):(tt("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class co{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){const r=JSON.parse(t);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new B(r.error.code,r.error.message))),s?new co(e,r.state,i):(tt("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class mc{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const r=JSON.parse(t);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=Ch();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=sy(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new mc(e,s):(tt("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Gh{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Gh(t.clientId,t.onlineState):(tt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Pu{constructor(){this.activeTargetIds=Ch()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Gl{constructor(e,t,r,i,s){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new qe(fe),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=dm(this.persistenceKey,this.ps),this.vs=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Pu),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.Os=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const i=this.getItem(dm(this.persistenceKey,r));if(i){const s=mc.Rs(r,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const r=this.Ls(t);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem($l(this.persistenceKey,e));if(i){const s=co.Rs(e,i);s&&(r=s.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem($l(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return q("SharedClientState","READ",e,t),t}setItem(e,t){q("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){q("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(q("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void tt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const r=this.Gs(t.key);return this.zs(r,null)}{const r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){const r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){const r=function(s){let o=Gt.oe;if(s!=null)try{const a=JSON.parse(s);ae(typeof a=="number"),o=a}catch(a){tt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(t.newValue);r!==Gt.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){const r=this.Xs(t.newValue);await Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(t)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){const i=new pc(this.currentUser,e,t,r),s=fm(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){const t=fm(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){const i=$l(this.persistenceKey,e),s=new co(e,t,r);this.setItem(i,s.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const r=this.Gs(e);return mc.Rs(r,t)}Hs(e,t){const r=this.Fs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return pc.Rs(new ht(s),i,t)}Ys(e,t){const r=this.Ms.exec(e),i=Number(r[1]);return co.Rs(i,t)}Ls(e){return Gh.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);q("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const r=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(r),o=[],a=[];return s.forEach(l=>{i.has(l)||o.push(l)}),i.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Ch();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class vv{constructor(){this.so=new Pu,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Pu,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nR{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){q("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){q("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Va=null;function zl(){return Va===null?Va=function(){return 268435456+Math.round(2147483648*Math.random())}():Va++,"0x"+Va.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iR{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const St="WebChannelConnection";class sR extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){const a=zl(),l=this.xo(t,r.toUriEncodedString());q("RestConnection",`Sending RPC '${t}' ${a}:`,l,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(t,l,u,i).then(h=>(q("RestConnection",`Received RPC '${t}' ${a}: `,h),h),h=>{throw pn("RestConnection",`RPC '${t}' ${a} failed with error: `,h,"url: ",l,"request:",i),h})}Lo(t,r,i,s,o,a){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ys}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){const i=rR[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){const s=zl();return new Promise((o,a)=>{const l=new z_;l.setWithCredentials(!0),l.listenOnce(H_.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case La.NO_ERROR:const h=l.getResponseJson();q(St,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),o(h);break;case La.TIMEOUT:q(St,`RPC '${e}' ${s} timed out`),a(new B(O.DEADLINE_EXCEEDED,"Request time out"));break;case La.HTTP_ERROR:const f=l.getStatus();if(q(St,`RPC '${e}' ${s} failed with status:`,f,"response text:",l.getResponseText()),f>0){let m=l.getResponseJson();Array.isArray(m)&&(m=m[0]);const _=m==null?void 0:m.error;if(_&&_.status&&_.message){const R=function(N){const j=N.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(j)>=0?j:O.UNKNOWN}(_.status);a(new B(R,_.message))}else a(new B(O.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new B(O.UNAVAILABLE,"Connection failed."));break;default:ne()}}finally{q(St,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);q(St,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",u,r,15)})}Bo(e,t,r){const i=zl(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Y_(),a=W_(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.xmlHttpFactory=new K_({})),this.Oo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const h=s.join("");q(St,`Creating RPC '${e}' stream ${i}: ${h}`,l);const f=o.createWebChannel(h,l);let m=!1,_=!1;const R=new iR({Io:N=>{_?q(St,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(m||(q(St,`Opening RPC '${e}' stream ${i} transport.`),f.open(),m=!0),q(St,`RPC '${e}' stream ${i} sending:`,N),f.send(N))},To:()=>f.close()}),x=(N,j,U)=>{N.listen(j,F=>{try{U(F)}catch(z){setTimeout(()=>{throw z},0)}})};return x(f,Ws.EventType.OPEN,()=>{_||(q(St,`RPC '${e}' stream ${i} transport opened.`),R.yo())}),x(f,Ws.EventType.CLOSE,()=>{_||(_=!0,q(St,`RPC '${e}' stream ${i} transport closed`),R.So())}),x(f,Ws.EventType.ERROR,N=>{_||(_=!0,pn(St,`RPC '${e}' stream ${i} transport errored:`,N),R.So(new B(O.UNAVAILABLE,"The operation could not be completed")))}),x(f,Ws.EventType.MESSAGE,N=>{var j;if(!_){const U=N.data[0];ae(!!U);const F=U,z=F.error||((j=F[0])===null||j===void 0?void 0:j.error);if(z){q(St,`RPC '${e}' stream ${i} received error:`,z);const se=z.status;let oe=function(I){const b=it[I];if(b!==void 0)return Fy(b)}(se),A=z.message;oe===void 0&&(oe=O.INTERNAL,A="Unknown error status: "+se+" with message "+z.message),_=!0,R.So(new B(oe,A)),f.close()}else q(St,`RPC '${e}' stream ${i} received:`,U),R.bo(U)}}),x(a,Q_.STAT_EVENT,N=>{N.stat===du.PROXY?q(St,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===du.NOPROXY&&q(St,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{R.wo()},0),R}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iv(){return typeof window<"u"?window:null}function Ga(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zo(n){return new hS(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&q("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e,t,r,i,s,o,a,l){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new zh(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===O.RESOURCE_EXHAUSTED?(tt(t.toString()),tt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===O.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{const i=new B(O.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return q("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(q("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class oR extends Ev{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=pS(this.serializer,e),r=function(s){if(!("targetChange"in s))return le.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?le.min():o.readTime?nt(o.readTime):le.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=wu(this.serializer),t.addTarget=function(s,o){let a;const l=o.target;if(a=ac(l)?{documents:Qy(s,l)}:{query:Wy(s,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=jy(s,o.resumeToken);const u=Eu(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(le.min())>0){a.readTime=as(s,o.snapshotVersion.toTimestamp());const u=Eu(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=gS(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=wu(this.serializer),t.removeTarget=e,this.a_(t)}}class aR extends Ev{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return ae(!!e.streamToken),this.lastStreamToken=e.streamToken,ae(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ae(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=mS(e.writeResults,e.commitTime),r=nt(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=wu(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>No(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new B(O.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,Tu(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new B(O.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,Tu(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new B(O.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class lR{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(tt(t),this.D_=!1):q("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uR{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{Vr(this)&&(q("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=J(l);u.L_.add(4),await Ts(u),u.q_.set("Unknown"),u.L_.delete(4),await ea(u)}(this))})}),this.q_=new lR(r,i)}}async function ea(n){if(Vr(n))for(const e of n.B_)await e(!0)}async function Ts(n){for(const e of n.B_)await e(!1)}function Kc(n,e){const t=J(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Qh(t)?Hh(t):bs(t).r_()&&Kh(t,e))}function us(n,e){const t=J(n),r=bs(t);t.N_.delete(e),r.r_()&&Tv(t,e),t.N_.size===0&&(r.r_()?r.o_():Vr(t)&&t.q_.set("Unknown"))}function Kh(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(le.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}bs(n).A_(e)}function Tv(n,e){n.Q_.xe(e),bs(n).R_(e)}function Hh(n){n.Q_=new aS({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),bs(n).start(),n.q_.v_()}function Qh(n){return Vr(n)&&!bs(n).n_()&&n.N_.size>0}function Vr(n){return J(n).L_.size===0}function wv(n){n.Q_=void 0}async function hR(n){n.q_.set("Online")}async function dR(n){n.N_.forEach((e,t)=>{Kh(n,e)})}async function fR(n,e){wv(n),Qh(n)?(n.q_.M_(e),Hh(n)):n.q_.set("Unknown")}async function pR(n,e,t){if(n.q_.set("Online"),e instanceof qy&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.N_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))}(n,e)}catch(r){q("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await gc(n,r)}else if(e instanceof $a?n.Q_.Ke(e):e instanceof Uy?n.Q_.He(e):n.Q_.We(e),!t.isEqual(le.min()))try{const r=await pv(n.localStore);t.compareTo(r)>=0&&await function(s,o){const a=s.Q_.rt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const h=s.N_.get(u);h&&s.N_.set(u,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const h=s.N_.get(l);if(!h)return;s.N_.set(l,h.withResumeToken(Ze.EMPTY_BYTE_STRING,h.snapshotVersion)),Tv(s,l);const f=new kn(h.target,l,u,h.sequenceNumber);Kh(s,f)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){q("RemoteStore","Failed to raise snapshot:",r),await gc(n,r)}}async function gc(n,e,t){if(!Dr(e))throw e;n.L_.add(1),await Ts(n),n.q_.set("Offline"),t||(t=()=>pv(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{q("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await ea(n)})}function bv(n,e){return e().catch(t=>gc(n,t,e))}async function ws(n){const e=J(n),t=wr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;mR(e);)try{const i=await ZS(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,gR(e,i)}catch(i){await gc(e,i)}Av(e)&&Sv(e)}function mR(n){return Vr(n)&&n.O_.length<10}function gR(n,e){n.O_.push(e);const t=wr(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Av(n){return Vr(n)&&!wr(n).n_()&&n.O_.length>0}function Sv(n){wr(n).start()}async function _R(n){wr(n).p_()}async function yR(n){const e=wr(n);for(const t of n.O_)e.m_(t.mutations)}async function vR(n,e,t){const r=n.O_.shift(),i=Nh.from(r,e,t);await bv(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await ws(n)}async function IR(n,e){e&&wr(n).V_&&await async function(r,i){if(function(o){return Ly(o)&&o!==O.ABORTED}(i.code)){const s=r.O_.shift();wr(r).s_(),await bv(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await ws(r)}}(n,e),Av(n)&&Sv(n)}async function mm(n,e){const t=J(n);t.asyncQueue.verifyOperationInProgress(),q("RemoteStore","RemoteStore received new credentials");const r=Vr(t);t.L_.add(3),await Ts(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await ea(t)}async function Cu(n,e){const t=J(n);e?(t.L_.delete(2),await ea(t)):e||(t.L_.add(2),await Ts(t),t.q_.set("Unknown"))}function bs(n){return n.K_||(n.K_=function(t,r,i){const s=J(t);return s.w_(),new oR(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:hR.bind(null,n),Ro:dR.bind(null,n),mo:fR.bind(null,n),d_:pR.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),Qh(n)?Hh(n):n.q_.set("Unknown")):(await n.K_.stop(),wv(n))})),n.K_}function wr(n){return n.U_||(n.U_=function(t,r,i){const s=J(t);return s.w_(),new aR(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:_R.bind(null,n),mo:IR.bind(null,n),f_:yR.bind(null,n),g_:vR.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await ws(n)):(await n.U_.stop(),n.O_.length>0&&(q("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ft,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,a=new Wh(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new B(O.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function As(n,e){if(tt("AsyncQueue",`${e}: ${n}`),Dr(n))return new B(O.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Y.comparator(t.key,r.key):(t,r)=>Y.comparator(t.key,r.key),this.keyedMap=Ys(),this.sortedSet=new qe(this.comparator)}static emptySet(e){return new Xi(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Xi)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Xi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm{constructor(){this.W_=new qe(Y.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):ne():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class hs{constructor(e,t,r,i,s,o,a,l,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new hs(e,t,Xi.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class TR{constructor(){this.queries=_m(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const i=J(t),s=i.queries;i.queries=_m(),s.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new B(O.ABORTED,"Firestore shutting down"))}}function _m(){return new xr(n=>wy(n),Qo)}async function Yh(n,e){const t=J(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new ER,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await t.onListen(i,!0);break;case 1:s.z_=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const a=As(o,`Initialization of query '${Li(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&Xh(t)}async function Jh(n,e){const t=J(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function wR(n,e){const t=J(n);let r=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&Xh(t)}function bR(n,e,t){const r=J(n),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(t);r.queries.delete(e)}function Xh(n){n.Y_.forEach(e=>{e.next()})}var Du,ym;(ym=Du||(Du={})).ea="default",ym.Cache="cache";class Zh{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new hs(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=hs.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Du.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(e){this.serializer=e}Es(e){return An(this.serializer,e)}ds(e){return e.metadata.exists?Hy(this.serializer,e.document,!1):$e.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return nt(e)}}class SR{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Rv(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;const r=_e.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){const t=new Map,r=new vm(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.Es(i.metadata.name);for(const o of i.metadata.queries){const a=(t.get(o)||me()).add(s);t.set(o,a)}}return t}async complete(){const e=await eR(this.localStore,new vm(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(const r of this.queries)await tR(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function Rv(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(e){this.key=e}}class Cv{constructor(e){this.key=e}}class Dv{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=me(),this.mutatedKeys=me(),this.Aa=Ay(e),this.Ra=new Xi(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new gm,i=t?t.Ra:this.Ra;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,f)=>{const m=i.get(h),_=Wo(this.query,f)?f:null,R=!!m&&this.mutatedKeys.has(m.key),x=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let N=!1;m&&_?m.data.isEqual(_.data)?R!==x&&(r.track({type:3,doc:_}),N=!0):this.ga(m,_)||(r.track({type:2,doc:_}),N=!0,(l&&this.Aa(_,l)>0||u&&this.Aa(_,u)<0)&&(a=!0)):!m&&_?(r.track({type:0,doc:_}),N=!0):m&&!_&&(r.track({type:1,doc:m}),N=!0,(l||u)&&(a=!0)),N&&(_?(o=o.add(_),s=x?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((h,f)=>function(_,R){const x=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ne()}};return x(_)-x(R)}(h.type,f.type)||this.Aa(h.doc,f.doc)),this.pa(r),i=i!=null&&i;const a=t&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,u=l!==this.Ea;return this.Ea=l,o.length!==0||u?{snapshot:new hs(this.query,e.Ra,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new gm,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=me(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Cv(r))}),this.da.forEach(r=>{e.has(r)||t.push(new Pv(r))}),t}ba(e){this.Ta=e.Ts,this.da=me();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return hs.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class RR{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class PR{constructor(e){this.key=e,this.va=!1}}class CR{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new xr(a=>wy(a),Qo),this.Ma=new Map,this.xa=new Set,this.Oa=new qe(Y.comparator),this.Na=new Map,this.La=new Uh,this.Ba={},this.ka=new Map,this.qa=di.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function DR(n,e,t=!0){const r=Hc(n);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await xv(r,e,t,!0),i}async function xR(n,e){const t=Hc(n);await xv(t,e,!0,!1)}async function xv(n,e,t,r){const i=await cs(n.localStore,Ft(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let a;return r&&(a=await ed(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&Kc(n.remoteStore,i),a}async function ed(n,e,t,r,i){n.Ka=(f,m,_)=>async function(x,N,j,U){let F=N.view.ma(j);F.ns&&(F=await fc(x.localStore,N.query,!1).then(({documents:A})=>N.view.ma(A,F)));const z=U&&U.targetChanges.get(N.targetId),se=U&&U.targetMismatches.get(N.targetId)!=null,oe=N.view.applyChanges(F,x.isPrimaryClient,z,se);return xu(x,N.targetId,oe.wa),oe.snapshot}(n,f,m,_);const s=await fc(n.localStore,e,!0),o=new Dv(e,s.Ts),a=o.ma(s.documents),l=Xo.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=o.applyChanges(a,n.isPrimaryClient,l);xu(n,t,u.wa);const h=new RR(e,t,o);return n.Fa.set(e,h),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),u.snapshot}async function VR(n,e,t){const r=J(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Qo(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await ls(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&us(r.remoteStore,i.targetId),ds(r,i.targetId)}).catch(Cr)):(ds(r,i.targetId),await ls(r.localStore,i.targetId,!0))}async function NR(n,e){const t=J(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),us(t.remoteStore,r.targetId))}async function OR(n,e,t){const r=id(n);try{const i=await function(o,a){const l=J(o),u=He.now(),h=a.reduce((_,R)=>_.add(R.key),me());let f,m;return l.persistence.runTransaction("Locally write mutations","readwrite",_=>{let R=Kt(),x=me();return l.cs.getEntries(_,h).next(N=>{R=N,R.forEach((j,U)=>{U.isValidDocument()||(x=x.add(j))})}).next(()=>l.localDocuments.getOverlayedDocuments(_,R)).next(N=>{f=N;const j=[];for(const U of a){const F=iS(U,f.get(U.key).overlayedDocument);F!=null&&j.push(new Gn(U.key,F,py(F.value.mapValue),Ke.exists(!0)))}return l.mutationQueue.addMutationBatch(_,u,j,a)}).next(N=>{m=N;const j=N.applyToLocalDocumentSet(f,x);return l.documentOverlayCache.saveOverlays(_,N.batchId,j)})}).then(()=>({batchId:m.batchId,changes:Ry(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Ba[o.currentUser.toKey()];u||(u=new qe(fe)),u=u.insert(a,l),o.Ba[o.currentUser.toKey()]=u}(r,i.batchId,t),await zn(r,i.changes),await ws(r.remoteStore)}catch(i){const s=As(i,"Failed to persist write");t.reject(s)}}async function Vv(n,e){const t=J(n);try{const r=await XS(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Na.get(s);o&&(ae(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?ae(o.va):i.removedDocuments.size>0&&(ae(o.va),o.va=!1))}),await zn(t,r,e)}catch(r){await Cr(r)}}function Im(n,e,t){const r=J(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Fa.forEach((s,o)=>{const a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=J(o);l.onlineState=a;let u=!1;l.queries.forEach((h,f)=>{for(const m of f.j_)m.Z_(a)&&(u=!0)}),u&&Xh(l)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function kR(n,e,t){const r=J(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new qe(Y.comparator);o=o.insert(s,$e.newNoDocument(s,le.min()));const a=me().add(s),l=new Jo(le.min(),new Map,new qe(fe),o,a);await Vv(r,l),r.Oa=r.Oa.remove(s),r.Na.delete(e),rd(r)}else await ls(r.localStore,e,!1).then(()=>ds(r,e,t)).catch(Cr)}async function MR(n,e){const t=J(n),r=e.batch.batchId;try{const i=await JS(t.localStore,e);nd(t,r,null),td(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await zn(t,i)}catch(i){await Cr(i)}}async function LR(n,e,t){const r=J(n);try{const i=await function(o,a){const l=J(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return l.mutationQueue.lookupMutationBatch(u,a).next(f=>(ae(f!==null),h=f.keys(),l.mutationQueue.removeMutationBatch(u,f))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>l.localDocuments.getDocuments(u,h))})}(r.localStore,e);nd(r,e,t),td(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await zn(r,i)}catch(i){await Cr(i)}}async function FR(n,e){const t=J(n);Vr(t.remoteStore)||q("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const a=J(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(t.localStore);if(r===-1)return void e.resolve();const i=t.ka.get(r)||[];i.push(e),t.ka.set(r,i)}catch(r){const i=As(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function td(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function nd(n,e,t){const r=J(n);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function ds(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||Nv(n,r)})}function Nv(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(us(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),rd(n))}function xu(n,e,t){for(const r of t)r instanceof Pv?(n.La.addReference(r.key,e),BR(n,r)):r instanceof Cv?(q("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||Nv(n,r.key)):ne()}function BR(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(q("SyncEngine","New document in limbo: "+t),n.xa.add(r),rd(n))}function rd(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new Y(_e.fromString(e)),r=n.qa.next();n.Na.set(r,new PR(t)),n.Oa=n.Oa.insert(t,r),Kc(n.remoteStore,new kn(Ft(vs(t.path)),r,"TargetPurposeLimboResolution",Gt.oe))}}async function zn(n,e,t){const r=J(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,t).then(u=>{var h;if((u||t)&&r.isPrimaryClient){const f=u?!u.fromCache:(h=t==null?void 0:t.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(u){i.push(u);const f=$h.Wi(l.targetId,u);s.push(f)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(l,u){const h=J(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>D.forEach(u,m=>D.forEach(m.$i,_=>h.persistence.referenceDelegate.addReference(f,m.targetId,_)).next(()=>D.forEach(m.Ui,_=>h.persistence.referenceDelegate.removeReference(f,m.targetId,_)))))}catch(f){if(!Dr(f))throw f;q("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const m=f.targetId;if(!f.fromCache){const _=h.os.get(m),R=_.snapshotVersion,x=_.withLastLimboFreeSnapshotVersion(R);h.os=h.os.insert(m,x)}}}(r.localStore,s))}async function UR(n,e){const t=J(n);if(!t.currentUser.isEqual(e)){q("SyncEngine","User change. New user:",e.toKey());const r=await fv(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(l=>{l.reject(new B(O.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await zn(t,r.hs)}}function qR(n,e){const t=J(n),r=t.Na.get(e);if(r&&r.va)return me().add(r.key);{let i=me();const s=t.Ma.get(e);if(!s)return i;for(const o of s){const a=t.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}async function jR(n,e){const t=J(n),r=await fc(t.localStore,e.query,!0),i=e.view.ba(r);return t.isPrimaryClient&&xu(t,e.targetId,i.wa),i}async function $R(n,e){const t=J(n);return _v(t.localStore,e).then(r=>zn(t,r))}async function GR(n,e,t,r){const i=J(n),s=await function(a,l){const u=J(a),h=J(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",f=>h.Mn(f,l).next(m=>m?u.localDocuments.getDocuments(f,m):D.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?await ws(i.remoteStore):t==="acknowledged"||t==="rejected"?(nd(i,e,r||null),td(i,e),function(a,l){J(J(a).mutationQueue).On(l)}(i.localStore,e)):ne(),await zn(i,s)):q("SyncEngine","Cannot apply mutation batch with id: "+e)}async function zR(n,e){const t=J(n);if(Hc(t),id(t),e===!0&&t.Qa!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),i=await Em(t,r.toArray());t.Qa=!0,await Cu(t.remoteStore,!0);for(const s of i)Kc(t.remoteStore,s)}else if(e===!1&&t.Qa!==!1){const r=[];let i=Promise.resolve();t.Ma.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(ds(t,o),ls(t.localStore,o,!0))),us(t.remoteStore,o)}),await i,await Em(t,r),function(o){const a=J(o);a.Na.forEach((l,u)=>{us(a.remoteStore,u)}),a.La.pr(),a.Na=new Map,a.Oa=new qe(Y.comparator)}(t),t.Qa=!1,await Cu(t.remoteStore,!1)}}async function Em(n,e,t){const r=J(n),i=[],s=[];for(const o of e){let a;const l=r.Ma.get(o);if(l&&l.length!==0){a=await cs(r.localStore,Ft(l[0]));for(const u of l){const h=r.Fa.get(u),f=await jR(r,h);f.snapshot&&s.push(f.snapshot)}}else{const u=await gv(r.localStore,o);a=await cs(r.localStore,u),await ed(r,Ov(u),o,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(s),i}function Ov(n){return Ty(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function KR(n){return function(t){return J(J(t).persistence).Qi()}(J(n).localStore)}async function HR(n,e,t,r){const i=J(n);if(i.Qa)return void q("SyncEngine","Ignoring unexpected query state notification.");const s=i.Ma.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const o=await _v(i.localStore,by(s[0])),a=Jo.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Ze.EMPTY_BYTE_STRING);await zn(i,o,a);break}case"rejected":await ls(i.localStore,e,!0),ds(i,e,r);break;default:ne()}}async function QR(n,e,t){const r=Hc(n);if(r.Qa){for(const i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){q("SyncEngine","Adding an already active target "+i);continue}const s=await gv(r.localStore,i),o=await cs(r.localStore,s);await ed(r,Ov(s),o.targetId,!1,o.resumeToken),Kc(r.remoteStore,o)}for(const i of t)r.Ma.has(i)&&await ls(r.localStore,i,!1).then(()=>{us(r.remoteStore,i),ds(r,i)}).catch(Cr)}}function Hc(n){const e=J(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Vv.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=qR.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=kR.bind(null,e),e.Ca.d_=wR.bind(null,e.eventManager),e.Ca.$a=bR.bind(null,e.eventManager),e}function id(n){const e=J(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=MR.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=LR.bind(null,e),e}function WR(n,e,t){const r=J(n);(async function(s,o,a){try{const l=await o.getMetadata();if(await function(_,R){const x=J(_),N=nt(R.createTime);return x.persistence.runTransaction("hasNewerBundle","readonly",j=>x.Gr.getBundleMetadata(j,R.id)).then(j=>!!j&&j.createTime.compareTo(N)>=0)}(s.localStore,l))return await o.close(),a._completeWith(function(_){return{taskState:"Success",documentsLoaded:_.totalDocuments,bytesLoaded:_.totalBytes,totalDocuments:_.totalDocuments,totalBytes:_.totalBytes}}(l)),Promise.resolve(new Set);a._updateProgress(Rv(l));const u=new SR(l,s.localStore,o.serializer);let h=await o.Ua();for(;h;){const m=await u.la(h);m&&a._updateProgress(m),h=await o.Ua()}const f=await u.complete();return await zn(s,f.Ia,void 0),await function(_,R){const x=J(_);return x.persistence.runTransaction("Save bundle","readwrite",N=>x.Gr.saveBundleMetadata(N,R))}(s.localStore,l),a._completeWith(f.progress),Promise.resolve(f.Pa)}catch(l){return pn("SyncEngine",`Loading bundle failed with ${l}`),a._failWith(l),Promise.resolve(new Set)}})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class Vu{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Zo(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return dv(this.persistence,new hv,e.initialUser,this.serializer)}createPersistence(e){return new uv(zc.Zr,this.serializer)}createSharedClientState(e){return new vv}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class kv extends Vu{constructor(e,t,r){super(),this.Wa=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Wa.initialize(this,e),await id(this.Wa.syncEngine),await ws(this.Wa.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return dv(this.persistence,new hv,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new NS(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const r=new p0(t,this.persistence);return new f0(e.asyncQueue,r)}createPersistence(e){const t=jh(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?qt.withCacheSize(this.cacheSizeBytes):qt.DEFAULT;return new qh(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,Iv(),Ga(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new vv}}class YR extends kv{constructor(e,t){super(e,t,!1),this.Wa=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Wa.syncEngine;this.sharedClientState instanceof Gl&&(this.sharedClientState.syncEngine={no:GR.bind(null,t),ro:HR.bind(null,t),io:QR.bind(null,t),Qi:KR.bind(null,t),eo:$R.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await zR(this.Wa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const t=Iv();if(!Gl.D(t))throw new B(O.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=jh(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Gl(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class sd{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Im(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=UR.bind(null,this.syncEngine),await Cu(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new TR}()}createDatastore(e){const t=Zo(e.databaseInfo.databaseId),r=function(s){return new sR(s)}(e.databaseInfo);return function(s,o,a,l){return new cR(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,a){return new uR(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>Im(this.syncEngine,t,0),function(){return pm.D()?new pm:new nR}())}createSyncEngine(e,t){return function(i,s,o,a,l,u,h){const f=new CR(i,s,o,a,l,u);return h&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=J(i);q("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Ts(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tm(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ga(this.observer.next,e)}error(e){this.observer.error?this.Ga(this.observer.error,e):tt("Uncaught Error in snapshot listener:",e.toString())}za(){this.muted=!0}Ga(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{constructor(e,t){this.ja=e,this.serializer=t,this.metadata=new ft,this.buffer=new Uint8Array,this.Ha=function(){return new TextDecoder("utf-8")}(),this.Ja().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.aa)}`))},r=>this.metadata.reject(r))}close(){return this.ja.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.Ja()}async Ja(){const e=await this.Ya();if(e===null)return null;const t=this.Ha.decode(e),r=Number(t);isNaN(r)&&this.Za(`length string (${t}) is not valid number`);const i=await this.Xa(r);return new AR(JSON.parse(i),e.length+r)}eu(){return this.buffer.findIndex(e=>e===123)}async Ya(){for(;this.eu()<0&&!await this.tu(););if(this.buffer.length===0)return null;const e=this.eu();e<0&&this.Za("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Xa(e){for(;this.buffer.length<e;)await this.tu()&&this.Za("Reached the end of bundle when more is expected.");const t=this.Ha.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Za(e){throw this.ja.cancel(),new Error(`Invalid bundle format: ${e}`)}async tu(){const e=await this.ja.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new B(O.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(i,s){const o=J(i),a={documents:s.map(f=>Vo(o.serializer,f))},l=await o.Lo("BatchGetDocuments",o.serializer.databaseId,_e.emptyPath(),a,s.length),u=new Map;l.forEach(f=>{const m=fS(o.serializer,f);u.set(m.key.toString(),m)});const h=[];return s.forEach(f=>{const m=u.get(f.toString());ae(!!m),h.push(m)}),h}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Es(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const i=Y.fromPath(r);this.mutations.push(new xh(i,this.precondition(i)))}),await async function(r,i){const s=J(r),o={writes:i.map(a=>No(s.serializer,a))};await s.Mo("Commit",s.serializer.databaseId,_e.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ne();t=le.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new B(O.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(le.min())?Ke.exists(!1):Ke.updateTime(t):Ke.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(le.min()))throw new B(O.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ke.updateTime(t)}return Ke.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.nu=r.maxAttempts,this.t_=new zh(this.asyncQueue,"transaction_retry")}ru(){this.nu-=1,this.iu()}iu(){this.t_.Go(async()=>{const e=new XR(this.datastore),t=this.su(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.ou(i)}))}).catch(r=>{this.ou(r)})})}su(e){try{const t=this.updateFunction(e);return!Ko(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ou(e){this.nu>0&&this._u(e)?(this.nu-=1,this.asyncQueue.enqueueAndForget(()=>(this.iu(),Promise.resolve()))):this.deferred.reject(e)}_u(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Ly(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=ht.UNAUTHENTICATED,this.clientId=X_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{q("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(q("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new B(O.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ft;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=As(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function za(n,e){n.asyncQueue.verifyOperationInProgress(),q("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await fv(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function Nu(n,e){n.asyncQueue.verifyOperationInProgress();const t=await od(n);q("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>mm(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>mm(e.remoteStore,i)),n._onlineComponents=e}function Mv(n){return n.name==="FirebaseError"?n.code===O.FAILED_PRECONDITION||n.code===O.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function od(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){q("FirestoreClient","Using user provided OfflineComponentProvider");try{await za(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!Mv(t))throw t;pn("Error using user provided cache. Falling back to memory cache: "+t),await za(n,new Vu)}}else q("FirestoreClient","Using default OfflineComponentProvider"),await za(n,new Vu);return n._offlineComponents}async function Wc(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(q("FirestoreClient","Using user provided OnlineComponentProvider"),await Nu(n,n._uninitializedComponentsProvider._online)):(q("FirestoreClient","Using default OnlineComponentProvider"),await Nu(n,new sd))),n._onlineComponents}function Lv(n){return od(n).then(e=>e.persistence)}function ad(n){return od(n).then(e=>e.localStore)}function Fv(n){return Wc(n).then(e=>e.remoteStore)}function cd(n){return Wc(n).then(e=>e.syncEngine)}function tP(n){return Wc(n).then(e=>e.datastore)}async function fs(n){const e=await Wc(n),t=e.eventManager;return t.onListen=DR.bind(null,e.syncEngine),t.onUnlisten=VR.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=xR.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=NR.bind(null,e.syncEngine),t}function nP(n){return n.asyncQueue.enqueue(async()=>{const e=await Lv(n),t=await Fv(n);return e.setNetworkEnabled(!0),function(i){const s=J(i);return s.L_.delete(0),ea(s)}(t)})}function rP(n){return n.asyncQueue.enqueue(async()=>{const e=await Lv(n),t=await Fv(n);return e.setNetworkEnabled(!1),async function(i){const s=J(i);s.L_.add(0),await Ts(s),s.q_.set("Offline")}(t)})}function iP(n,e){const t=new ft;return n.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const a=await function(u,h){const f=J(u);return f.persistence.runTransaction("read document","readonly",m=>f.localDocuments.getDocument(m,h))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new B(O.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){const l=As(a,`Failed to get document '${s} from cache`);o.reject(l)}}(await ad(n),e,t)),t.promise}function Bv(n,e,t={}){const r=new ft;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const h=new Qc({next:m=>{o.enqueueAndForget(()=>Jh(s,f));const _=m.docs.has(a);!_&&m.fromCache?u.reject(new B(O.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&m.fromCache&&l&&l.source==="server"?u.reject(new B(O.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new Zh(vs(a.path),h,{includeMetadataChanges:!0,_a:!0});return Yh(s,f)}(await fs(n),n.asyncQueue,e,t,r)),r.promise}function sP(n,e){const t=new ft;return n.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const a=await fc(i,s,!0),l=new Dv(s,a.Ts),u=l.ma(a.documents),h=l.applyChanges(u,!1);o.resolve(h.snapshot)}catch(a){const l=As(a,`Failed to execute query '${s} against cache`);o.reject(l)}}(await ad(n),e,t)),t.promise}function Uv(n,e,t={}){const r=new ft;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const h=new Qc({next:m=>{o.enqueueAndForget(()=>Jh(s,f)),m.fromCache&&l.source==="server"?u.reject(new B(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new Zh(a,h,{includeMetadataChanges:!0,_a:!0});return Yh(s,f)}(await fs(n),n.asyncQueue,e,t,r)),r.promise}function oP(n,e){const t=new Qc(e);return n.asyncQueue.enqueueAndForget(async()=>function(i,s){J(i).Y_.add(s),s.next()}(await fs(n),t)),()=>{t.za(),n.asyncQueue.enqueueAndForget(async()=>function(i,s){J(i).Y_.delete(s)}(await fs(n),t))}}function aP(n,e,t,r){const i=function(o,a){let l;return l=typeof o=="string"?By().encode(o):o,function(h,f){return new JR(h,f)}(function(h,f){if(h instanceof Uint8Array)return Tm(h,f);if(h instanceof ArrayBuffer)return Tm(new Uint8Array(h),f);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),a)}(t,Zo(e));n.asyncQueue.enqueueAndForget(async()=>{WR(await cd(n),i,r)})}function cP(n,e){return n.asyncQueue.enqueue(async()=>function(r,i){const s=J(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Gr.getNamedQuery(o,i))}(await ad(n),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qv(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wm=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ld(n,e,t){if(!t)throw new B(O.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function jv(n,e,t,r){if(e===!0&&r===!0)throw new B(O.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function bm(n){if(!Y.isDocumentKey(n))throw new B(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Am(n){if(Y.isDocumentKey(n))throw new B(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Yc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ne()}function be(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new B(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Yc(n);throw new B(O.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function $v(n,e){if(e<=0)throw new B(O.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new B(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new B(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}jv("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=qv((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new B(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new B(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new B(O.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ta{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Sm({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new B(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new B(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Sm(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new n0;switch(r.type){case"firstParty":return new o0(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new B(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=wm.get(t);r&&(q("ComponentProvider","Removing Datastore"),wm.delete(t),r.terminate())}(this),Promise.resolve()}}function lP(n,e,t,r={}){var i;const s=(n=be(n,ta))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&pn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=ht.MOCK_USER;else{a=wb(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new B(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new ht(u)}n._authCredentials=new r0(new J_(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bt=class Gv{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Gv(this.firestore,e,this._query)}},Je=class zv{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new zv(this.firestore,e,this._key)}},fr=class Kv extends Bt{constructor(e,t,r){super(e,t,vs(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Je(this.firestore,null,new Y(e))}withConverter(e){return new Kv(this.firestore,e,this._path)}};function Hv(n,e,...t){if(n=st(n),ld("collection","path",e),n instanceof ta){const r=_e.fromString(e,...t);return Am(r),new fr(n,null,r)}{if(!(n instanceof Je||n instanceof fr))throw new B(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(_e.fromString(e,...t));return Am(r),new fr(n.firestore,null,r)}}function uP(n,e){if(n=be(n,ta),ld("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new B(O.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Bt(n,null,function(r){return new $n(_e.emptyPath(),r)}(e))}function _c(n,e,...t){if(n=st(n),arguments.length===1&&(e=X_.newId()),ld("doc","path",e),n instanceof ta){const r=_e.fromString(e,...t);return bm(r),new Je(n,null,new Y(r))}{if(!(n instanceof Je||n instanceof fr))throw new B(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(_e.fromString(e,...t));return bm(r),new Je(n.firestore,n instanceof fr?n.converter:null,new Y(r))}}function Qv(n,e){return n=st(n),e=st(e),(n instanceof Je||n instanceof fr)&&(e instanceof Je||e instanceof fr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Wv(n,e){return n=st(n),e=st(e),n instanceof Bt&&e instanceof Bt&&n.firestore===e.firestore&&Qo(n._query,e._query)&&n.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hP{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new zh(this,"async_queue_retry"),this.Eu=()=>{const t=Ga();t&&q("AsyncQueue","Visibility state changed to "+t.visibilityState),this.t_.jo()};const e=Ga();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.du(),this.Au(e)}enterRestrictedMode(e){if(!this.cu){this.cu=!0,this.Iu=e||!1;const t=Ga();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Eu)}}enqueue(e){if(this.du(),this.cu)return new Promise(()=>{});const t=new ft;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.uu.push(e),this.Ru()))}async Ru(){if(this.uu.length!==0){try{await this.uu[0](),this.uu.shift(),this.t_.reset()}catch(e){if(!Dr(e))throw e;q("AsyncQueue","Operation failed with retryable error: "+e)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}}Au(e){const t=this.au.then(()=>(this.Pu=!0,e().catch(r=>{this.hu=r,this.Pu=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw tt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Pu=!1,r))));return this.au=t,t}enqueueAfterDelay(e,t,r){this.du(),this.Tu.indexOf(e)>-1&&(t=0);const i=Wh.createAndSchedule(this,e,t,r,s=>this.Vu(s));return this.lu.push(i),i}du(){this.hu&&ne()}verifyOperationInProgress(){}async mu(){let e;do e=this.au,await e;while(e!==this.au)}fu(e){for(const t of this.lu)if(t.timerId===e)return!0;return!1}gu(e){return this.mu().then(()=>{this.lu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.lu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.mu()})}pu(e){this.Tu.push(e)}Vu(e){const t=this.lu.indexOf(e);this.lu.splice(t,1)}}function Ou(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class dP{constructor(){this._progressObserver={},this._taskCompletionResolver=new ft,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fP=-1;let et=class extends ta{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=function(){return new hP}(),this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Yv(this),this._firestoreClient.terminate()}};function pt(n){return n._firestoreClient||Yv(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function Yv(n){var e,t,r;const i=n._freezeSettings(),s=function(a,l,u,h){return new M0(a,l,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,qv(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new eP(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function pP(n,e){Xv(n=be(n,et));const t=pt(n);if(t._uninitializedComponentsProvider)throw new B(O.FAILED_PRECONDITION,"SDK cache is already specified.");pn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=n._freezeSettings(),i=new sd;return Jv(t,i,new kv(i,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function mP(n){Xv(n=be(n,et));const e=pt(n);if(e._uninitializedComponentsProvider)throw new B(O.FAILED_PRECONDITION,"SDK cache is already specified.");pn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings(),r=new sd;return Jv(e,r,new YR(r,t.cacheSizeBytes))}function Jv(n,e,t){const r=new ft;return n.asyncQueue.enqueue(async()=>{try{await za(n,t),await Nu(n,e),r.resolve()}catch(i){const s=i;if(!Mv(s))throw s;pn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}}).then(()=>r.promise)}function gP(n){if(n._initialized&&!n._terminated)throw new B(O.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new ft;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!bn.D())return Promise.resolve();const i=r+"main";await bn.delete(i)}(jh(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function _P(n){return function(t){const r=new ft;return t.asyncQueue.enqueueAndForget(async()=>FR(await cd(t),r)),r.promise}(pt(n=be(n,et)))}function yP(n){return nP(pt(n=be(n,et)))}function vP(n){return rP(pt(n=be(n,et)))}function IP(n,e){const t=pt(n=be(n,et)),r=new dP;return aP(t,n._databaseId,e,r),r}function EP(n,e){return cP(pt(n=be(n,et)),e).then(t=>t?new Bt(n,null,t.query):null)}function Xv(n){if(n._initialized||n._terminated)throw new B(O.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Pn(Ze.fromBase64String(e))}catch(t){throw new B(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Pn(Ze.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let br=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new B(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ze(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yi=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new B(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new B(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return fe(this._lat,e._lat)||fe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TP=/^__.*__$/;class wP{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Gn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Is(e,this.data,t,this.fieldTransforms)}}class Zv{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Gn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function eI(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ne()}}class Xc{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.yu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(e){return new Xc(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.vu(e),i}Cu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Su({path:r,Du:!1});return i.yu(),i}Fu(e){return this.Su({path:void 0,Du:!0})}Mu(e){return yc(e,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}yu(){if(this.path)for(let e=0;e<this.path.length;e++)this.vu(this.path.get(e))}vu(e){if(e.length===0)throw this.Mu("Document fields must not be empty");if(eI(this.wu)&&TP.test(e))throw this.Mu('Document fields cannot begin and end with "__"')}}class bP{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Zo(e)}Nu(e,t,r,i=!1){return new Xc({wu:e,methodName:t,Ou:r,path:ze.emptyPath(),Du:!1,xu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function vi(n){const e=n._freezeSettings(),t=Zo(n._databaseId);return new bP(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Zc(n,e,t,r,i,s={}){const o=n.Nu(s.merge||s.mergeFields?2:0,e,t,i);_d("Data must be an object, but it was:",o,r);const a=rI(r,o);let l,u;if(s.merge)l=new zt(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const h=[];for(const f of s.mergeFields){const m=ku(e,f,t);if(!o.contains(m))throw new B(O.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);sI(h,m)||h.push(m)}l=new zt(h),u=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,u=o.fieldTransforms;return new wP(new It(a),l,u)}class na extends yi{_toFieldTransform(e){if(e.wu!==2)throw e.wu===1?e.Mu(`${this._methodName}() can only appear at the top level of your update data`):e.Mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof na}}function tI(n,e,t){return new Xc({wu:3,Ou:e.settings.Ou,methodName:n._methodName,Du:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class hd extends yi{_toFieldTransform(e){return new Yo(e.path,new ss)}isEqual(e){return e instanceof hd}}class dd extends yi{constructor(e,t){super(e),this.Lu=t}_toFieldTransform(e){const t=tI(this,e,!0),r=this.Lu.map(s=>Ii(s,t)),i=new ci(r);return new Yo(e.path,i)}isEqual(e){return e instanceof dd&&To(this.Lu,e.Lu)}}class fd extends yi{constructor(e,t){super(e),this.Lu=t}_toFieldTransform(e){const t=tI(this,e,!0),r=this.Lu.map(s=>Ii(s,t)),i=new li(r);return new Yo(e.path,i)}isEqual(e){return e instanceof fd&&To(this.Lu,e.Lu)}}class pd extends yi{constructor(e,t){super(e),this.Bu=t}_toFieldTransform(e){const t=new os(e.serializer,Dy(e.serializer,this.Bu));return new Yo(e.path,t)}isEqual(e){return e instanceof pd&&this.Bu===e.Bu}}function md(n,e,t,r){const i=n.Nu(1,e,t);_d("Data must be an object, but it was:",i,r);const s=[],o=It.empty();_i(r,(l,u)=>{const h=yd(e,l,t);u=st(u);const f=i.Cu(h);if(u instanceof na)s.push(h);else{const m=Ii(u,f);m!=null&&(s.push(h),o.set(h,m))}});const a=new zt(s);return new Zv(o,a,i.fieldTransforms)}function gd(n,e,t,r,i,s){const o=n.Nu(1,e,t),a=[ku(e,r,t)],l=[i];if(s.length%2!=0)throw new B(O.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)a.push(ku(e,s[m])),l.push(s[m+1]);const u=[],h=It.empty();for(let m=a.length-1;m>=0;--m)if(!sI(u,a[m])){const _=a[m];let R=l[m];R=st(R);const x=o.Cu(_);if(R instanceof na)u.push(_);else{const N=Ii(R,x);N!=null&&(u.push(_),h.set(_,N))}}const f=new zt(u);return new Zv(h,f,o.fieldTransforms)}function nI(n,e,t,r=!1){return Ii(t,n.Nu(r?4:3,e))}function Ii(n,e){if(iI(n=st(n)))return _d("Unsupported field value:",e,n),rI(n,e);if(n instanceof yi)return function(r,i){if(!eI(i.wu))throw i.Mu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Mu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Du&&e.wu!==4)throw e.Mu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=Ii(a,i.Fu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=st(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Dy(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=He.fromDate(r);return{timestampValue:as(i.serializer,s)}}if(r instanceof He){const s=new He(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:as(i.serializer,s)}}if(r instanceof Jc)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Pn)return{bytesValue:jy(i.serializer,r._byteString)};if(r instanceof Je){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Mh(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ud)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Mu("VectorValues must only contain numeric values.");return Dh(a.serializer,l)})}}}}}}(r,i);throw i.Mu(`Unsupported field value: ${Yc(r)}`)}(n,e)}function rI(n,e){const t={};return uy(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):_i(n,(r,i)=>{const s=Ii(i,e.bu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function iI(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof He||n instanceof Jc||n instanceof Pn||n instanceof Je||n instanceof yi||n instanceof ud)}function _d(n,e,t){if(!iI(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=Yc(t);throw r==="an object"?e.Mu(n+" a custom object"):e.Mu(n+" "+r)}}function ku(n,e,t){if((e=st(e))instanceof br)return e._internalPath;if(typeof e=="string")return yd(n,e);throw yc("Field path arguments must be of type string or ",n,!1,void 0,t)}const AP=new RegExp("[~\\*/\\[\\]]");function yd(n,e,t){if(e.search(AP)>=0)throw yc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new br(...e.split("."))._internalPath}catch{throw yc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function yc(n,e,t,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new B(O.INVALID_ARGUMENT,a+n+l)}function sI(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Je(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new SP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(el("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class SP extends Oo{data(){return super.data()}}function el(n,e){return typeof e=="string"?yd(n,e):e instanceof br?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oI(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new B(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class vd{}class ra extends vd{}function nr(n,e,...t){let r=[];e instanceof vd&&r.push(e),r=r.concat(t),function(s){const o=s.filter(l=>l instanceof Id).length,a=s.filter(l=>l instanceof tl).length;if(o>1||o>0&&a>0)throw new B(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class tl extends ra{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new tl(e,t,r)}_apply(e){const t=this._parse(e);return cI(e._query,t),new Bt(e.firestore,e.converter,Iu(e._query,t))}_parse(e){const t=vi(e.firestore);return function(s,o,a,l,u,h,f){let m;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new B(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){Pm(f,h);const _=[];for(const R of f)_.push(Rm(l,s,R));m={arrayValue:{values:_}}}else m=Rm(l,s,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||Pm(f,h),m=nI(a,o,f,h==="in"||h==="not-in");return ye.create(u,h,m)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function RP(n,e,t){const r=e,i=el("where",n);return tl._create(i,r,t)}class Id extends vd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Id(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Ve.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)cI(o,l),o=Iu(o,l)}(e._query,t),new Bt(e.firestore,e.converter,Iu(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ed extends ra{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Ed(e,t)}_apply(e){const t=function(i,s,o){if(i.startAt!==null)throw new B(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new B(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new xo(s,o)}(e._query,this._field,this._direction);return new Bt(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new $n(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function PP(n,e="asc"){const t=e,r=el("orderBy",n);return Ed._create(r,t)}class nl extends ra{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new nl(e,t,r)}_apply(e){return new Bt(e.firestore,e.converter,lc(e._query,this._limit,this._limitType))}}function CP(n){return $v("limit",n),nl._create("limit",n,"F")}function DP(n){return $v("limitToLast",n),nl._create("limitToLast",n,"L")}class rl extends ra{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new rl(e,t,r)}_apply(e){const t=aI(e,this.type,this._docOrFields,this._inclusive);return new Bt(e.firestore,e.converter,function(i,s){return new $n(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}}function xP(...n){return rl._create("startAt",n,!0)}function VP(...n){return rl._create("startAfter",n,!1)}class il extends ra{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new il(e,t,r)}_apply(e){const t=aI(e,this.type,this._docOrFields,this._inclusive);return new Bt(e.firestore,e.converter,function(i,s){return new $n(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,t))}}function NP(...n){return il._create("endBefore",n,!1)}function OP(...n){return il._create("endAt",n,!0)}function aI(n,e,t,r){if(t[0]=st(t[0]),t[0]instanceof Oo)return function(s,o,a,l,u){if(!l)throw new B(O.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const h=[];for(const f of Ji(s))if(f.field.isKeyField())h.push(oi(o,l.key));else{const m=l.data.field(f.field);if(Bc(m))throw new B(O.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const _=f.field.canonicalString();throw new B(O.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${_}' (used as the orderBy) does not exist.`)}h.push(m)}return new Tr(h,u)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=vi(n.firestore);return function(o,a,l,u,h,f){const m=o.explicitOrderBy;if(h.length>m.length)throw new B(O.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const _=[];for(let R=0;R<h.length;R++){const x=h[R];if(m[R].field.isKeyField()){if(typeof x!="string")throw new B(O.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof x}`);if(!Ph(o)&&x.indexOf("/")!==-1)throw new B(O.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${x}' contains a slash.`);const N=o.path.child(_e.fromString(x));if(!Y.isDocumentKey(N))throw new B(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);const j=new Y(N);_.push(oi(a,j))}else{const N=nI(l,u,x);_.push(N)}}return new Tr(_,f)}(n._query,n.firestore._databaseId,i,e,t,r)}}function Rm(n,e,t){if(typeof(t=st(t))=="string"){if(t==="")throw new B(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ph(e)&&t.indexOf("/")!==-1)throw new B(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(_e.fromString(t));if(!Y.isDocumentKey(r))throw new B(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return oi(n,new Y(r))}if(t instanceof Je)return oi(n,t._key);throw new B(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Yc(t)}.`)}function Pm(n,e){if(!Array.isArray(n)||n.length===0)throw new B(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function cI(n,e){const t=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new B(O.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new B(O.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Td{convertValue(e,t="none"){switch(si(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ge(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(vr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ne()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return _i(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;const s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Ge(o.doubleValue));return new ud(s)}convertGeoPoint(e){return new Jc(Ge(e.latitude),Ge(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Sh(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Po(e));default:return null}}convertTimestamp(e){const t=Un(e);return new He(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=_e.fromString(e);ae(Zy(r));const i=new Ir(r.get(1),r.get(3)),s=new Y(r.popFirst(5));return i.isEqual(t)||tt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sl(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class kP extends Td{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Je(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}let qn=class extends Oo{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new lo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(el("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},lo=class extends qn{data(e={}){return super.data(e)}},Ar=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Zr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new lo(this._firestore,this._userDataWriter,r.key,r,new Zr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new B(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new lo(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Zr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new lo(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Zr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,h=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:MP(a.type),doc:l,oldIndex:u,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function MP(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ne()}}function lI(n,e){return n instanceof qn&&e instanceof qn?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Ar&&e instanceof Ar&&n._firestore===e._firestore&&Wv(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LP(n){n=be(n,Je);const e=be(n.firestore,et);return Bv(pt(e),n._key).then(t=>wd(e,n,t))}class Ei extends Td{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Je(this.firestore,null,t)}}function FP(n){n=be(n,Je);const e=be(n.firestore,et),t=pt(e),r=new Ei(e);return iP(t,n._key).then(i=>new qn(e,r,n._key,i,new Zr(i!==null&&i.hasLocalMutations,!0),n.converter))}function BP(n){n=be(n,Je);const e=be(n.firestore,et);return Bv(pt(e),n._key,{source:"server"}).then(t=>wd(e,n,t))}function UP(n){n=be(n,Bt);const e=be(n.firestore,et),t=pt(e),r=new Ei(e);return oI(n._query),Uv(t,n._query).then(i=>new Ar(e,r,n,i))}function qP(n){n=be(n,Bt);const e=be(n.firestore,et),t=pt(e),r=new Ei(e);return sP(t,n._query).then(i=>new Ar(e,r,n,i))}function jP(n){n=be(n,Bt);const e=be(n.firestore,et),t=pt(e),r=new Ei(e);return Uv(t,n._query,{source:"server"}).then(i=>new Ar(e,r,n,i))}function Cm(n,e,t){n=be(n,Je);const r=be(n.firestore,et),i=sl(n.converter,e,t);return ia(r,[Zc(vi(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Ke.none())])}function Dm(n,e,t,...r){n=be(n,Je);const i=be(n.firestore,et),s=vi(i);let o;return o=typeof(e=st(e))=="string"||e instanceof br?gd(s,"updateDoc",n._key,e,t,r):md(s,"updateDoc",n._key,e),ia(i,[o.toMutation(n._key,Ke.exists(!0))])}function $P(n){return ia(be(n.firestore,et),[new Es(n._key,Ke.none())])}function GP(n,e){const t=be(n.firestore,et),r=_c(n),i=sl(n.converter,e);return ia(t,[Zc(vi(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Ke.exists(!1))]).then(()=>r)}function uI(n,...e){var t,r,i;n=st(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Ou(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Ou(e[o])){const f=e[o];e[o]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[o+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[o+2]=(i=f.complete)===null||i===void 0?void 0:i.bind(f)}let l,u,h;if(n instanceof Je)u=be(n.firestore,et),h=vs(n._key.path),l={next:f=>{e[o]&&e[o](wd(u,n,f))},error:e[o+1],complete:e[o+2]};else{const f=be(n,Bt);u=be(f.firestore,et),h=f._query;const m=new Ei(u);l={next:_=>{e[o]&&e[o](new Ar(u,m,f,_))},error:e[o+1],complete:e[o+2]},oI(n._query)}return function(m,_,R,x){const N=new Qc(x),j=new Zh(_,N,R);return m.asyncQueue.enqueueAndForget(async()=>Yh(await fs(m),j)),()=>{N.za(),m.asyncQueue.enqueueAndForget(async()=>Jh(await fs(m),j))}}(pt(u),h,a,l)}function zP(n,e){return oP(pt(n=be(n,et)),Ou(e)?e:{next:e})}function ia(n,e){return function(r,i){const s=new ft;return r.asyncQueue.enqueueAndForget(async()=>OR(await cd(r),i,s)),s.promise}(pt(n),e)}function wd(n,e,t){const r=t.docs.get(e._key),i=new Ei(n);return new qn(n,i,e._key,r,new Zr(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KP={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let HP=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=vi(e)}set(e,t,r){this._verifyNotCommitted();const i=lr(e,this._firestore),s=sl(i.converter,t,r),o=Zc(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,Ke.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=lr(e,this._firestore);let o;return o=typeof(t=st(t))=="string"||t instanceof br?gd(this._dataReader,"WriteBatch.update",s._key,t,r,i):md(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Ke.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=lr(e,this._firestore);return this._mutations=this._mutations.concat(new Es(t._key,Ke.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new B(O.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function lr(n,e){if((n=st(n)).firestore!==e)throw new B(O.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let QP=class extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=vi(t)}get(t){const r=lr(t,this._firestore),i=new kP(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return ne();const o=s[0];if(o.isFoundDocument())return new Oo(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Oo(this._firestore,i,r._key,null,r.converter);throw ne()})}set(t,r,i){const s=lr(t,this._firestore),o=sl(s.converter,r,i),a=Zc(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){const o=lr(t,this._firestore);let a;return a=typeof(r=st(r))=="string"||r instanceof br?gd(this._dataReader,"Transaction.update",o._key,r,i,s):md(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){const r=lr(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=lr(e,this._firestore),r=new Ei(this._firestore);return super.get(e).then(i=>new qn(this._firestore,r,t._key,i._document,new Zr(!1,!1),t.converter))}};function WP(n,e,t){n=be(n,et);const r=Object.assign(Object.assign({},KP),t);return function(s){if(s.maxAttempts<1)throw new B(O.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const l=new ft;return s.asyncQueue.enqueueAndForget(async()=>{const u=await tP(s);new ZR(s.asyncQueue,u,a,o,l).ru()}),l.promise}(pt(n),i=>e(new QP(n,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YP(){return new na("deleteField")}function JP(){return new hd("serverTimestamp")}function XP(...n){return new dd("arrayUnion",n)}function ZP(...n){return new fd("arrayRemove",n)}function eC(n){return new pd("increment",n)}(function(e,t=!0){(function(i){ys=i})(vh),ts(new ii("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new et(new i0(r.getProvider("auth-internal")),new c0(r.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new B(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ir(u.options.projectId,h)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Fn(Ep,"4.7.2",e),Fn(Ep,"4.7.2","esm2017")})();const tC="@firebase/firestore-compat",nC="0.3.37";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bd(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new B("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xm(){if(typeof Uint8Array>"u")throw new B("unimplemented","Uint8Arrays are not available in this environment.")}function Vm(){if(!O0())throw new B("unimplemented","Blobs are unavailable in Firestore in this environment.")}class ko{constructor(e){this._delegate=e}static fromBase64String(e){return Vm(),new ko(Pn.fromBase64String(e))}static fromUint8Array(e){return xm(),new ko(Pn.fromUint8Array(e))}toBase64(){return Vm(),this._delegate.toBase64()}toUint8Array(){return xm(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mu(n){return rC(n,["next","error","complete"])}function rC(n,e){if(typeof n!="object"||n===null)return!1;const t=n;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{enableIndexedDbPersistence(e,t){return pP(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return mP(e._delegate)}clearIndexedDbPersistence(e){return gP(e._delegate)}}class hI{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Ir||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&pn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){lP(this._delegate,e,t,r)}enableNetwork(){return yP(this._delegate)}disableNetwork(){return vP(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,jv("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return _P(this._delegate)}onSnapshotsInSync(e){return zP(this._delegate,e)}get app(){if(!this._appCompat)throw new B("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new ps(this,Hv(this._delegate,e))}catch(t){throw kt(t,"collection()","Firestore.collection()")}}doc(e){try{return new on(this,_c(this._delegate,e))}catch(t){throw kt(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ot(this,uP(this._delegate,e))}catch(t){throw kt(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return WP(this._delegate,t=>e(new dI(this,t)))}batch(){return pt(this._delegate),new fI(new HP(this._delegate,e=>ia(this._delegate,e)))}loadBundle(e){return IP(this._delegate,e)}namedQuery(e){return EP(this._delegate,e).then(t=>t?new Ot(this,t):null)}}class ol extends Td{constructor(e){super(),this.firestore=e}convertBytes(e){return new ko(new Pn(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return on.forKey(t,this.firestore,null)}}function sC(n){e0(n)}class dI{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new ol(e)}get(e){const t=ei(e);return this._delegate.get(t).then(r=>new Mo(this._firestore,new qn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=ei(e);return r?(bd("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=ei(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=ei(e);return this._delegate.delete(t),this}}class fI{constructor(e){this._delegate=e}set(e,t,r){const i=ei(e);return r?(bd("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=ei(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=ei(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class fi{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new lo(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Lo(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=fi.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new fi(e,new ol(e),t),i.set(t,s)),s}}fi.INSTANCES=new WeakMap;class on{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ol(e)}static forPath(e,t,r){if(e.length%2!==0)throw new B("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new on(t,new Je(t._delegate,r,new Y(e)))}static forKey(e,t,r){return new on(t,new Je(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new ps(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new ps(this.firestore,Hv(this._delegate,e))}catch(t){throw kt(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=st(e),e instanceof Je?Qv(this._delegate,e):!1}set(e,t){t=bd("DocumentReference.set",t);try{return t?Cm(this._delegate,e,t):Cm(this._delegate,e)}catch(r){throw kt(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?Dm(this._delegate,e):Dm(this._delegate,e,t,...r)}catch(i){throw kt(i,"updateDoc()","DocumentReference.update()")}}delete(){return $P(this._delegate)}onSnapshot(...e){const t=pI(e),r=mI(e,i=>new Mo(this.firestore,new qn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return uI(this._delegate,t,r)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=FP(this._delegate):(e==null?void 0:e.source)==="server"?t=BP(this._delegate):t=LP(this._delegate),t.then(r=>new Mo(this.firestore,new qn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new on(this.firestore,e?this._delegate.withConverter(fi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function kt(n,e,t){return n.message=n.message.replace(e,t),n}function pI(n){for(const e of n)if(typeof e=="object"&&!Mu(e))return e;return{}}function mI(n,e){var t,r;let i;return Mu(n[0])?i=n[0]:Mu(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}class Mo{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new on(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return lI(this._delegate,e._delegate)}}class Lo extends Mo{data(e){const t=this._delegate.data(e);return this._delegate._converter||t0(t!==void 0),t}}class Ot{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ol(e)}where(e,t,r){try{return new Ot(this.firestore,nr(this._delegate,RP(e,t,r)))}catch(i){throw kt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Ot(this.firestore,nr(this._delegate,PP(e,t)))}catch(r){throw kt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Ot(this.firestore,nr(this._delegate,CP(e)))}catch(t){throw kt(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Ot(this.firestore,nr(this._delegate,DP(e)))}catch(t){throw kt(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Ot(this.firestore,nr(this._delegate,xP(...e)))}catch(t){throw kt(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Ot(this.firestore,nr(this._delegate,VP(...e)))}catch(t){throw kt(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Ot(this.firestore,nr(this._delegate,NP(...e)))}catch(t){throw kt(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Ot(this.firestore,nr(this._delegate,OP(...e)))}catch(t){throw kt(t,"endAt()","Query.endAt()")}}isEqual(e){return Wv(this._delegate,e._delegate)}get(e){let t;return(e==null?void 0:e.source)==="cache"?t=qP(this._delegate):(e==null?void 0:e.source)==="server"?t=jP(this._delegate):t=UP(this._delegate),t.then(r=>new Lu(this.firestore,new Ar(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=pI(e),r=mI(e,i=>new Lu(this.firestore,new Ar(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return uI(this._delegate,t,r)}withConverter(e){return new Ot(this.firestore,e?this._delegate.withConverter(fi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class oC{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Lo(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Lu{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Ot(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Lo(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new oC(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new Lo(this._firestore,r))})}isEqual(e){return lI(this._delegate,e._delegate)}}class ps extends Ot{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new on(this.firestore,e):null}doc(e){try{return e===void 0?new on(this.firestore,_c(this._delegate)):new on(this.firestore,_c(this._delegate,e))}catch(t){throw kt(t,"doc()","CollectionReference.doc()")}}add(e){return GP(this._delegate,e).then(t=>new on(this.firestore,t))}isEqual(e){return Qv(this._delegate,e._delegate)}withConverter(e){return new ps(this.firestore,e?this._delegate.withConverter(fi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function ei(n){return be(n,Je)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(...e){this._delegate=new br(...e)}static documentId(){return new Ad(ze.keyField().canonicalString())}isEqual(e){return e=st(e),e instanceof br?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr{constructor(e){this._delegate=e}static serverTimestamp(){const e=JP();return e._methodName="FieldValue.serverTimestamp",new Jr(e)}static delete(){const e=YP();return e._methodName="FieldValue.delete",new Jr(e)}static arrayUnion(...e){const t=XP(...e);return t._methodName="FieldValue.arrayUnion",new Jr(t)}static arrayRemove(...e){const t=ZP(...e);return t._methodName="FieldValue.arrayRemove",new Jr(t)}static increment(e){const t=eC(e);return t._methodName="FieldValue.increment",new Jr(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aC={Firestore:hI,GeoPoint:Jc,Timestamp:He,Blob:ko,Transaction:dI,WriteBatch:fI,DocumentReference:on,DocumentSnapshot:Mo,Query:Ot,QueryDocumentSnapshot:Lo,QuerySnapshot:Lu,CollectionReference:ps,FieldPath:Ad,FieldValue:Jr,setLogLevel:sC,CACHE_SIZE_UNLIMITED:fP};function cC(n,e){n.INTERNAL.registerComponent(new ii("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},aC)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lC(n){cC(n,(e,t)=>new hI(e,t,new iC)),n.registerVersion(tC,nC)}lC(Lc);const uC={apiKey:"AIzaSyAXnxlIbkU9Y9TWl1ehzgyPrbEZe37PIVw",authDomain:"invoice-app-yt-004.firebaseapp.com",projectId:"invoice-app-yt-004",storageBucket:"invoice-app-yt-004.appspot.com",messagingSenderId:"362742480382",appId:"1:362742480382:web:f743fcc6b35e97bc4cd4af"};Lc.initializeApp(uC);let ji=Lc.firestore();const hC={name:"loading"},dC={class:"loading"};function fC(n,e,t,r,i,s){return Ie(),De("div",dC,e[0]||(e[0]=[P("span",null,null,-1)]))}const pC=Pr(hC,[["render",fC]]),mC="data:image/svg+xml,%3csvg%20width='13'%20height='16'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M11.583%203.556v10.666c0%20.982-.795%201.778-1.777%201.778H2.694a1.777%201.777%200%2001-1.777-1.778V3.556h10.666zM8.473%200l.888.889h3.111v1.778H.028V.889h3.11L4.029%200h4.444z'%20fill='%23888EB0'%20fill-rule='nonzero'/%3e%3c/svg%3e",gI="data:image/svg+xml,%3csvg%20width='11'%20height='11'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M6.313%2010.023v-3.71h3.71v-2.58h-3.71V.023h-2.58v3.71H.023v2.58h3.71v3.71z'%20fill='%237C5DFA'%20fill-rule='nonzero'/%3e%3c/svg%3e",gC={name:"invoiceModal",data(){return{dateOptions:{year:"numeric",month:"short",day:"numeric"},docId:null,loading:null,billerStreetAddress:null,billerCity:null,billerZipCode:null,billerCountry:null,clientName:null,clientEmail:null,clientStreetAddress:null,clientCity:null,clientZipCode:null,clientCountry:null,invoiceDateUnix:null,invoiceDate:null,paymentTerms:null,paymentDueDateUnix:null,paymentDueDate:null,productDescription:null,invoicePending:null,invoiceDraft:null,invoiceItemList:[],invoiceTotal:0}},components:{Loading:pC},created(){if(this.editInvoice||(this.invoiceDateUnix=Date.now(),this.invoiceDate=new Date(this.invoiceDateUnix).toLocaleDateString("en-us",this.dateOptions)),this.editInvoice){const n=this.currentInvoiceArray[0];this.docId=n.docId,this.billerStreetAddress=n.billerStreetAddress,this.billerCity=n.billerCity,this.billerZipCode=n.billerZipCode,this.billerCountry=n.billerCountry,this.clientName=n.clientName,this.clientEmail=n.clientEmail,this.clientStreetAddress=n.clientStreetAddress,this.clientCity=n.clientCity,this.clientZipCode=n.clientZipCode,this.clientCountry=n.clientCountry,this.invoiceDateUnix=n.invoiceDateUnix,this.invoiceDate=n.invoiceDate,this.paymentTerms=n.paymentTerms,this.paymentDueDateUnix=n.paymentDueDateUnix,this.paymentDueDate=n.paymentDueDate,this.productDescription=n.productDescription,this.invoicePending=n.invoicePending,this.invoiceDraft=n.invoiceDraft,this.invoiceItemList=n.invoiceItemList,this.invoiceTotal=n.invoiceTotal}},methods:{...kc(["TOGGLE_INVOICE","TOGGLE_MODAL","TOGGLE_EDIT_INVOICE"]),...dh(["UPDATE_INVOICE","GET_INVOICES"]),checkClick(n){n.target===this.$refs.invoiceWrap&&this.TOGGLE_MODAL()},closeInvoice(){this.TOGGLE_INVOICE(),this.editInvoice&&this.TOGGLE_EDIT_INVOICE()},addNewInvoiceItem(){this.invoiceItemList.push({id:cp(),itemName:"",qty:"",price:0,total:0})},deleteInvoiceItem(n){this.invoiceItemList=this.invoiceItemList.filter(e=>e.id!==n)},publishInvoice(){this.invoicePending=!0},calculateInvoiceTotal(){this.invoiceTotal=0,this.invoiceItemList.forEach(n=>{this.invoiceTotal+=n.total})},saveDraft(){this.invoiceDraft=!0},async uploadInvoice(){if(this.invoiceItemList.length<=0){alert("Please ensure you fill out work items");return}this.loading=!0,this.calculateInvoiceTotal(),await ji.collection("invoices").doc().set({invoiceId:cp(6),billerStreetAddress:this.billerStreetAddress,billerCity:this.billerCity,billerZipCode:this.billerZipCode,billerCountry:this.billerCountry,clientName:this.clientName,clientEmail:this.clientEmail,clientStreetAddress:this.clientStreetAddress,clientCity:this.clientCity,clientZipCode:this.clientZipCode,clientCountry:this.clientCountry,invoiceDateUnix:this.invoiceDateUnix,invoiceDate:this.invoiceDate,paymentTerms:this.paymentTerms,paymentDueDateUnix:this.paymentDueDateUnix,paymentDueDate:this.paymentDueDate,productDescription:this.productDescription,invoicePending:this.invoicePending,invoiceDraft:this.invoiceDraft,invoiceItemList:this.invoiceItemList,invoiceTotal:this.invoiceTotal,invoicePaid:null}),this.loading=!1,this.TOGGLE_INVOICE(),this.GET_INVOICES()},async updateInvoice(){if(this.invoiceItemList.length<=0){alert("Please ensure you fill out work items");return}this.loading=!0,this.calculateInvoiceTotal(),await ji.collection("invoices").doc(this.docId).update({billerStreetAddress:this.billerStreetAddress,billerCity:this.billerCity,billerZipCode:this.billerZipCode,billerCountry:this.billerCountry,clientName:this.clientName,clientEmail:this.clientEmail,clientStreetAddress:this.clientStreetAddress,clientCity:this.clientCity,clientZipCode:this.clientZipCode,clientCountry:this.clientCountry,paymentTerms:this.paymentTerms,paymentDueDate:this.paymentDueDate,paymentDueDateUnix:this.paymentDueDateUnix,productDescription:this.productDescription,invoiceItemList:this.invoiceItemList,invoiceTotal:this.invoiceTotal}),this.loading=!1;const e={docId:this.docId,routeId:this.$route.params.invoiceId};this.UPDATE_INVOICE(e)},submitForm(){if(this.editInvoice){this.updateInvoice();return}this.uploadInvoice()}},watch:{paymentTerms(){const n=new Date;this.paymentDueDateUnix=n.setDate(n.getDate()+parseInt(this.paymentTerms)),this.paymentDueDate=new Date(this.paymentDueDateUnix).toLocaleDateString("en-us",this.dateOptions)}},computed:{...zo(["editInvoice","currentInvoiceArray"])}},_C={key:0},yC={key:1},vC={class:"bill-from flex flex-column"},IC={class:"input flex flex-column"},EC={class:"location-details flex"},TC={class:"input flex flex-column"},wC={class:"input flex flex-column"},bC={class:"input flex flex-column"},AC={class:"bill-to flex flex-column"},SC={class:"input flex flex-column"},RC={class:"input flex flex-column"},PC={class:"input flex flex-column"},CC={class:"location-details flex"},DC={class:"input flex flex-column"},xC={class:"input flex flex-column"},VC={class:"input flex flex-column"},NC={class:"invoice-work flex flex-column"},OC={class:"payment flex"},kC={class:"input flex flex-column"},MC={class:"input flex flex-column"},LC={class:"input flex flex-column"},FC={class:"input flex flex-column"},BC={class:"work-items"},UC={class:"item-list"},qC={class:"item-name"},jC=["onUpdate:modelValue"],$C={class:"qty"},GC=["onUpdate:modelValue"],zC={class:"price"},KC=["onUpdate:modelValue"],HC={class:"total flex"},QC=["onClick"],WC={class:"save flex"},YC={class:"left"},JC={class:"right flex"},XC={key:2,type:"submit",class:"purple"};function ZC(n,e,t,r,i,s){const o=ur("Loading");return Ie(),De("div",{class:"invoice-wrap flex flex-column",onClick:e[19]||(e[19]=(...a)=>s.checkClick&&s.checkClick(...a)),ref:"invoiceWrap"},[P("form",{onSubmit:e[18]||(e[18]=xw((...a)=>s.submitForm&&s.submitForm(...a),["prevent"])),class:"invoice-content"},[ot(dt(o,null,null,512),[[u_,i.loading]]),n.editInvoice?(Ie(),De("h1",yC,"Edit Invoice")):(Ie(),De("h1",_C,"New Invoice")),P("div",vC,[e[24]||(e[24]=P("h4",null,"Bill From",-1)),P("div",IC,[e[20]||(e[20]=P("label",{for:"billerStreetAddress"},"Street Address",-1)),ot(P("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>i.billerStreetAddress=a),type:"text",id:"billerStreetAddress",required:""},null,512),[[At,i.billerStreetAddress]])]),P("div",EC,[P("div",TC,[e[21]||(e[21]=P("label",{for:"billerCity"},"City",-1)),ot(P("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>i.billerCity=a),type:"text",id:"billerCity",required:""},null,512),[[At,i.billerCity]])]),P("div",wC,[e[22]||(e[22]=P("label",{for:"billerZipCode"},"Zip Code",-1)),ot(P("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>i.billerZipCode=a),type:"text",id:"billerZipCode",required:""},null,512),[[At,i.billerZipCode]])]),P("div",bC,[e[23]||(e[23]=P("label",{for:"billerCountry"},"Country",-1)),ot(P("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>i.billerCountry=a),type:"text",id:"billerCountry",required:""},null,512),[[At,i.billerCountry]])])])]),P("div",AC,[e[31]||(e[31]=P("h4",null,"Bill To",-1)),P("div",SC,[e[25]||(e[25]=P("label",{for:"clientName"},"Client's Name",-1)),ot(P("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>i.clientName=a),type:"text",id:"clientName",required:""},null,512),[[At,i.clientName]])]),P("div",RC,[e[26]||(e[26]=P("label",{for:"clientEmail"},"Client's Email",-1)),ot(P("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>i.clientEmail=a),type:"text",id:"clientEmail",required:""},null,512),[[At,i.clientEmail]])]),P("div",PC,[e[27]||(e[27]=P("label",{for:"clientStreetAddress"},"Street Address",-1)),ot(P("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>i.clientStreetAddress=a),type:"text",id:"clientStreetAddress",required:""},null,512),[[At,i.clientStreetAddress]])]),P("div",CC,[P("div",DC,[e[28]||(e[28]=P("label",{for:"clientCity"},"City",-1)),ot(P("input",{"onUpdate:modelValue":e[7]||(e[7]=a=>i.clientCity=a),type:"text",id:"clientCity",required:""},null,512),[[At,i.clientCity]])]),P("div",xC,[e[29]||(e[29]=P("label",{for:"clientZipCode"},"Zip Code",-1)),ot(P("input",{"onUpdate:modelValue":e[8]||(e[8]=a=>i.clientZipCode=a),type:"text",id:"clientZipCode",required:""},null,512),[[At,i.clientZipCode]])]),P("div",VC,[e[30]||(e[30]=P("label",{for:"clientCountry"},"Country",-1)),ot(P("input",{"onUpdate:modelValue":e[9]||(e[9]=a=>i.clientCountry=a),type:"text",id:"clientCountry",required:""},null,512),[[At,i.clientCountry]])])])]),P("div",NC,[P("div",OC,[P("div",kC,[e[32]||(e[32]=P("label",{for:"invoiceDate"},"Invoice Date",-1)),ot(P("input",{"onUpdate:modelValue":e[10]||(e[10]=a=>i.invoiceDate=a),type:"text",id:"invoiceDate",disabled:""},null,512),[[At,i.invoiceDate]])]),P("div",MC,[e[33]||(e[33]=P("label",{for:"paymentDueDate"},"Payment Due",-1)),ot(P("input",{"onUpdate:modelValue":e[11]||(e[11]=a=>i.paymentDueDate=a),type:"text",id:"paymentDueDate",disabled:""},null,512),[[At,i.paymentDueDate]])])]),P("div",LC,[e[35]||(e[35]=P("label",{for:"paymentTerms"},"Payment Terms",-1)),ot(P("select",{"onUpdate:modelValue":e[12]||(e[12]=a=>i.paymentTerms=a),id:"paymentTerms",required:""},e[34]||(e[34]=[P("option",{value:"30"},"Net 30 Days",-1),P("option",{value:"60"},"Net 60 Days",-1)]),512),[[Pw,i.paymentTerms]])]),P("div",FC,[e[36]||(e[36]=P("label",{for:"productDescription"},"Product Description",-1)),ot(P("input",{"onUpdate:modelValue":e[13]||(e[13]=a=>i.productDescription=a),type:"text",id:"productDescription",required:""},null,512),[[At,i.productDescription]])]),P("div",BC,[e[39]||(e[39]=P("h3",null,"Item List",-1)),P("table",UC,[e[37]||(e[37]=P("tr",{class:"table-heading flex"},[P("th",{class:"item-name"},"Item Name"),P("th",{class:"qty"},"Qty"),P("th",{class:"price"},"Price"),P("th",{class:"total"},"Total")],-1)),(Ie(!0),De(Xt,null,ih(i.invoiceItemList,(a,l)=>(Ie(),De("tr",{class:"table-items flex",key:l},[P("td",qC,[ot(P("input",{type:"text","onUpdate:modelValue":u=>a.itemName=u},null,8,jC),[[At,a.itemName]])]),P("td",$C,[ot(P("input",{type:"text","onUpdate:modelValue":u=>a.qty=u},null,8,GC),[[At,a.qty]])]),P("td",zC,[ot(P("input",{type:"text","onUpdate:modelValue":u=>a.price=u},null,8,KC),[[At,a.price]])]),P("td",HC,"$"+Le(a.total=a.qty*a.price),1),P("img",{onClick:u=>s.deleteInvoiceItem(a.id),src:mC,alt:""},null,8,QC)]))),128))]),P("div",{onClick:e[14]||(e[14]=(...a)=>s.addNewInvoiceItem&&s.addNewInvoiceItem(...a)),class:"flex button"},e[38]||(e[38]=[P("img",{src:gI,alt:""},null,-1),Io(" Add New Item ")]))])]),P("div",WC,[P("div",YC,[P("button",{type:"button",onClick:e[15]||(e[15]=(...a)=>s.closeInvoice&&s.closeInvoice(...a)),class:"red"},"Cancel")]),P("div",JC,[n.editInvoice?Pt("",!0):(Ie(),De("button",{key:0,type:"submit",onClick:e[16]||(e[16]=(...a)=>s.saveDraft&&s.saveDraft(...a)),class:"dark-purple"},"Save Draft")),n.editInvoice?Pt("",!0):(Ie(),De("button",{key:1,type:"submit",onClick:e[17]||(e[17]=(...a)=>s.publishInvoice&&s.publishInvoice(...a)),class:"purple"},"Create Invoice")),n.editInvoice?(Ie(),De("button",XC,"Update Invoice")):Pt("",!0)])])],32)],512)}const e1=Pr(gC,[["render",ZC],["__scopeId","data-v-63e67101"]]),t1={name:"modal",methods:{...kc(["TOGGLE_MODAL","TOGGLE_INVOICE","TOGGLE_EDIT_INVOICE"]),closeModal(){this.TOGGLE_MODAL()},closeInvoice(){this.TOGGLE_MODAL(),this.TOGGLE_INVOICE(),this.editInvoice&&this.TOGGLE_EDIT_INVOICE()}},computed:{...zo(["editInvoice"])}},n1={class:"modal flex"},r1={class:"modal-content"},i1={class:"actions flex"};function s1(n,e,t,r,i,s){return Ie(),De("div",n1,[P("div",r1,[e[2]||(e[2]=P("p",null,"Are you sure you want to exit? Your changes will not be saved",-1)),P("div",i1,[P("button",{onClick:e[0]||(e[0]=(...o)=>s.closeModal&&s.closeModal(...o)),class:"purple"},"Return"),P("button",{onClick:e[1]||(e[1]=(...o)=>s.closeInvoice&&s.closeInvoice(...o)),class:"red"},"Close")])])])}const o1=Pr(t1,[["render",s1],["__scopeId","data-v-62803c62"]]),a1={data(){return{mobile:null}},components:{Navigation:fb,InvoiceModal:e1,Modal:o1},created(){this.GET_INVOICES(),this.checkScreen(),window.addEventListener("resize",this.checkScreen)},methods:{...dh(["GET_INVOICES"]),checkScreen(){if(window.innerWidth<=750){this.mobile=!0;return}this.mobile=!1}},computed:{...zo(["invoiceModal","modalActive","invoicesLoaded"])}},c1={key:0},l1={key:0,class:"app flex flex-column"},u1={class:"app-content flex flex-column"},h1={key:1,class:"mobile-message flex flex-column"};function d1(n,e,t,r,i,s){const o=ur("Navigation"),a=ur("Modal"),l=ur("InvoiceModal"),u=ur("router-view");return n.invoicesLoaded?(Ie(),De("div",c1,[i.mobile?(Ie(),De("div",h1,e[0]||(e[0]=[P("h2",null,"Sorry, this app is not supported on mobile devices",-1),P("p",null,"To view this app, please use a computer or Tablet",-1)]))):(Ie(),De("div",l1,[dt(o),P("div",u1,[n.modalActive?(Ie(),vo(a,{key:0})):Pt("",!0),dt(ow,{name:"invoice"},{default:Rc(()=>[n.invoiceModal?(Ie(),vo(l,{key:0})):Pt("",!0)]),_:1}),dt(u)])]))])):Pt("",!0)}const f1=Pr(a1,[["render",d1]]);/*!
  * vue-router v4.4.5
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const qi=typeof document<"u";function _I(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function p1(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&_I(n.default)}const xe=Object.assign;function Kl(n,e){const t={};for(const r in e){const i=e[r];t[r]=mn(i)?i.map(n):n(i)}return t}const uo=()=>{},mn=Array.isArray,yI=/#/g,m1=/&/g,g1=/\//g,_1=/=/g,y1=/\?/g,vI=/\+/g,v1=/%5B/g,I1=/%5D/g,II=/%5E/g,E1=/%60/g,EI=/%7B/g,T1=/%7C/g,TI=/%7D/g,w1=/%20/g;function Sd(n){return encodeURI(""+n).replace(T1,"|").replace(v1,"[").replace(I1,"]")}function b1(n){return Sd(n).replace(EI,"{").replace(TI,"}").replace(II,"^")}function Fu(n){return Sd(n).replace(vI,"%2B").replace(w1,"+").replace(yI,"%23").replace(m1,"%26").replace(E1,"`").replace(EI,"{").replace(TI,"}").replace(II,"^")}function A1(n){return Fu(n).replace(_1,"%3D")}function S1(n){return Sd(n).replace(yI,"%23").replace(y1,"%3F")}function R1(n){return n==null?"":S1(n).replace(g1,"%2F")}function Fo(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const P1=/\/$/,C1=n=>n.replace(P1,"");function Hl(n,e,t="/"){let r,i={},s="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(r=e.slice(0,l),s=e.slice(l+1,a>-1?a:e.length),i=n(s)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=N1(r??e,t),{fullPath:r+(s&&"?")+s+o,path:r,query:i,hash:Fo(o)}}function D1(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function Nm(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function x1(n,e,t){const r=e.matched.length-1,i=t.matched.length-1;return r>-1&&r===i&&ms(e.matched[r],t.matched[i])&&wI(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function ms(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function wI(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!V1(n[t],e[t]))return!1;return!0}function V1(n,e){return mn(n)?Om(n,e):mn(e)?Om(e,n):n===e}function Om(n,e){return mn(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function N1(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),i=r[r.length-1];(i===".."||i===".")&&r.push("");let s=t.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")s>1&&s--;else break;return t.slice(0,s).join("/")+"/"+r.slice(o).join("/")}const rr={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Bo;(function(n){n.pop="pop",n.push="push"})(Bo||(Bo={}));var ho;(function(n){n.back="back",n.forward="forward",n.unknown=""})(ho||(ho={}));function O1(n){if(!n)if(qi){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),C1(n)}const k1=/^[^#]+#/;function M1(n,e){return n.replace(k1,"#")+e}function L1(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const al=()=>({left:window.scrollX,top:window.scrollY});function F1(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),i=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!i)return;e=L1(i,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function km(n,e){return(history.state?history.state.position-e:-1)+n}const Bu=new Map;function B1(n,e){Bu.set(n,e)}function U1(n){const e=Bu.get(n);return Bu.delete(n),e}let q1=()=>location.protocol+"//"+location.host;function bI(n,e){const{pathname:t,search:r,hash:i}=e,s=n.indexOf("#");if(s>-1){let a=i.includes(n.slice(s))?n.slice(s).length:1,l=i.slice(a);return l[0]!=="/"&&(l="/"+l),Nm(l,"")}return Nm(t,n)+r+i}function j1(n,e,t,r){let i=[],s=[],o=null;const a=({state:m})=>{const _=bI(n,location),R=t.value,x=e.value;let N=0;if(m){if(t.value=_,e.value=m,o&&o===R){o=null;return}N=x?m.position-x.position:0}else r(_);i.forEach(j=>{j(t.value,R,{delta:N,type:Bo.pop,direction:N?N>0?ho.forward:ho.back:ho.unknown})})};function l(){o=t.value}function u(m){i.push(m);const _=()=>{const R=i.indexOf(m);R>-1&&i.splice(R,1)};return s.push(_),_}function h(){const{history:m}=window;m.state&&m.replaceState(xe({},m.state,{scroll:al()}),"")}function f(){for(const m of s)m();s=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",h)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",h,{passive:!0}),{pauseListeners:l,listen:u,destroy:f}}function Mm(n,e,t,r=!1,i=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:i?al():null}}function $1(n){const{history:e,location:t}=window,r={value:bI(n,t)},i={value:e.state};i.value||s(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function s(l,u,h){const f=n.indexOf("#"),m=f>-1?(t.host&&document.querySelector("base")?n:n.slice(f))+l:q1()+n+l;try{e[h?"replaceState":"pushState"](u,"",m),i.value=u}catch(_){console.error(_),t[h?"replace":"assign"](m)}}function o(l,u){const h=xe({},e.state,Mm(i.value.back,l,i.value.forward,!0),u,{position:i.value.position});s(l,h,!0),r.value=l}function a(l,u){const h=xe({},i.value,e.state,{forward:l,scroll:al()});s(h.current,h,!0);const f=xe({},Mm(r.value,l,null),{position:h.position+1},u);s(l,f,!1),r.value=l}return{location:r,state:i,push:a,replace:o}}function G1(n){n=O1(n);const e=$1(n),t=j1(n,e.state,e.location,e.replace);function r(s,o=!0){o||t.pauseListeners(),history.go(s)}const i=xe({location:"",base:n,go:r,createHref:M1.bind(null,n)},e,t);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>e.state.value}),i}function z1(n){return typeof n=="string"||n&&typeof n=="object"}function AI(n){return typeof n=="string"||typeof n=="symbol"}const SI=Symbol("");var Lm;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(Lm||(Lm={}));function gs(n,e){return xe(new Error,{type:n,[SI]:!0},e)}function Vn(n,e){return n instanceof Error&&SI in n&&(e==null||!!(n.type&e))}const Fm="[^/]+?",K1={sensitive:!1,strict:!1,start:!0,end:!0},H1=/[.+*?^${}()[\]/\\]/g;function Q1(n,e){const t=xe({},K1,e),r=[];let i=t.start?"^":"";const s=[];for(const u of n){const h=u.length?[]:[90];t.strict&&!u.length&&(i+="/");for(let f=0;f<u.length;f++){const m=u[f];let _=40+(t.sensitive?.25:0);if(m.type===0)f||(i+="/"),i+=m.value.replace(H1,"\\$&"),_+=40;else if(m.type===1){const{value:R,repeatable:x,optional:N,regexp:j}=m;s.push({name:R,repeatable:x,optional:N});const U=j||Fm;if(U!==Fm){_+=10;try{new RegExp(`(${U})`)}catch(z){throw new Error(`Invalid custom RegExp for param "${R}" (${U}): `+z.message)}}let F=x?`((?:${U})(?:/(?:${U}))*)`:`(${U})`;f||(F=N&&u.length<2?`(?:/${F})`:"/"+F),N&&(F+="?"),i+=F,_+=20,N&&(_+=-8),x&&(_+=-20),U===".*"&&(_+=-50)}h.push(_)}r.push(h)}if(t.strict&&t.end){const u=r.length-1;r[u][r[u].length-1]+=.7000000000000001}t.strict||(i+="/?"),t.end?i+="$":t.strict&&(i+="(?:/|$)");const o=new RegExp(i,t.sensitive?"":"i");function a(u){const h=u.match(o),f={};if(!h)return null;for(let m=1;m<h.length;m++){const _=h[m]||"",R=s[m-1];f[R.name]=_&&R.repeatable?_.split("/"):_}return f}function l(u){let h="",f=!1;for(const m of n){(!f||!h.endsWith("/"))&&(h+="/"),f=!1;for(const _ of m)if(_.type===0)h+=_.value;else if(_.type===1){const{value:R,repeatable:x,optional:N}=_,j=R in u?u[R]:"";if(mn(j)&&!x)throw new Error(`Provided param "${R}" is an array but it is not repeatable (* or + modifiers)`);const U=mn(j)?j.join("/"):j;if(!U)if(N)m.length<2&&(h.endsWith("/")?h=h.slice(0,-1):f=!0);else throw new Error(`Missing required param "${R}"`);h+=U}}return h||"/"}return{re:o,score:r,keys:s,parse:a,stringify:l}}function W1(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===80?-1:1:n.length>e.length?e.length===1&&e[0]===80?1:-1:0}function RI(n,e){let t=0;const r=n.score,i=e.score;for(;t<r.length&&t<i.length;){const s=W1(r[t],i[t]);if(s)return s;t++}if(Math.abs(i.length-r.length)===1){if(Bm(r))return 1;if(Bm(i))return-1}return i.length-r.length}function Bm(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const Y1={type:0,value:""},J1=/[a-zA-Z0-9_]/;function X1(n){if(!n)return[[]];if(n==="/")return[[Y1]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(_){throw new Error(`ERR (${t})/"${u}": ${_}`)}let t=0,r=t;const i=[];let s;function o(){s&&i.push(s),s=[]}let a=0,l,u="",h="";function f(){u&&(t===0?s.push({type:0,value:u}):t===1||t===2||t===3?(s.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:u,regexp:h,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),u="")}function m(){u+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:l==="/"?(u&&f(),o()):l===":"?(f(),t=1):m();break;case 4:m(),t=r;break;case 1:l==="("?t=2:J1.test(l)?m():(f(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?h[h.length-1]=="\\"?h=h.slice(0,-1)+l:t=3:h+=l;break;case 3:f(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,h="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${u}"`),f(),o(),i}function Z1(n,e,t){const r=Q1(X1(n.path),t),i=xe(r,{record:n,parent:e,children:[],alias:[]});return e&&!i.record.aliasOf==!e.record.aliasOf&&e.children.push(i),i}function eD(n,e){const t=[],r=new Map;e=$m({strict:!1,end:!0,sensitive:!1},e);function i(f){return r.get(f)}function s(f,m,_){const R=!_,x=qm(f);x.aliasOf=_&&_.record;const N=$m(e,f),j=[x];if("alias"in f){const z=typeof f.alias=="string"?[f.alias]:f.alias;for(const se of z)j.push(qm(xe({},x,{components:_?_.record.components:x.components,path:se,aliasOf:_?_.record:x})))}let U,F;for(const z of j){const{path:se}=z;if(m&&se[0]!=="/"){const oe=m.record.path,A=oe[oe.length-1]==="/"?"":"/";z.path=m.record.path+(se&&A+se)}if(U=Z1(z,m,N),_?_.alias.push(U):(F=F||U,F!==U&&F.alias.push(U),R&&f.name&&!jm(U)&&o(f.name)),PI(U)&&l(U),x.children){const oe=x.children;for(let A=0;A<oe.length;A++)s(oe[A],U,_&&_.children[A])}_=_||U}return F?()=>{o(F)}:uo}function o(f){if(AI(f)){const m=r.get(f);m&&(r.delete(f),t.splice(t.indexOf(m),1),m.children.forEach(o),m.alias.forEach(o))}else{const m=t.indexOf(f);m>-1&&(t.splice(m,1),f.record.name&&r.delete(f.record.name),f.children.forEach(o),f.alias.forEach(o))}}function a(){return t}function l(f){const m=rD(f,t);t.splice(m,0,f),f.record.name&&!jm(f)&&r.set(f.record.name,f)}function u(f,m){let _,R={},x,N;if("name"in f&&f.name){if(_=r.get(f.name),!_)throw gs(1,{location:f});N=_.record.name,R=xe(Um(m.params,_.keys.filter(F=>!F.optional).concat(_.parent?_.parent.keys.filter(F=>F.optional):[]).map(F=>F.name)),f.params&&Um(f.params,_.keys.map(F=>F.name))),x=_.stringify(R)}else if(f.path!=null)x=f.path,_=t.find(F=>F.re.test(x)),_&&(R=_.parse(x),N=_.record.name);else{if(_=m.name?r.get(m.name):t.find(F=>F.re.test(m.path)),!_)throw gs(1,{location:f,currentLocation:m});N=_.record.name,R=xe({},m.params,f.params),x=_.stringify(R)}const j=[];let U=_;for(;U;)j.unshift(U.record),U=U.parent;return{name:N,path:x,params:R,matched:j,meta:nD(j)}}n.forEach(f=>s(f));function h(){t.length=0,r.clear()}return{addRoute:s,resolve:u,removeRoute:o,clearRoutes:h,getRoutes:a,getRecordMatcher:i}}function Um(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function qm(n){const e={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:tD(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function tD(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="object"?t[r]:t;return e}function jm(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function nD(n){return n.reduce((e,t)=>xe(e,t.meta),{})}function $m(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}function rD(n,e){let t=0,r=e.length;for(;t!==r;){const s=t+r>>1;RI(n,e[s])<0?r=s:t=s+1}const i=iD(n);return i&&(r=e.lastIndexOf(i,r-1)),r}function iD(n){let e=n;for(;e=e.parent;)if(PI(e)&&RI(n,e)===0)return e}function PI({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function sD(n){const e={};if(n===""||n==="?")return e;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let i=0;i<r.length;++i){const s=r[i].replace(vI," "),o=s.indexOf("="),a=Fo(o<0?s:s.slice(0,o)),l=o<0?null:Fo(s.slice(o+1));if(a in e){let u=e[a];mn(u)||(u=e[a]=[u]),u.push(l)}else e[a]=l}return e}function Gm(n){let e="";for(let t in n){const r=n[t];if(t=A1(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(mn(r)?r.map(s=>s&&Fu(s)):[r&&Fu(r)]).forEach(s=>{s!==void 0&&(e+=(e.length?"&":"")+t,s!=null&&(e+="="+s))})}return e}function oD(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=mn(r)?r.map(i=>i==null?null:""+i):r==null?r:""+r)}return e}const aD=Symbol(""),zm=Symbol(""),Rd=Symbol(""),CI=Symbol(""),Uu=Symbol("");function Hs(){let n=[];function e(r){return n.push(r),()=>{const i=n.indexOf(r);i>-1&&n.splice(i,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function ar(n,e,t,r,i,s=o=>o()){const o=r&&(r.enterCallbacks[i]=r.enterCallbacks[i]||[]);return()=>new Promise((a,l)=>{const u=m=>{m===!1?l(gs(4,{from:t,to:e})):m instanceof Error?l(m):z1(m)?l(gs(2,{from:e,to:m})):(o&&r.enterCallbacks[i]===o&&typeof m=="function"&&o.push(m),a())},h=s(()=>n.call(r&&r.instances[i],e,t,u));let f=Promise.resolve(h);n.length<3&&(f=f.then(u)),f.catch(m=>l(m))})}function Ql(n,e,t,r,i=s=>s()){const s=[];for(const o of n)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(_I(l)){const h=(l.__vccOpts||l)[e];h&&s.push(ar(h,t,r,o,a,i))}else{let u=l();s.push(()=>u.then(h=>{if(!h)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const f=p1(h)?h.default:h;o.mods[a]=h,o.components[a]=f;const _=(f.__vccOpts||f)[e];return _&&ar(_,t,r,o,a,i)()}))}}return s}function Km(n){const e=Ln(Rd),t=Ln(CI),r=sn(()=>{const l=Ki(n.to);return e.resolve(l)}),i=sn(()=>{const{matched:l}=r.value,{length:u}=l,h=l[u-1],f=t.matched;if(!h||!f.length)return-1;const m=f.findIndex(ms.bind(null,h));if(m>-1)return m;const _=Hm(l[u-2]);return u>1&&Hm(h)===_&&f[f.length-1].path!==_?f.findIndex(ms.bind(null,l[u-2])):m}),s=sn(()=>i.value>-1&&hD(t.params,r.value.params)),o=sn(()=>i.value>-1&&i.value===t.matched.length-1&&wI(t.params,r.value.params));function a(l={}){return uD(l)?e[Ki(n.replace)?"replace":"push"](Ki(n.to)).catch(uo):Promise.resolve()}return{route:r,href:sn(()=>r.value.href),isActive:s,isExactActive:o,navigate:a}}const cD=Og({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Km,setup(n,{slots:e}){const t=jo(Km(n)),{options:r}=Ln(Rd),i=sn(()=>({[Qm(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[Qm(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const s=e.default&&e.default(t);return n.custom?s:ch("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:i.value},s)}}}),lD=cD;function uD(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function hD(n,e){for(const t in e){const r=e[t],i=n[t];if(typeof r=="string"){if(r!==i)return!1}else if(!mn(i)||i.length!==r.length||r.some((s,o)=>s!==i[o]))return!1}return!0}function Hm(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const Qm=(n,e,t)=>n??e??t,dD=Og({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=Ln(Uu),i=sn(()=>n.route||r.value),s=Ln(zm,0),o=sn(()=>{let u=Ki(s);const{matched:h}=i.value;let f;for(;(f=h[u])&&!f.components;)u++;return u}),a=sn(()=>i.value.matched[o.value]);Oa(zm,sn(()=>o.value+1)),Oa(aD,a),Oa(Uu,i);const l=FE();return Wi(()=>[l.value,a.value,n.name],([u,h,f],[m,_,R])=>{h&&(h.instances[f]=u,_&&_!==h&&u&&u===m&&(h.leaveGuards.size||(h.leaveGuards=_.leaveGuards),h.updateGuards.size||(h.updateGuards=_.updateGuards))),u&&h&&(!_||!ms(h,_)||!m)&&(h.enterCallbacks[f]||[]).forEach(x=>x(u))},{flush:"post"}),()=>{const u=i.value,h=n.name,f=a.value,m=f&&f.components[h];if(!m)return Wm(t.default,{Component:m,route:u});const _=f.props[h],R=_?_===!0?u.params:typeof _=="function"?_(u):_:null,N=ch(m,xe({},R,e,{onVnodeUnmounted:j=>{j.component.isUnmounted&&(f.instances[h]=null)},ref:l}));return Wm(t.default,{Component:N,route:u})||N}}});function Wm(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const fD=dD;function pD(n){const e=eD(n.routes,n),t=n.parseQuery||sD,r=n.stringifyQuery||Gm,i=n.history,s=Hs(),o=Hs(),a=Hs(),l=BE(rr);let u=rr;qi&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const h=Kl.bind(null,L=>""+L),f=Kl.bind(null,R1),m=Kl.bind(null,Fo);function _(L,te){let Z,re;return AI(L)?(Z=e.getRecordMatcher(L),re=te):re=L,e.addRoute(re,Z)}function R(L){const te=e.getRecordMatcher(L);te&&e.removeRoute(te)}function x(){return e.getRoutes().map(L=>L.record)}function N(L){return!!e.getRecordMatcher(L)}function j(L,te){if(te=xe({},te||l.value),typeof L=="string"){const T=Hl(t,L,te.path),V=e.resolve({path:T.path},te),$=i.createHref(T.fullPath);return xe(T,V,{params:m(V.params),hash:Fo(T.hash),redirectedFrom:void 0,href:$})}let Z;if(L.path!=null)Z=xe({},L,{path:Hl(t,L.path,te.path).path});else{const T=xe({},L.params);for(const V in T)T[V]==null&&delete T[V];Z=xe({},L,{params:f(T)}),te.params=f(te.params)}const re=e.resolve(Z,te),Te=L.hash||"";re.params=h(m(re.params));const ke=D1(r,xe({},L,{hash:b1(Te),path:re.path})),y=i.createHref(ke);return xe({fullPath:ke,hash:Te,query:r===Gm?oD(L.query):L.query||{}},re,{redirectedFrom:void 0,href:y})}function U(L){return typeof L=="string"?Hl(t,L,l.value.path):xe({},L)}function F(L,te){if(u!==L)return gs(8,{from:te,to:L})}function z(L){return A(L)}function se(L){return z(xe(U(L),{replace:!0}))}function oe(L){const te=L.matched[L.matched.length-1];if(te&&te.redirect){const{redirect:Z}=te;let re=typeof Z=="function"?Z(L):Z;return typeof re=="string"&&(re=re.includes("?")||re.includes("#")?re=U(re):{path:re},re.params={}),xe({query:L.query,hash:L.hash,params:re.path!=null?{}:L.params},re)}}function A(L,te){const Z=u=j(L),re=l.value,Te=L.state,ke=L.force,y=L.replace===!0,T=oe(Z);if(T)return A(xe(U(T),{state:typeof T=="object"?xe({},Te,T.state):Te,force:ke,replace:y}),te||Z);const V=Z;V.redirectedFrom=te;let $;return!ke&&x1(r,re,Z)&&($=gs(16,{to:V,from:re}),tn(re,re,!0,!1)),($?Promise.resolve($):b(V,re)).catch(M=>Vn(M)?Vn(M,2)?M:ln(M):ge(M,V,re)).then(M=>{if(M){if(Vn(M,2))return A(xe({replace:y},U(M.to),{state:typeof M.to=="object"?xe({},Te,M.to.state):Te,force:ke}),te||V)}else M=w(V,re,!0,y,Te);return S(V,re,M),M})}function v(L,te){const Z=F(L,te);return Z?Promise.reject(Z):Promise.resolve()}function I(L){const te=Kn.values().next().value;return te&&typeof te.runWithContext=="function"?te.runWithContext(L):L()}function b(L,te){let Z;const[re,Te,ke]=mD(L,te);Z=Ql(re.reverse(),"beforeRouteLeave",L,te);for(const T of re)T.leaveGuards.forEach(V=>{Z.push(ar(V,L,te))});const y=v.bind(null,L,te);return Z.push(y),Ut(Z).then(()=>{Z=[];for(const T of s.list())Z.push(ar(T,L,te));return Z.push(y),Ut(Z)}).then(()=>{Z=Ql(Te,"beforeRouteUpdate",L,te);for(const T of Te)T.updateGuards.forEach(V=>{Z.push(ar(V,L,te))});return Z.push(y),Ut(Z)}).then(()=>{Z=[];for(const T of ke)if(T.beforeEnter)if(mn(T.beforeEnter))for(const V of T.beforeEnter)Z.push(ar(V,L,te));else Z.push(ar(T.beforeEnter,L,te));return Z.push(y),Ut(Z)}).then(()=>(L.matched.forEach(T=>T.enterCallbacks={}),Z=Ql(ke,"beforeRouteEnter",L,te,I),Z.push(y),Ut(Z))).then(()=>{Z=[];for(const T of o.list())Z.push(ar(T,L,te));return Z.push(y),Ut(Z)}).catch(T=>Vn(T,8)?T:Promise.reject(T))}function S(L,te,Z){a.list().forEach(re=>I(()=>re(L,te,Z)))}function w(L,te,Z,re,Te){const ke=F(L,te);if(ke)return ke;const y=te===rr,T=qi?history.state:{};Z&&(re||y?i.replace(L.fullPath,xe({scroll:y&&T&&T.scroll},Te)):i.push(L.fullPath,Te)),l.value=L,tn(L,te,Z,y),ln()}let E;function Ne(){E||(E=i.listen((L,te,Z)=>{if(!_n.listening)return;const re=j(L),Te=oe(re);if(Te){A(xe(Te,{replace:!0}),re).catch(uo);return}u=re;const ke=l.value;qi&&B1(km(ke.fullPath,Z.delta),al()),b(re,ke).catch(y=>Vn(y,12)?y:Vn(y,2)?(A(y.to,re).then(T=>{Vn(T,20)&&!Z.delta&&Z.type===Bo.pop&&i.go(-1,!1)}).catch(uo),Promise.reject()):(Z.delta&&i.go(-Z.delta,!1),ge(y,re,ke))).then(y=>{y=y||w(re,ke,!1),y&&(Z.delta&&!Vn(y,8)?i.go(-Z.delta,!1):Z.type===Bo.pop&&Vn(y,20)&&i.go(-1,!1)),S(re,ke,y)}).catch(uo)}))}let mt=Hs(),Qe=Hs(),Ee;function ge(L,te,Z){ln(L);const re=Qe.list();return re.length?re.forEach(Te=>Te(L,te,Z)):console.error(L),Promise.reject(L)}function Qt(){return Ee&&l.value!==rr?Promise.resolve():new Promise((L,te)=>{mt.add([L,te])})}function ln(L){return Ee||(Ee=!L,Ne(),mt.list().forEach(([te,Z])=>L?Z(L):te()),mt.reset()),L}function tn(L,te,Z,re){const{scrollBehavior:Te}=n;if(!qi||!Te)return Promise.resolve();const ke=!Z&&U1(km(L.fullPath,0))||(re||!Z)&&history.state&&history.state.scroll||null;return nh().then(()=>Te(L,te,ke)).then(y=>y&&F1(y)).catch(y=>ge(y,L,te))}const We=L=>i.go(L);let Ye;const Kn=new Set,_n={currentRoute:l,listening:!0,addRoute:_,removeRoute:R,clearRoutes:e.clearRoutes,hasRoute:N,getRoutes:x,resolve:j,options:n,push:z,replace:se,go:We,back:()=>We(-1),forward:()=>We(1),beforeEach:s.add,beforeResolve:o.add,afterEach:a.add,onError:Qe.add,isReady:Qt,install(L){const te=this;L.component("RouterLink",lD),L.component("RouterView",fD),L.config.globalProperties.$router=te,Object.defineProperty(L.config.globalProperties,"$route",{enumerable:!0,get:()=>Ki(l)}),qi&&!Ye&&l.value===rr&&(Ye=!0,z(i.location).catch(Te=>{}));const Z={};for(const Te in rr)Object.defineProperty(Z,Te,{get:()=>l.value[Te],enumerable:!0});L.provide(Rd,te),L.provide(CI,vg(Z)),L.provide(Uu,l);const re=L.unmount;Kn.add(L),L.unmount=function(){Kn.delete(L),Kn.size<1&&(u=rr,E&&E(),E=null,l.value=rr,Ye=!1,Ee=!1),re()}}};function Ut(L){return L.reduce((te,Z)=>te.then(()=>I(Z)),Promise.resolve())}return _n}function mD(n,e){const t=[],r=[],i=[],s=Math.max(e.matched.length,n.matched.length);for(let o=0;o<s;o++){const a=e.matched[o];a&&(n.matched.find(u=>ms(u,a))?r.push(a):t.push(a));const l=n.matched[o];l&&(e.matched.find(u=>ms(u,l))||i.push(l))}return[t,r,i]}const gD="data:image/svg+xml,%3csvg%20width='7'%20height='10'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M1%201l4%204-4%204'%20stroke='%237C5DFA'%20stroke-width='2'%20fill='none'%20fill-rule='evenodd'/%3e%3c/svg%3e",_D={name:"invoice",props:["invoice"]},yD={class:"left flex"},vD={class:"tracking-number"},ID={class:"due-date"},ED={class:"person"},TD={class:"right flex"},wD={class:"price"},bD={key:0},AD={key:1},SD={key:2};function RD(n,e,t,r,i,s){const o=ur("router-link");return Ie(),vo(o,{class:"invoice flex",to:{name:"Invoice",params:{invoiceId:t.invoice.invoiceId}}},{default:Rc(()=>[P("div",yD,[P("span",vD,"#"+Le(t.invoice.invoiceId),1),P("span",ID,Le(t.invoice.paymentDueDate),1),P("span",ED,Le(t.invoice.clientName),1)]),P("div",TD,[P("span",wD,"$"+Le(t.invoice.invoiceTotal),1),P("div",{class:qo(["status-button flex",{paid:t.invoice.invoicePaid,draft:t.invoice.invoiceDraft,pending:t.invoice.invoicePending}])},[t.invoice.invoicePaid?(Ie(),De("span",bD,"Paid")):Pt("",!0),t.invoice.invoiceDraft?(Ie(),De("span",AD,"Draft")):Pt("",!0),t.invoice.invoicePending?(Ie(),De("span",SD,"Pending")):Pt("",!0)],2),e[0]||(e[0]=P("div",{class:"icon"},[P("img",{src:gD,alt:""})],-1))])]),_:1},8,["to"])}const PD=Pr(_D,[["render",RD],["__scopeId","data-v-62fcc29f"]]),CD="data:image/svg+xml,%3csvg%20width='11'%20height='7'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M1%201l4.228%204.228L9.456%201'%20stroke='%237C5DFA'%20stroke-width='2'%20fill='none'%20fill-rule='evenodd'/%3e%3c/svg%3e",DD="/assets/illustration-empty-Czz_H9Xz.svg",xD={name:"Home",data(){return{filterMenu:null,filteredInvoice:null}},components:{Invoice:PD},methods:{...kc(["TOGGLE_INVOICE"]),newInvoice(){this.TOGGLE_INVOICE()},toggleFilterMenu(){this.filterMenu=!this.filterMenu},filteredInvoices(n){if(n.target.innerText==="Clear Filter"){this.filteredInvoice=null;return}this.filteredInvoice=n.target.innerText}},computed:{...zo(["invoiceData"]),filteredData(){return this.invoiceData.filter(n=>this.filteredInvoice==="Draft"?n.invoiceDraft===!0:this.filteredInvoice==="Paid"?n.invoicePaid===!0:this.filteredInvoice==="Pending"?n.invoicePending===!0:n)}}},VD={class:"home container"},ND={class:"header flex"},OD={class:"left flex flex-column"},kD={class:"right flex"},MD={key:0},LD={class:"filter-menu"},FD={key:0},BD={key:1,class:"empty flex flex-column"};function UD(n,e,t,r,i,s){const o=ur("Invoice");return Ie(),De("div",VD,[P("div",ND,[P("div",OD,[e[6]||(e[6]=P("h1",null,"Invoices",-1)),P("span",null,"There are "+Le(n.invoiceData.length)+" total invoices",1)]),P("div",kD,[P("div",{class:"filter flex",onClick:e[4]||(e[4]=(...a)=>s.toggleFilterMenu&&s.toggleFilterMenu(...a))},[P("span",null,[e[7]||(e[7]=Io("Filter by status")),i.filteredInvoice?(Ie(),De("span",MD,": "+Le(i.filteredInvoice),1)):Pt("",!0)]),e[8]||(e[8]=P("img",{src:CD,alt:""},null,-1)),ot(P("ul",LD,[P("li",{onClick:e[0]||(e[0]=(...a)=>s.filteredInvoices&&s.filteredInvoices(...a))},"Draft"),P("li",{onClick:e[1]||(e[1]=(...a)=>s.filteredInvoices&&s.filteredInvoices(...a))},"Pending"),P("li",{onClick:e[2]||(e[2]=(...a)=>s.filteredInvoices&&s.filteredInvoices(...a))},"Paid"),P("li",{onClick:e[3]||(e[3]=(...a)=>s.filteredInvoices&&s.filteredInvoices(...a))},"Clear Filter")],512),[[u_,i.filterMenu]])]),P("div",{class:"button flex",onClick:e[5]||(e[5]=(...a)=>s.newInvoice&&s.newInvoice(...a))},e[9]||(e[9]=[P("div",{class:"inner-button flex"},[P("img",{src:gI,alt:""})],-1),P("span",null,"New Invoice",-1)]))])]),n.invoiceData.length>0?(Ie(),De("div",FD,[(Ie(!0),De(Xt,null,ih(s.filteredData,(a,l)=>(Ie(),vo(o,{key:l,invoice:a},null,8,["invoice"]))),128))])):(Ie(),De("div",BD,e[10]||(e[10]=[P("img",{src:DD,alt:""},null,-1),P("h3",null,"There is nothing here",-1),P("p",null,"Create a new invoice by clicking the New Invoice button to get started",-1)])))])}const qD=Pr(xD,[["render",UD],["__scopeId","data-v-0f383990"]]),jD="data:image/svg+xml,%3csvg%20width='7'%20height='10'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M6.342.886L2.114%205.114l4.228%204.228'%20stroke='%239277FF'%20stroke-width='2'%20fill='none'%20fill-rule='evenodd'/%3e%3c/svg%3e",$D={name:"invoiceView",data(){return{currentInvoice:null}},created(){this.getCurrentInvoice()},methods:{...kc(["SET_CURRENT_INVOICE","TOGGLE_EDIT_INVOICE","TOGGLE_INVOICE"]),...dh(["DELETE_INVOICE","UPDATE_STATUS_TO_PAID","UPDATE_STATUS_TO_PENDING"]),getCurrentInvoice(){this.SET_CURRENT_INVOICE(this.$route.params.invoiceId),this.currentInvoice=this.currentInvoiceArray[0]},toggleEditInvoice(){this.TOGGLE_EDIT_INVOICE(),this.TOGGLE_INVOICE()},async deleteInvoice(n){await this.DELETE_INVOICE(n),this.$router.push({name:"Home"})},updateStatusToPaid(n){this.UPDATE_STATUS_TO_PAID(n)},updateStatusToPending(n){this.UPDATE_STATUS_TO_PENDING(n)}},computed:{...zo(["currentInvoiceArray","editInvoice"])},watch:{editInvoice(){this.editInvoice||(this.currentInvoice=this.currentInvoiceArray[0])}}},GD={key:0,class:"invoice-view container"},zD={class:"header flex"},KD={class:"left flex"},HD={key:0},QD={key:1},WD={key:2},YD={class:"right flex"},JD={class:"invoice-details flex flex-column"},XD={class:"top flex"},ZD={class:"left flex flex-column"},ex={class:"right flex flex-column"},tx={class:"middle flex"},nx={class:"payment flex flex-column"},rx={class:"bill flex flex-column"},ix={class:"send-to flex flex-column"},sx={class:"bottom flex flex-column"},ox={class:"billing-items"},ax={class:"total flex"};function cx(n,e,t,r,i,s){const o=ur("router-link");return i.currentInvoice?(Ie(),De("div",GD,[dt(o,{class:"nav-link flex",to:{name:"Home"}},{default:Rc(()=>e[4]||(e[4]=[P("img",{src:jD,alt:""},null,-1),Io(" Go Back ")])),_:1}),P("div",zD,[P("div",KD,[e[5]||(e[5]=P("span",null,"Status",-1)),P("div",{class:qo(["status-button flex",{paid:i.currentInvoice.invoicePaid,draft:i.currentInvoice.invoiceDraft,pending:i.currentInvoice.invoicePending}])},[i.currentInvoice.invoicePaid?(Ie(),De("span",HD,"Paid")):Pt("",!0),i.currentInvoice.invoiceDraft?(Ie(),De("span",QD,"Draft")):Pt("",!0),i.currentInvoice.invoicePending?(Ie(),De("span",WD,"Pending")):Pt("",!0)],2)]),P("div",YD,[P("button",{onClick:e[0]||(e[0]=(...a)=>s.toggleEditInvoice&&s.toggleEditInvoice(...a)),class:"dark-purple"},"Edit"),P("button",{onClick:e[1]||(e[1]=a=>s.deleteInvoice(i.currentInvoice.docId)),class:"red"},"Delete"),i.currentInvoice.invoicePending?(Ie(),De("button",{key:0,onClick:e[2]||(e[2]=a=>s.updateStatusToPaid(i.currentInvoice.docId)),class:"green"},"Mark as Paid")):Pt("",!0),i.currentInvoice.invoiceDraft||i.currentInvoice.invoicePaid?(Ie(),De("button",{key:1,onClick:e[3]||(e[3]=a=>s.updateStatusToPending(i.currentInvoice.docId)),class:"orange"},"Mark as Pending")):Pt("",!0)])]),P("div",JD,[P("div",XD,[P("div",ZD,[P("p",null,[e[6]||(e[6]=P("span",null,"#",-1)),Io(Le(i.currentInvoice.invoiceId),1)]),P("p",null,Le(i.currentInvoice.productDescription),1)]),P("div",ex,[P("p",null,Le(i.currentInvoice.billerStreetAddress),1),P("p",null,Le(i.currentInvoice.billerCity),1),P("p",null,Le(i.currentInvoice.billerZipCode),1),P("p",null,Le(i.currentInvoice.billerCountry),1)])]),P("div",tx,[P("div",nx,[e[7]||(e[7]=P("h4",null,"Invoice Date",-1)),P("p",null,Le(i.currentInvoice.invoiceDate),1),e[8]||(e[8]=P("h4",null,"Payment Date",-1)),P("p",null,Le(i.currentInvoice.paymentDueDate),1)]),P("div",rx,[e[9]||(e[9]=P("h4",null,"Bill To",-1)),P("p",null,Le(i.currentInvoice.clientName),1),P("p",null,Le(i.currentInvoice.clientStreetAddress),1),P("p",null,Le(i.currentInvoice.clientCity),1),P("p",null,Le(i.currentInvoice.clientZipCode),1),P("p",null,Le(i.currentInvoice.clientCountry),1)]),P("div",ix,[e[10]||(e[10]=P("h4",null,"Sent To",-1)),P("p",null,Le(i.currentInvoice.clientEmail),1)])]),P("div",sx,[P("div",ox,[e[11]||(e[11]=P("div",{class:"heading flex"},[P("p",null,"Item Name"),P("p",null,"QTY"),P("p",null,"Price"),P("p",null,"Total")],-1)),(Ie(!0),De(Xt,null,ih(i.currentInvoice.invoiceItemList,(a,l)=>(Ie(),De("div",{key:l,class:"item flex"},[P("p",null,Le(a.itemName),1),P("p",null,Le(a.qty),1),P("p",null,Le(a.price),1),P("p",null,Le(a.total),1)]))),128))]),P("div",ax,[e[12]||(e[12]=P("p",null,"Amount Due",-1)),P("p",null,Le(i.currentInvoice.invoiceTotal),1)])])])])):Pt("",!0)}const lx=Pr($D,[["render",cx],["__scopeId","data-v-0128a61a"]]),ux=pD({history:G1("/"),routes:[{path:"/",name:"Home",component:qD},{path:"/invoice/:invoiceId",name:"Invoice",component:lx}]}),hx=ab({state:{invoiceData:[],invoiceModal:null,modalActive:null,invoicesLoaded:null,currentInvoiceArray:null,editInvoice:null},mutations:{TOGGLE_INVOICE(n){n.invoiceModal=!n.invoiceModal},TOGGLE_MODAL(n){n.modalActive=!n.modalActive},SET_INVOICE_DATA(n,e){n.invoiceData.push(e)},INVOICES_LOADED(n){n.invoicesLoaded=!0},SET_CURRENT_INVOICE(n,e){n.currentInvoiceArray=n.invoiceData.filter(t=>t.invoiceId===e)},TOGGLE_EDIT_INVOICE(n){n.editInvoice=!n.editInvoice},DELETE_INVOICE(n,e){n.invoiceData=n.invoiceData.filter(t=>t.docId!==e)},UPDATE_STATUS_TO_PAID(n,e){n.invoiceData.forEach(t=>{t.docId===e&&(t.invoicePaid=!0,t.invoicePending=!1)})},UPDATE_STATUS_TO_PENDING(n,e){n.invoiceData.forEach(t=>{t.docId===e&&(t.invoicePaid=!1,t.invoicePending=!0,t.invoiceDraft=!1)})}},actions:{async GET_INVOICES({commit:n,state:e}){(await ji.collection("invoices").get()).forEach(i=>{if(!e.invoiceData.some(s=>s.docId===i.id)){const s={docId:i.id,invoiceId:i.data().invoiceId,billerStreetAddress:i.data().billerStreetAddress,billerCity:i.data().billerCity,billerZipCode:i.data().billerZipCode,billerCountry:i.data().billerCountry,clientName:i.data().clientName,clientEmail:i.data().clientEmail,clientStreetAddress:i.data().clientStreetAddress,clientCity:i.data().clientCity,clientZipCode:i.data().clientZipCode,clientCountry:i.data().clientCountry,invoiceDateUnix:i.data().invoiceDateUnix,invoiceDate:i.data().invoiceDate,paymentTerms:i.data().paymentTerms,paymentDueDateUnix:i.data().paymentDueDateUnix,paymentDueDate:i.data().paymentDueDate,productDescription:i.data().productDescription,invoicePending:i.data().invoicePending,invoiceDraft:i.data().invoiceDraft,invoiceItemList:i.data().invoiceItemList,invoiceTotal:i.data().invoiceTotal,invoicePaid:i.data().invoicePaid};n("SET_INVOICE_DATA",s)}}),n("INVOICES_LOADED")},async UPDATE_INVOICE({commit:n,dispatch:e},{docId:t,routeId:r}){n("DELETE_INVOICE",t),await e("GET_INVOICES"),n("TOGGLE_INVOICE"),n("TOGGLE_EDIT_INVOICE"),n("SET_CURRENT_INVOICE",r)},async DELETE_INVOICE({commit:n},e){await ji.collection("invoices").doc(e).delete(),n("DELETE_INVOICE",e)},async UPDATE_STATUS_TO_PAID({commit:n},e){await ji.collection("invoices").doc(e).update({invoicePaid:!0,invoicePending:!1}),n("UPDATE_STATUS_TO_PAID",e)},async UPDATE_STATUS_TO_PENDING({commit:n},e){await ji.collection("invoices").doc(e).update({invoicePaid:!1,invoicePending:!0,invoiceDraft:!1}),n("UPDATE_STATUS_TO_PENDING",e)}},modules:{}}),DI=Ow(f1);DI.use(hx).use(ux);DI.mount("#app");
